(window["webpackJsonpgroupifier-next"]=window["webpackJsonpgroupifier-next"]||[]).push([[0],{259:function(e){e.exports=JSON.parse('{"a":"2.0.0"}')},279:function(e,t,n){e.exports=n(511)},496:function(e,t,n){},511:function(e,t,n){"use strict";n.r(t);n(280);var r=n(247);n.n(r).a.polyfill();var a=n(0),i=n.n(a),o=n(20),c=n.n(o),u=(n(496),n(7)),l=n(79),s=n(588),f=n(565),m=n(266),d=n(587),p=n(264),g=n.n(p),v=n(265),b=n.n(v),h=n(513),y=n(42),E=function(e,t){var n=new URLSearchParams(e.location.search),r=new URLSearchParams(t.search);return n.has("staging")&&(r.set("staging","true"),t.search=r.toString()),t},O=function(e,t){return"string"===typeof e?{pathname:e,state:t}:e},j=Object(y.a)(),w=j.push;j.push=function(e,t){return w.apply(j,[E(j,O(e,t))])};var C=j.replace;j.replace=function(e,t){return C.apply(j,[E(j,O(e,t))])};var x=j,k=n(584),S=n(557),N=n(512),I=n(559),P=n(80),D=n(29),R=n(558),T=n(268),A=n(153),W=n.n(A),U=n(248),M=n.n(U),z=n(251),F=n.n(z),B=n(250),L=n.n(B),G=n(27),J=n(12),_=n(89);function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(n,!0).forEach(function(t){Object(G.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Z=function e(t,n,r){var a=Object(_.a)(n),i=a[0],o=a.slice(1);return 0===o.length?Y({},t,Object(G.a)({},i,r(t[i]))):Y({},t,Object(G.a)({},i,e(t[i],o,r)))},q=function(e,t,n){return Z(e,t,function(){return n})},K=function(e,t,n){return Z(e,t,function(e){return e&&e.map(n)})},Q=function e(t){return(n=t)===Object(n)?Object.values(t).every(e):null!=t;var n},V=function(e,t,n){return"".concat(e," ").concat(1===e?t:n||t+"s")},X=function(e){if(0===e.length)return[];var t=me(e);return e.map(function(n){return 0!==t?n/t:1/e.length})},$=function(e,t){return e.reduce(function(e,n){return e.concat(t(n))},[])},ee=function(e,t){return e.reduce(function(e,n){return Z(e,[t(n)],function(e){return(e||[]).concat(n)})},{})},te=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?[]:t[0].map(function(e,n){return t.map(function(e){return e[n]})})},ne=function(e,t){return e.reduceRight(function(e,n){return void 0!==e?e:t(n)?n:void 0},void 0)},re=function(e,t){return e.filter(function(e){return t.includes(e)})},ae=function(e,t){return e.filter(function(e){return!t.includes(e)})},ie=function(e,t){return[e.filter(t),e.filter(function(e){return!t(e)})]},oe=function(e,t){return e<t?-1:e>t?1:0},ce=function(e,t){return e.slice().sort(function(e,n){return oe(t(e),t(n))})},ue=function(e,t){var n=new Map(e.map(function(e){return[e,t(e)]}));return e.slice().sort(function(e,t){return function(e,t){return e.reduce(function(e,n){return e||t(n)},null)}(te(n.get(e),n.get(t)),function(e){var t=Object(u.a)(e,2),n=t[0],r=t[1];return oe(n,r)})})},le=function e(t,n){return t.length<=n?[t]:[t.slice(0,n)].concat(Object(J.a)(e(t.slice(n),n)))},se=function(e,t){return Array.from({length:e},function(e,n){return t(n)})},fe=function(e){return Object(J.a)(new Set(e))},me=function(e){return e.reduce(function(e,t){return e+t},0)},de=function(e,t,n){return t<=e&&e<=n},pe=function(e,t){return new Date(new Date(e).getTime()+t).toISOString()},ge=function(e,t){return Math.abs(new Date(e)-new Date(t))},ve=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"UTC";return new Date(e).toLocaleTimeString("en-US",{timeZone:t,hour:"numeric",minute:"numeric"})};function be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function he(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?be(n,!0).forEach(function(t){Object(G.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):be(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var ye=function(e){return"groupifier.".concat(e)},Ee=function(e,t){return{id:ye(e),specUrl:"https://groupifier.jonatanklosko.com/wcif-extensions/".concat(e,".json"),data:t}},Oe=function(e,t,n){var r=t.extensions.filter(function(t){return t.id!==ye(e)});return he({},t,{extensions:[].concat(Object(J.a)(r),[Ee(e,n)])})},je={ActivityConfig:null,RoomConfig:{stations:null},CompetitionConfig:{localNamesFirst:!1,scorecardsBackgroundUrl:"",competitorsSortingRule:"ranks",noTasksForNewcomers:!1,tasksForOwnEventsOnly:!1}},we=function(e,t){var n=t.extensions.find(function(t){return t.id===ye(e)}),r=je[e];return null===r?n&&n.data:n?he({},r,{},n.data):r},Ce=function(e,t){return he({},t,{extensions:t.extensions.filter(function(t){return t.id!==ye(e)})})},xe=[{id:"333",name:"3x3x3 Cube",shortName:"3x3"},{id:"222",name:"2x2x2 Cube",shortName:"2x2"},{id:"444",name:"4x4x4 Cube",shortName:"4x4"},{id:"555",name:"5x5x5 Cube",shortName:"5x5"},{id:"666",name:"6x6x6 Cube",shortName:"6x6"},{id:"777",name:"7x7x7 Cube",shortName:"7x7"},{id:"333bf",name:"3x3x3 Blindfolded",shortName:"3BLD"},{id:"333fm",name:"3x3x3 Fewest Moves",shortName:"FMC"},{id:"333oh",name:"3x3x3 One-Handed",shortName:"3OH"},{id:"333ft",name:"3x3x3 With Feet",shortName:"3WF"},{id:"minx",name:"Megaminx",shortName:"Minx"},{id:"pyram",name:"Pyraminx",shortName:"Pyra"},{id:"clock",name:"Clock",shortName:"Clock"},{id:"skewb",name:"Skewb",shortName:"Skewb"},{id:"sq1",name:"Square-1",shortName:"Sq1"},{id:"444bf",name:"4x4x4 Blindfolded",shortName:"4BLD"},{id:"555bf",name:"5x5x5 Blindfolded",shortName:"5BLD"},{id:"333mbf",name:"3x3x3 Multi-Blind",shortName:"MBLD"}],ke=function(e){return Se("name",e)},Se=function(e,t){return xe.find(function(e){return e.id===t})[e]},Ne=function(e){return ce(e,function(e){return xe.findIndex(function(t){return t.id===e.id})})};function Ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var Pe=function(e){var t=e.match(/(\w+)(?:-r(\d+))?(?:-g(\d+))?(?:-a(\d+))?/),n=Object(u.a)(t,5),r=n[1],a=n[2],i=n[3],o=n[4];return{eventId:r,roundNumber:a&&parseInt(a,10),groupNumber:i&&parseInt(i,10),attemptNumber:o&&parseInt(o,10)}},De=function(e){var t=Pe(e),n=t.eventId,r=t.roundNumber,a=t.groupNumber,i=t.attemptNumber;return[n&&ke(n),r&&"Round ".concat(r),a&&"Group ".concat(a),i&&"Attempt ".concat(i)].filter(function(e){return e}).join(", ")},Re=function(e){return["333fm","333mbf"].includes(Pe(e).eventId)},Te=function(e){var t=e.startTime,n=e.endTime;return new Date(n)-new Date(t)},Ae=function(e){var t=e.startTime,n=e.endTime,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"UTC";return"".concat(ve(t,r)," - ").concat(ve(n,r))},We=function(e,t){return new Date(e.startTime)<new Date(t.endTime)&&new Date(t.startTime)<new Date(e.endTime)},Ue=function(e){return $(e.schedule.venues,function(e){return e.rooms})},Me=function(e,t){return we("RoomConfig",function(e,t){return Ue(e).find(function(e){return e.activities.some(function(e){return e.id===t})})}(e,t)).stations},ze=function(e){var t=$(Ue(e),function(e){return e.activities});return[].concat(Object(J.a)(t),Object(J.a)($(t,function e(t){var n=t.childActivities;return n.length>0?[].concat(Object(J.a)(n),Object(J.a)($(n,e))):n})))},Fe=new Map,Be=function(e,t){if(Fe.has(e.schedule))return Fe.get(e.schedule).get(t);var n=ze(e),r=new Map(n.map(function(e){return[e.id,e]}));return Fe.set(e.schedule,r),r.get(t)},Le=function(e,t){return K(e,["schedule","venues"],function(e){return K(e,["rooms"],function(e){return K(e,["activities"],function(e){return e.id===t.id?t:e})})})},Ge=function(e,t,n){return $(e.events,function(r){return $(r.rounds,function(r){var a=Pe(r.id).roundNumber,i=t[r.id].length,o=Ze(e,r.id).filter(Je);if(o.every(function(e){return we("ActivityConfig",e)}))return o;var c=X(o.map(function(t){return Me(e,t.id)*Te(t)}));return te(o,c).map(function(t){var r=Object(u.a)(t,2),o=r[0],c=r[1],l=Me(e,o.id),s=Math.round(c*i),f=function(e,t,n){if(0===t)return 1;var r=1.7*t,a=Math.round(e/r+.4);return Math.max(a,1===n?2:1)}(s,l,a),m=n.assignScramblers?function(e,t){return Math.floor(1+(Math.min(e,t)-1)/5)}(s/f,l):0,d=n.assignRunners?function(e,t){return Math.floor(1+(Math.min(e,t)-1)/8)}(s/f,l):0,p=l>0&&n.assignJudges;return Oe("ActivityConfig",o,{capacity:c,groups:f,scramblers:m,runners:d,assignJudges:p})})})}).reduce(Le,e)},Je=function(e){var t=Pe(e.activityCode),n=t.eventId,r=t.roundNumber,a=t.groupNumber,i=t.attemptNumber;return!(!n||!r||a||i)},_e=function(e){return Ue(e).some(function(e){return e.activities.some(function(e){return we("ActivityConfig",e)})})},He=function(e){return Ue(e).every(function(e){return e.activities.filter(Je).map(function(e){return we("ActivityConfig",e)}).every(Q)})},Ye=function(e){return Ue(e).map(function(e){return we("RoomConfig",e)}).every(Q)},Ze=function(e,t){return $(Ue(e),function(e){return e.activities.filter(function(e){return e.activityCode.startsWith(t)})})},qe=function(e,t){return $(Ze(e,t),function(e){return Re(t)?[e]:e.childActivities})},Ke=function(e,t){return $(e.schedule.venues,function(e){return e.rooms.map(function(n){return[n,e.timezone,$(n.activities.filter(function(e){return e.activityCode===t}),function(e){return e.childActivities})]})})},Qe=function(e,t){return e.persons.some(function(e){return e.assignments.some(function(e){return e.activityId===t})})},Ve=function(e,t){return qe(e,t).some(function(t){return Qe(e,t.id)})},Xe=function(e){return $(e.events,function(e){return e.rounds}).filter(function(e){return 0===e.results.length||e.results.every(function(e){return 0===e.attempts.length})})},$e=function(e){return e.events.map(function(e){return e.rounds.find(function(e){var t=Pe(e.id).roundNumber;return 0===e.results.length&&1===t||e.results.length>0&&e.results.every(function(e){return 0===e.attempts.length})})}).filter(function(e){return e})},et=function(e){return $e(e).filter(function(t){return!Ve(e,t.id)})},tt=function(e){return e.events.some(function(t){return t.rounds.some(function(n){return Re(t.id)?Ve(e,n.id):qe(e,n.id).length>0})})},nt=function(e){var t=Xe(e),n=t.map(function(e){return e.id}),r=$(t,function(t){return qe(e,t.id)}).map(function(e){return e.id}),a=e.persons.map(function(e){return Z(e,["assignments"],function(e){return e.filter(function(e){var t=e.activityId;return!r.includes(t)}).filter(function(e){var t=e.assignmentCode;return!t.startsWith("staff-")&&"competitor"!==t})})}),i=K(e.schedule,["venues"],function(e){return K(e,["rooms"],function(e){return K(e,["activities"],function(e){return n.includes(e.activityCode)?q(e,["childActivities"],[]):e})})});return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ie(n,!0).forEach(function(t){Object(G.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ie(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e,{persons:a,schedule:i})},rt=[{path:"/roles",text:"Edit roles",icon:M.a,enabled:function(e){return!0}},{path:"/config",text:"Configure",icon:L.a,enabled:function(e){return!0}},{path:"/groups",text:"Manage groups",icon:W.a,enabled:function(e){return Ye(e)&&He(e)}},{path:"/printing",text:"Print documents",icon:F.a,enabled:function(e){return function(e){return e.persons.some(function(e){return e.assignments.some(function(e){return"competitor"===e.assignmentCode})})}(e)}}],at=function(e){var t=e.wcif,n=e.baseUrl;return i.a.createElement(T.a,null,i.a.createElement(S.a,null,rt.map(function(e){return i.a.createElement(N.a,{key:e.path,button:!0,component:D.a,to:"".concat(n).concat(e.path),disabled:!e.enabled(t)},i.a.createElement(R.a,null,i.a.createElement(e.icon,null)),i.a.createElement(I.a,{primary:e.text}))})))},it=n(573),ot=n(569),ct=n(574),ut=n(590),lt=Object(h.a)(function(e){return{roomDot:{display:"inline-block",width:10,height:10,marginRight:5,borderRadius:"100%"}}}),st=function(e){var t=e.room,n=lt();return i.a.createElement(P.a,{variant:"subtitle2"},i.a.createElement("span",{className:n.roomDot,style:{backgroundColor:t.color}}),i.a.createElement("span",null,t.name))},ft=n(106),mt=n(592),dt=n(593),pt=i.a.memo(function(e){var t=e.value,n=e.onChange,r=Object(ft.a)(e,["value","onChange"]);return i.a.createElement(dt.a,Object.assign({},r,{type:"number",value:null===t?"":t,onKeyPress:function(e){e.key.match(/\D/)&&e.preventDefault()},onChange:function(e){var t=e.target.value,r=t.length>0?parseInt(t,10):null;(null===r||!Number.isNaN(r)&&r>=1)&&n(e,r)}}))}),gt=i.a.memo(function(e){var t=e.value,n=e.disabled,r=Object(ft.a)(e,["value","disabled"]),o=Object(a.useRef)(null),c=Object(a.useRef)(!1);return Object(a.useEffect)(function(){null===t&&c.current&&(o.current.focus(),c.current=!1)},[t]),i.a.createElement("div",null,i.a.createElement(pt,Object.assign({},r,{value:t,disabled:0===t||n,inputRef:o})),i.a.createElement(mt.a,{name:r.name,checked:0!==t,onChange:function(e){var t=e.target.checked;r.onChange(e,t?null:0),t&&(c.current=!0)},disabled:n}))}),vt=function(e){var t=e.room,n=e.onChange,r=e.disabled,a=we("RoomConfig",t).stations;return i.a.createElement("div",null,i.a.createElement(st,{room:t}),i.a.createElement(gt,{label:"Timing stations",value:a,name:"stations",onChange:function(e,r){n(Oe("RoomConfig",t,q(we("RoomConfig",t),[e.target.name],r)))},disabled:r}))},bt=function(e){var t=e.wcif,n=e.onWcifChange,r=function(e){n(K(t,["schedule","venues"],function(t){return K(t,["rooms"],function(t){return t.id===e.id?e:t})}))},a=_e(t);return i.a.createElement(T.a,{style:{padding:16}},i.a.createElement(f.a,{container:!0,spacing:2},Ue(t).map(function(e){return i.a.createElement(f.a,{item:!0,key:e.id},i.a.createElement(vt,{room:e,onChange:r,disabled:a}))})))},ht=n(568),yt=n(596),Et=n(514),Ot=function(e){var t=e.eventId,n=Object(ft.a)(e,["eventId"]);return i.a.createElement("span",Object.assign({style:{fontSize:24},className:"cubing-icon event-".concat(t)},n))},jt=function(e){var t=e.events,n=e.selected,r=e.onChange;return i.a.createElement("div",null,t.map(function(e){return i.a.createElement(yt.a,{key:e.id,title:ke(e.id),placement:"top"},i.a.createElement(Et.a,{onClick:function(){return r(e.id)}},i.a.createElement(Ot,{eventId:e.id,style:{opacity:e.id===n?1:.3}})))}))},wt=n(595),Ct=n(567),xt=n(566),kt=n(255),St=n.n(kt),Nt=function(e){var t=e.expanded,n=e.onChange,r=e.roundId,a=e.render;return i.a.createElement(wt.a,{onChange:function(e,t){return n(t?r:null)},expanded:t,TransitionProps:{onEntered:function(e){window.scrollTo({top:e.parentNode.getBoundingClientRect().top-8,behavior:"smooth"})}}},i.a.createElement(xt.a,{expandIcon:i.a.createElement(St.a,null)},i.a.createElement(P.a,{variant:"subtitle1"},De(r))),i.a.createElement(Ct.a,null,t&&a(r)))},It=function(e){var t=e.events,n=e.render,r=Object(a.useState)(t[0].id),o=Object(u.a)(r,2),c=o[0],l=o[1],s=Object(a.useState)(null),m=Object(u.a)(s,2),d=m[0],p=m[1],g=t.find(function(e){return e.id===c});return i.a.createElement(f.a,{container:!0,spacing:1},i.a.createElement(f.a,{item:!0,xs:12},i.a.createElement(jt,{selected:c,events:t,onChange:l})),i.a.createElement(f.a,{item:!0,xs:12},g.rounds.map(function(e){return i.a.createElement(Nt,{key:e.id,expanded:e.id===d,roundId:e.id,render:n,onChange:p})})))},Pt=i.a.memo(function(e){var t=e.activity,n=e.room,r=e.wcif,a=e.onChange,o=e.expectedCompetitors,c=we("ActivityConfig",t),u=c.groups,l=c.scramblers,s=c.runners,m=c.assignJudges,d=c.capacity,p=we("RoomConfig",n).stations,g=Math.round(o.length*d),v=Math.round(g/u),b=u?V(v,"person","people")+" in group":" ",h=l?V(Math.round(v/l),"cube")+" per scrambler":" ",y=s?V(Math.round(p/s),"station")+" per runner":" ",E=t.childActivities.length>0,O=t.childActivities.some(function(e){var t=e.id;return Qe(r,t)}),j=function(e,n){a(Oe("ActivityConfig",t,q(we("ActivityConfig",t),[e],n)))},w=function(e,t){j(e.target.name,t)};return i.a.createElement(f.a,{container:!0,direction:"column"},i.a.createElement(f.a,{item:!0},i.a.createElement(pt,{label:"Groups",value:u,name:"groups",helperText:b,onChange:w,margin:"dense",disabled:E||O})),i.a.createElement(f.a,{item:!0},i.a.createElement(gt,{label:"Scramblers",value:l,name:"scramblers",helperText:h,onChange:w,margin:"dense",disabled:O})),i.a.createElement(f.a,{item:!0},i.a.createElement(gt,{label:"Runners",value:s,name:"runners",helperText:y,onChange:w,margin:"dense",disabled:O})),i.a.createElement(f.a,{item:!0},i.a.createElement(ht.a,{control:i.a.createElement(mt.a,{checked:m,name:"assignJudges",onChange:function(e){var t=e.target,n=t.name,r=t.checked;j(n,r)},disabled:0===p||O}),label:"Assign judges"})))}),Dt=i.a.memo(function(e){var t=e.roundId,n=e.wcif,r=e.onWcifChange,a=e.expectedCompetitorsByRound,o=$(Ue(n),function(e){return e.activities.filter(function(e){return e.activityCode===t}).map(function(t){return[t,e]})});return i.a.createElement(f.a,{container:!0,spacing:1},o.map(function(e){var o=Object(u.a)(e,2),c=o[0],l=o[1];return i.a.createElement(f.a,{item:!0,xs:!0,key:c.id},i.a.createElement(st,{room:l}),i.a.createElement(Pt,{wcif:n,activity:c,room:l,onChange:function(e){return r(Le(n,e))},expectedCompetitors:a[t]}))}))});function Rt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var Tt=function(e){var t=e.wcif,n=e.onWcifChange,r=e.expectedCompetitorsByRound,o=Object(a.useState)({assignScramblers:!0,assignRunners:!0,assignJudges:!0}),c=Object(u.a)(o,2),l=c[0],s=c[1],m=t.events.filter(function(e){return!Re(e.id)}),d=fe(function(e){return $(Ue(e),function(e){return e.activities.filter(Je).filter(function(e){return!we("ActivityConfig",e)})})}(t).map(function(e){return e.activityCode})),p=Object(a.useCallback)(function(e){return i.a.createElement(Dt,{roundId:e,expectedCompetitorsByRound:r,wcif:t,onWcifChange:n})},[t,n,r]);return 0===d.length?i.a.createElement(It,{events:m,render:p}):i.a.createElement(T.a,{style:{padding:16}},i.a.createElement(P.a,{variant:"h5"},_e(t)?"Generate missing configuration for\n          ".concat(d.map(De).join(", ")):"Generate initial configuration"),i.a.createElement(f.a,{container:!0,direction:"column"},i.a.createElement(f.a,{item:!0,style:{margin:"0.5em 0"}},i.a.createElement(P.a,{variant:"body1"},"Which of the following roles would you like to assign?")),["Scramblers","Runners","Judges"].map(function(e){return i.a.createElement(f.a,{item:!0,key:e},i.a.createElement(ht.a,{control:i.a.createElement(mt.a,{checked:l["assign".concat(e)],name:"assign".concat(e),onChange:function(e){var t=e.target,n=t.checked,r=t.name;s(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rt(n,!0).forEach(function(t){Object(G.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rt(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},l,Object(G.a)({},r,n)))}}),label:e}))})),i.a.createElement(ot.a,{onClick:function(){n(Ge(t,r,l))}},"Next"))},At=n(561),Wt=n(564),Ut=n(598),Mt=n(570),zt=n(589),Ft=[{id:"ranks",name:"Official rankings",description:"Sort competitors by their official rankings."},{id:"balanced",name:"Balanced",description:"Sort competitors in 3x3x3 (any variation), 2x2x2, Pyraminx and Skewb by their official rankings. For other events put best people in different groups, so that there are good scramblers for each group."},{id:"symmetric",name:"Symmetric",description:"Put best people in different groups, so that there are good scramblers for each group."},{id:"name-optimised",name:"Name-optimised",description:"Sort competitors by their official rankings, but also minimize the number of people with the same name in each group. Use it when many competitors have the same name."}],Bt=function(e){var t=e.wcif,n=e.onWcifChange,r=function(e,r){n(Oe("CompetitionConfig",t,q(we("CompetitionConfig",t),[e],r)))},a=function(e){var t=e.target,n=t.name,a=t.checked;r(n,a)},o=function(e){var t=e.target,n=t.name,a=t.value;r(n,a)},c=we("CompetitionConfig",t),u=c.competitorsSortingRule,l=c.noTasksForNewcomers,s=c.tasksForOwnEventsOnly,m=c.localNamesFirst,d=c.scorecardsBackgroundUrl;return i.a.createElement(T.a,{style:{padding:16}},i.a.createElement(f.a,{container:!0,direction:"column",spacing:1},i.a.createElement(f.a,{item:!0},i.a.createElement(P.a,{variant:"h5"},"Assignments"),i.a.createElement(At.a,{fullWidth:!0},i.a.createElement(Ut.a,{htmlFor:"competitors-sorting-rule"},"Competitors sorting rule"),i.a.createElement(zt.a,{value:u,onChange:o,inputProps:{name:"competitorsSortingRule",id:"competitors-sorting-rule"}},Ft.map(function(e){var t=e.id,n=e.name;return i.a.createElement(Mt.a,{value:t,key:t},n)})),i.a.createElement(Wt.a,null,Ft.find(function(e){return e.id===u}).description+" Note: this applies to first rounds only.")),i.a.createElement(f.a,{container:!0,direction:"column"},i.a.createElement(f.a,{item:!0},i.a.createElement(ht.a,{control:i.a.createElement(mt.a,{name:"noTasksForNewcomers",checked:l,onChange:a}),label:"Don't assign tasks to newcomers"})),i.a.createElement(f.a,{item:!0},i.a.createElement(ht.a,{control:i.a.createElement(mt.a,{name:"tasksForOwnEventsOnly",checked:s,onChange:a}),label:"Assign tasks to competitors only in events they registered for"})))),i.a.createElement(f.a,{item:!0},i.a.createElement(P.a,{variant:"h5"},"Printing"),i.a.createElement(ht.a,{control:i.a.createElement(mt.a,{name:"localNamesFirst",checked:m,onChange:a}),label:"Swap latin names with local ones"}),i.a.createElement(dt.a,{label:"Scorecards background image URL",name:"scorecardsBackgroundUrl",value:d,onChange:o,fullWidth:!0}))))},Lt=n(572),Gt=n(599),Jt=!new URLSearchParams(window.location.search).has("staging"),_t=Jt?"https://www.worldcubeassociation.org":"https://staging.worldcubeassociation.org",Ht=Jt?"eE1SyRia-Z6HTVr3TVEzOksUekySwGO81mKSWrRypNA":"example-application-id";function Yt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var Zt=function(e){return"GroupifierNext.".concat(Ht,".").concat(e)},qt=function(){return localStorage.getItem(Zt("accessToken"))},Kt=function(){var e=new URLSearchParams({client_id:Ht,response_type:"token",redirect_uri:Qt(),scope:"manage_competitions"});window.location="".concat(_t,"/oauth/authorize?").concat(e.toString())},Qt=function(){var e=window.location.origin;return new URLSearchParams(window.location.search).has("staging")?"".concat(e,"?staging=true"):e},Vt=function(){return localStorage.removeItem(Zt("accessToken"))},Xt=function(){return!!qt()},$t=function(e,t){var n,r,a,i=Object.keys(t).filter(function(n){return e[n]!==t[n]});return 0===i.length?Promise.resolve():(n=t.id,a=t,r=i.reduce(function(e,t){return Y({},e,Object(G.a)({},t,a[t]))},{}),en("/competitions/".concat(n,"/wcif"),{method:"PATCH",body:JSON.stringify(r)}))},en=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="".concat(_t,"/api/v0");return fetch("".concat(n).concat(e),Object.assign({},t,{headers:new Headers({Authorization:"Bearer ".concat(qt()),"Content-Type":"application/json"})})).then(function(e){if(!e.ok)throw new Error(e.statusText);return e}).then(function(e){return e.json()})},tn=Object(l.g)(function(e){var t=e.wcif,n=e.updatedWcif,r=e.onWcifUpdate,o=e.disabled,c=e.history,l=Object(a.useState)(!1),s=Object(u.a)(l,2),f=s[0],m=s[1],d=Object(a.useState)(!1),p=Object(u.a)(d,2),g=p[0],v=p[1];return i.a.createElement(a.Fragment,null,i.a.createElement(Gt.a,{open:g,message:"Failed to save data to the WCA website.",anchorOrigin:{vertical:"bottom",horizontal:"left"},autoHideDuration:5e3,onClose:function(){return v(!1)}}),i.a.createElement(ot.a,{variant:"contained",color:"primary",onClick:function(){m(!0),v(!1),$t(t,n).then(function(){r(n),c.push("/competitions/".concat(n.id))}).catch(function(){m(!1),v(!0)})},disabled:o||f},i.a.createElement("span",{style:f?{visibility:"hidden"}:{}},"Save"),f&&i.a.createElement(Lt.a,{size:20,style:{position:"absolute"}})))}),nn=function(e,t){return e.events.find(function(e){return e.id===t})},rn=function(e,t,n){if(!["single","average"].includes(n))throw new Error("Personal best type must be either 'single' or 'average'. Received '".concat(n,"'."));var r=e.personalBests.find(function(e){return e.eventId===t&&e.type===n});return r?r.best:1/0},an=function(e,t){return[rn(e,t,"average"),rn(e,t,"single")]},on=function(e){return e.events.reduce(function(t,n){var r=Object(_.a)(n.rounds),a=r[0],i=r.slice(1);return t[a.id]=ue(mn(e,n.id),function(e){return an(e,n.id)}),i.reduce(function(e,r){var a=Object(u.a)(e,2),i=a[0],o=a[1],c=i.advancementCondition;if(!c)throw new Error("Mising advancement condition for ".concat(De(i.id),"."));var l=function(e,t,n){switch(t.type){case"ranking":return e.slice(0,t.level);case"percent":return e.slice(0,Math.floor(e.length*t.level*.01));case"attemptResult":return e.filter(function(e){return rn(e,n,"single")<t.level});default:throw new Error("Unrecognised AdvancementCondition type: '".concat(t.type,"'"))}}(o,c,n.id);return t[r.id]=l,[r,l]},[a,t[a.id]]),t},{})},cn=function(e,t){var n=Pe(t),r=n.eventId,a=n.roundNumber,i=function(e,t){var n=Pe(t).eventId;return nn(e,n).rounds.find(function(e){return e.id===t})}(e,t).results.map(function(t){var n=t.personId;return function(e,t){return e.persons.find(function(e){return e.registrantId===t})}(e,n)});if(1===a){var o=i.length>0?i:mn(e,r);return ue(o,function(e){return an(e,r).map(function(e){return-e})})}if(i.length>0){var c=function(e,t){var n=Pe(t),r=n.eventId,a=n.roundNumber;return nn(e,r).rounds.find(function(e){var t=e.id;return Pe(t).roundNumber===a-1})}(e,t);return ce(i,function(e){return-c.results.find(function(t){return t.personId===e.registrantId}).ranking})}return null},un=function(e){var t=Date.now()-new Date(e.birthdate).getTime();return Math.floor(t/31556952e3)},ln=function(e){return e.assignments.filter(function(e){return e.assignmentCode.startsWith("staff-")})},sn=function(e,t,n){return ln(t).filter(function(t){var r=t.activityId;return Pe(Be(e,r).activityCode).eventId===n})},fn=function(e){return e.persons.filter(function(e){return e.registration&&"accepted"===e.registration.status})},mn=function(e,t){return fn(e).filter(function(e){return e.registration.eventIds.includes(t)})},dn=function(e,t,n){return e.assignments.some(function(e){return e.activityId===t&&e.assignmentCode===n})},pn=function(e){var t=e.wcif,n=e.onWcifUpdate,r=Object(a.useState)(t),o=Object(u.a)(r,2),c=o[0],l=o[1],s=Object(a.useState)(0),m=Object(u.a)(s,2),d=m[0],p=m[1],g=Object(a.useMemo)(function(){return on(t)},[t]),v=Ye(c)&&He(c);return i.a.createElement(f.a,{container:!0,spacing:1,justify:"flex-end"},i.a.createElement(f.a,{item:!0,xs:12},i.a.createElement(it.a,{position:"static",color:"default"},i.a.createElement(ut.a,{value:d,onChange:function(e,t){return p(t)},centered:!0},i.a.createElement(ct.a,{label:"Rooms"}),i.a.createElement(ct.a,{label:"Rounds",disabled:!Ye(c)}),i.a.createElement(ct.a,{label:"General"})))),i.a.createElement(f.a,{item:!0,xs:12},0===d&&i.a.createElement(bt,{wcif:c,onWcifChange:l}),1===d&&i.a.createElement(Tt,{wcif:c,onWcifChange:l,expectedCompetitorsByRound:g}),2===d&&i.a.createElement(Bt,{wcif:c,onWcifChange:l})),i.a.createElement(f.a,{item:!0},i.a.createElement(ot.a,{variant:"contained",component:D.a,to:"/competitions/".concat(c.id)},"Cancel")),i.a.createElement(f.a,{item:!0},i.a.createElement(ot.a,{variant:"contained",onClick:function(){var e=Ce("CompetitionConfig",c);l(K(e,["schedule","venues"],function(e){return K(e,["rooms"],function(e){return Ce("RoomConfig",K(e,["activities"],function(e){return Ce("ActivityConfig",e)}))})})),p(0)},disabled:tt(c)},"Clear")),i.a.createElement(f.a,{item:!0},i.a.createElement(tn,{wcif:t,updatedWcif:c,onWcifUpdate:n,disabled:!v})))},gn=n(571),vn=n(127),bn=n.n(vn),hn=n(594),yn=n(577),En=n(576),On=n(575),jn=[{id:"competitor",label:"Competitors"},{id:"staff-scrambler",label:"Scramblers"},{id:"staff-runner",label:"Runners"},{id:"staff-judge",label:"Judges"}],wn=function(e){var t=e.groupActivity,n=e.wcif,r=e.onClose,a=jn.map(function(e){return[e,n.persons.filter(function(n){return dn(n,t.id,e.id)})]}).filter(function(e){var t=Object(u.a)(e,2);t[0];return t[1].length>0});return i.a.createElement(hn.a,{open:!0,onClose:r,maxWidth:!1},i.a.createElement(On.a,null,De(t.activityCode)),i.a.createElement(En.a,null,i.a.createElement(f.a,{container:!0,spacing:1},a.map(function(e){var t=Object(u.a)(e,2),n=t[0],r=t[1];return i.a.createElement(f.a,{item:!0,xs:12,sm:6,md:!0,key:n.id},i.a.createElement(P.a,{variant:"subtitle2"},n.label),i.a.createElement(S.a,{dense:!0,style:{overflowY:"auto",maxHeight:300}},ce(r,function(e){return e.name}).map(function(e){return i.a.createElement(N.a,{key:e.wcaUserId},i.a.createElement(I.a,{primary:e.name}))})))}),0===a.length&&i.a.createElement(f.a,{item:!0},i.a.createElement(P.a,{variant:"body2"},"No assignments for this round.")))),i.a.createElement(yn.a,null,i.a.createElement(ot.a,{onClick:r,color:"secondary"},"Ok")))},Cn=function(e){var t=e.wcif,n=Object(a.useState)(null),r=Object(u.a)(n,2),o=r[0],c=r[1],l=t.events.filter(function(e){return!Re(e.id)}),s=Object(a.useCallback)(function(e){return i.a.createElement(f.a,{container:!0},Ke(t,e).map(function(e){var t=Object(u.a)(e,3),n=t[0],r=t[1],a=t[2];return a.length>0&&i.a.createElement(f.a,{item:!0,xs:12,sm:!0,key:n.id},i.a.createElement(st,{room:n}),i.a.createElement(S.a,null,a.map(function(e){return i.a.createElement(N.a,{key:e.id,button:!0,onClick:function(){return c(e)}},i.a.createElement(I.a,{primary:"Group ".concat(Pe(e.activityCode).groupNumber),secondary:Ae(e,r)}))})))}))},[t]);return i.a.createElement(a.Fragment,null,i.a.createElement(It,{events:l,render:s}),o&&i.a.createElement(wn,{groupActivity:o,wcif:t,onClose:function(){return c(null)}}))};function xn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function kn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xn(n,!0).forEach(function(t){Object(G.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xn(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Sn=function(e){return $(e.events,function(e){return e.rounds}).reduce(function(e,t){if(Re(t.id))return e;if(qe(e,t.id).length>0)return e;var n=function(e){return Math.max.apply(Math,Object(J.a)(ze(e).map(function(e){return e.id})))}(e),r=Ze(e,t.id).map(function(e){var t=we("ActivityConfig",e).groups,n=Te(e)/t,r=se(t,function(t){return{id:null,name:null,activityCode:null,startTime:pe(e.startTime,n*t),endTime:pe(e.startTime,n*t+n),childActivities:[],scrambleSetId:null}});return kn({},e,{childActivities:r})});return ue($(r,function(e){return e.childActivities}),function(e){return[e.startTime,e.endTime]}).forEach(function(e,r){var a="".concat(t.id,"-g").concat(r+1);return Object.assign(e,{id:n+r+1,name:De(a),activityCode:a})}),r.reduce(Le,e)},e)},Nn=function(e,t){return ce(t,function(t){return Re(t.id)?-1/0:qe(e,t.id).length}).reduce(function(e,t){var n=Dn(e,t.id);if(Re(t.id)){var r=ee(Ze(e,t.id),function(e){var t=e.activityCode;return Pe(t).attemptNumber}),a=Object.values(r).reduce(function(e,t){var n=Math.ceil(e.length/t.length),r=te(t,le(e,n));return $(r,function(e){var t=Object(u.a)(e,2),n=t[0],r=t[1];return _n(n.id,"competitor",r)})},n);return Hn(e,a)}var i=In(e,t.id,n.length).map(function(e){var t=Object(u.a)(e,2),n=t[0],r=t[1];return{id:n.id,activity:n,size:r,competitors:[]}}),o=n.reduce(function(t,n){var r=t.map(function(t){return Zn(e,t.activity,n)}),a=Math.max.apply(Math,Object(J.a)(r)),i=t.filter(function(e,t){return r[t]===a}),o=i.filter(function(r){return!qn(e,t,r.activity,n)}),c=o.length>0?o:i,u=c.find(function(e){var t=e.size;return e.competitors.length<t});if(u)return Wn(t,u.id,n);var l=c[c.length-1],s=Wn(t,l.id,n);return Rn(e,s,l.id)||Tn(e,s,l.id)||s},i),c=$(o,function(e){var t=e.activity,n=e.competitors;return _n(t.id,"competitor",n)});return Hn(e,c)},e)},In=function(e,t,n){var r=$(Ze(e,t),function(e){var t=we("ActivityConfig",e).capacity;return e.childActivities.map(function(n){return[n,t/e.childActivities.length]})}),a=te.apply(void 0,Object(J.a)(r)),i=Object(u.a)(a,2),o=i[0],c=i[1],l=Pn(c,n);return ce(te(o,l),function(e){var t=Object(u.a)(e,1)[0].activityCode;return Pe(t).groupNumber})},Pn=function e(t,n){var r=Object(_.a)(t),a=r[0],i=r.slice(1);if(!a)return[];var o=Math.round(a*n);return[o].concat(Object(J.a)(e(X(i),n-o)))},Dn=function(e,t){var n=we("CompetitionConfig",e).competitorsSortingRule,r=cn(e,t),a=Pe(t),i=a.eventId;if(a.roundNumber>1)return r;if("ranks"===n)return r;if("balanced"===n&&["333","222","333bf","333oh","333ft","pyram","skewb"].includes(i))return r;if(["balanced","symmetric"].includes(n)){var o=qe(e,t).length;return ce(r,function(e){return o-(r.length-r.indexOf(e)-1)%o})}if("name-optimised"===n){var c=ee(r,function(e){return e.name.split(" ")[0]});return ce(Object.values(c),function(e){return e.length}).reduce(function(e,t){var n=Math.ceil(e.length/t.length);return $(te(le(e,n),t),function(e){var t=Object(u.a)(e,2),n=t[0],r=t[1];return[].concat(Object(J.a)(n),[r])})})}throw new Error("Unrecognised competitors sorting rule: '".concat(n,"'"))},Rn=function e(t,n,r){var a=n.find(function(e){return e.id===r});return n.slice(n.indexOf(a)+1).reduce(function(i,o){if(i)return i;var c=ne(a.competitors,function(e){return Zn(t,a.activity,e)===Zn(t,o.activity,e)&&!qn(t,n,o.activity,e)});if(!c)return null;if(o.competitors.length<o.size)return Mn(n,r,o.id,c);if(o.competitors.length===o.size){var u=e(t,n,o.id);return u&&Mn(u,r,o.id,c)}return null},null)},Tn=function(e,t,n){var r=t.find(function(e){return e.id===n});return t.slice(0,t.indexOf(r)).reduceRight(function(a,i){if(a)return a;var o=r.competitors.find(function(n){return Zn(e,r.activity,n)===Zn(e,i.activity,n)&&!qn(e,t,i.activity,n)});if(!o)return null;var c=Rn(e,t,i.id);return c&&zn(c,n,i.id,o)},null)},An=function(e,t,n){return e.map(function(e){return e.id===t?Z(e,["competitors"],n):e})},Wn=function(e,t,n){return An(e,t,function(e){return[].concat(Object(J.a)(e),[n])})},Un=function(e,t,n){return An(e,t,function(e){return e.filter(function(e){return e!==n})})},Mn=function(e,t,n,r){return function(e,t,n){return An(e,t,function(e){return[n].concat(Object(J.a)(e))})}(Un(e,t,r),n,r)},zn=function(e,t,n,r){return Wn(Un(e,t,r),n,r)},Fn=function(e,t){var n=we("CompetitionConfig",e).noTasksForNewcomers;return ce(t,function(t){return cn(e,t.id).length}).reduce(function(e,t){if(Re(t.id))return e;var r=Pe(t.id).eventId;return Ze(e,t.id).reduce(function(e,a){var i=we("ActivityConfig",a).scramblers;return 0===i?e:a.childActivities.reduce(function(e,a){var o=fn(e).filter(function(e){return e.roles.includes("staff-scrambler")}),c=ae(cn(e,t.id),o),u=function(t){return t.filter(function(t){return Yn(e,a,t)})},l=ue(u(o),function(e){return[Math.floor(ln(e).length/3)].concat(Object(J.a)(an(e,r)))}),s=l.length>=i?[]:ue(u(c),function(t){return[n&&!t.wcaId?1:-1,un(t)>=10?-1:1,re(["staff-dataentry","delegate","organizer"],t.roles).length,sn(e,t,r).length>=2?1:-1,-Jn(e,t,a.startTime),Math.floor(ln(t).length/6),Gn(e,t,a.endTime)?1:-1].concat(Object(J.a)(an(t,r)))}),f=[].concat(Object(J.a)(l),Object(J.a)(s)),m=_n(a.id,"staff-scrambler",f.slice(0,i));return Hn(e,m)},e)},e)},e)},Bn=function(e,t){var n=we("CompetitionConfig",e),r=n.noTasksForNewcomers,a=n.tasksForOwnEventsOnly;return t.reduce(function(e,t){if(Re(t.id))return e;var n=Pe(t.id).eventId;return Ze(e,t.id).reduce(function(e,t){var i=we("ActivityConfig",t).runners;return 0===i?e:t.childActivities.reduce(function(e,t){var o=ie(fn(e),function(e){return e.roles.includes("staff-runner")}),c=Object(u.a)(o,2),l=c[0],s=c[1],f=function(n){return n.filter(function(n){return Yn(e,t,n)})},m=ue(f(l),function(n){return[Math.floor(ln(n).length/3),Gn(e,n,t.endTime)?1:-1]}),d=m.length>=i?[]:ue(f(s),function(i){return[r&&!i.wcaId?1:-1,a&&!i.registration.eventIds.includes(n)?1:-1,un(i)>=10?-1:1,re(["staff-dataentry","delegate","organizer"],i.roles).length,sn(e,i,n).length>=2?1:-1,-Jn(e,i,t.startTime),Math.floor(ln(i).length/6),Gn(e,i,t.endTime)?1:-1]}),p=[].concat(Object(J.a)(m),Object(J.a)(d)),g=_n(t.id,"staff-runner",p.slice(0,i));return Hn(e,g)},e)},e)},e)},Ln=function(e,t){var n=we("CompetitionConfig",e),r=n.noTasksForNewcomers,a=n.tasksForOwnEventsOnly;return t.reduce(function(e,t){if(Re(t.id))return e;var n=Pe(t.id).eventId;return Ze(e,t.id).reduce(function(e,t){var i=we("ActivityConfig",t).assignJudges,o=Me(e,t.id);return i?t.childActivities.reduce(function(e,t){var i=e.persons.filter(function(e){return dn(e,t.id,"competitor")}).length,c=Math.min(o,i),l=ie(fn(e),function(e){return e.roles.includes("staff-judge")}),s=Object(u.a)(l,2),f=s[0],m=s[1],d=function(n){return n.filter(function(n){return Yn(e,t,n)})},p=ue(d(f),function(n){return[ln(n).length,Gn(e,n,t.endTime)?1:-1]}),g=p.length>=c?[]:ue(d(m),function(i){return[r&&!i.wcaId?1:-1,a&&!i.registration.eventIds.includes(n)?1:-1,un(i)>=10?-1:1,re(["staff-dataentry","delegate","organizer"],i.roles).length,sn(e,i,n).length>=2?1:-1,-Jn(e,i,t.startTime),ln(i).length,Gn(e,i,t.endTime)?1:-1,i.registration?i.registration.eventIds.length:0]}),v=[].concat(Object(J.a)(p),Object(J.a)(g)),b=_n(t.id,"staff-judge",v.slice(0,c));return Hn(e,b)},e):e},e)},e)},Gn=function(e,t,n){var r=t.assignments.filter(function(e){return"competitor"===e.assignmentCode}).map(function(t){var n=t.activityId;return Be(e,n).startTime}).filter(function(e){return e>=n});if(0===r.length)return!1;var a=r.reduce(function(e,t){return e<t?e:t});return ge(a,n)<=9e5},Jn=function(e,t,n){var r=t.assignments.map(function(t){var n=t.activityId;return Be(e,n)}).filter(function(e){var t=e.startTime;return new Date(t).getDay()===new Date(n).getDay()});if(0===r.length)return 0;var a=te.apply(void 0,Object(J.a)(r.map(function(e){return[e.startTime,e.endTime]}))).map(function(e){return e.sort()}),i=Object(u.a)(a,2),o=i[0],c=i[1];if(o[0]>n)return 1+1/ge(n,o[0]);var l=ne(c,function(e){return e<=n}),s=o.find(function(e){return e>=n});if(l)if(s){if(ge(n,l)>36e5&&ge(n,s)>36e5)return 3}else if(ge(n,l)>18e5)return 2;return 4},_n=function(e,t,n){return n.map(function(n){return kn({},n,{assignments:[].concat(Object(J.a)(n.assignments),[{activityId:e,assignmentCode:t}])})})},Hn=function(e,t){return K(e,["persons"],function(e){return t.find(function(t){return t.wcaUserId===e.wcaUserId})||e})},Yn=function(e,t,n){return!n.assignments.some(function(n){var r=n.activityId;return We(Be(e,r),t)})},Zn=function(e,t,n){var r=n.assignments.map(function(n){var r=n.activityId;return function(e,t){if(!We(e,t))return 0;var n=[e.startTime,e.endTime,t.startTime,t.endTime].sort(),r=Object(u.a)(n,3),a=r[1],i=r[2];return new Date(i)-new Date(a)}(Be(e,r),t)});return-me(r)/Te(t)},qn=function(e,t,n,r){return re(["staff-dataentry","delegate","organizer"],r.roles).some(function(a){var i=fn(e).filter(function(e){return e.wcaUserId!==r.wcaUserId}).filter(function(e){return e.roles.includes(a)});return i.length>0&&i.every(function(r){return!Yn(e,n,r)||t.some(function(e){var t=e.activity;return e.competitors.includes(r)&&We(t,n)})})})},Kn=function(e,t){return Re(t)?1:fe(qe(e,t).map(function(e){return e.startTime+e.endTime})).length},Qn=function(e){var t=e.wcif,n=e.onWcifUpdate,r=Object(a.useState)(t),o=Object(u.a)(r,2),c=o[0],l=o[1],s=function(e){return e.events.every(function(t){return t.rounds.every(function(t){return qe(e,t.id).length>0})})}(c);return i.a.createElement(f.a,{container:!0,spacing:1,justify:"flex-end"},i.a.createElement(f.a,{item:!0,xs:12},!s&&i.a.createElement(gn.a,{style:{maxWidth:"none"},message:"To assign tasks you need to create groups first. This will also determine scramble set count for each round.",action:i.a.createElement(ot.a,{onClick:function(){l(function(e){return K(e,["events"],function(t){return K(t,["rounds"],function(t){return q(t,["scrambleSetCount"],Kn(e,t.id))})})}(Sn(c)))},style:{color:bn.a[500]},size:"small"},"Create groups")}),s&&et(c).length>0&&i.a.createElement(gn.a,{style:{maxWidth:"none"},message:"There are rounds with no tasks assigned.",action:i.a.createElement(ot.a,{onClick:function(){l(function(e){var t=et(e);return[Nn,Fn,Bn,Ln].reduce(function(e,n){return n(e,t)},e)}(c))},style:{color:bn.a[500]},size:"small"},"Assign tasks")})),i.a.createElement(f.a,{item:!0,xs:12},i.a.createElement(Cn,{wcif:c})),i.a.createElement(f.a,{item:!0},i.a.createElement(ot.a,{variant:"contained",component:D.a,to:"/competitions/".concat(c.id)},"Cancel")),i.a.createElement(f.a,{item:!0},i.a.createElement(yt.a,{title:"This clears groups and assignments only for rounds without results.",placement:"bottom"},i.a.createElement(ot.a,{variant:"contained",onClick:function(){l(nt(c))}},"Clear"))),i.a.createElement(f.a,{item:!0},i.a.createElement(tn,{wcif:t,updatedWcif:c,onWcifUpdate:n})))},Vn=n(161),Xn=n.n(Vn);fetch("/vfs-fonts.bundle.v2.json",{mode:"same-origin"}).then(function(e){return e.json()}).then(function(e){return Xn.a.vfs=e});var $n=function(e){return{normal:e,bold:e,italic:e,bolditalics:e}};Xn.a.fonts={Roboto:{normal:"Roboto-Regular.ttf",bold:"Roboto-Medium.ttf",italics:"Roboto-Italic.ttf",bolditalics:"Roboto-MediumItalic.ttf"},WenQuanYiZenHei:$n("WenQuanYiZenHei.ttf"),NotoSansThai:$n("NotoSansThaiUI-Regular.ttf"),NotoSansArabic:$n("NotoSansArabicUI-Regular.ttf"),NotoSansGeorgian:$n("NotoSansGeorgian-Regular.ttf"),NotoSansArmenian:$n("NotoSansArmenian-Regular.ttf")};var er=Xn.a,tr=function(e,t){return"333mbf"===t?"".concat(rr(e.attemptResult)," points"):"333fm"===t?"".concat(e.attemptResult," moves"):ar(e.attemptResult)},nr=function(e){var t=e.centiseconds,n=e.cumulativeRoundIds,r=ar(t);if(0===n.length)return r;if(1===n.length)return"".concat(r," in total");var a=n.map(function(e){var t=Pe(e),n=t.eventId,r=t.roundNumber;return"".concat(function(e){return Se("shortName",e)}(n)," R").concat(r)});return"".concat(r," total for ").concat(a.join(", "))},rr=function(e){return 99-Math.floor(e/1e7)%100},ar=function(e){var t=new Date(null);return t.setUTCMilliseconds(10*e),t.toISOString().substr(11,11).replace(/^[0:]*(?!\.)/g,"")},ir=function(e){var t=e.charCodeAt(0);return de(t,0,1327)?"Roboto":de(t,1536,1791)||de(t,1872,1919)?"NotoSansArabic":de(t,3584,3711)?"NotoSansThai":de(t,1328,1423)?"NotoSansArmenian":de(t,4256,4351)?"NotoSansGeorgian":"WenQuanYiZenHei"},or=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.swapLatinWithLocalNames,r=void 0!==n&&n,a=t.short,i=void 0!==a&&a,o=e.match(/(.+)\s*[(\uff08](.+)[)\uff09]/)||[null,e,null],c=Object(u.a)(o,3),l=c[1],s=c[2];if(!s)return l;var f=[l,{text:s,font:ir(s)}],m=r?f.reverse():f,d=Object(u.a)(m,2),p=d[0],g=d[1];return i?p:[p," (",g,")"]},cr=function(e){if(!e)return Promise.resolve(null);var t=new URLSearchParams({url:e,bri:50,bg:"white",w:200,h:200,t:"letterbox",output:"jpg",encoding:"base64"});return fetch("https://images.weserv.nl/?".concat(t.toString())).then(function(e){return e.text()}).catch(function(){return null})};function ur(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function lr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ur(n,!0).forEach(function(t){Object(G.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ur(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var sr={1:1,2:2,3:3,m:3,a:5},fr=function(e,t){return{background:[].concat(Object(J.a)(null===t?[]:[{x:60,y:170},{x:360,y:170},{x:60,y:590},{x:360,y:590}].map(function(e){return{absolutePosition:e,image:t}})),[{canvas:[mr({x1:20,y1:420.945,x2:575.28,y2:420.945}),mr({x1:297.64,y1:20,x2:297.64,y2:821.89})]}]),pageMargins:[20,20],content:{layout:{paddingLeft:function(e){return e%2===0?0:20},paddingRight:function(e){return e%2===0?20:0},paddingTop:function(e){return e%2===0?0:20},paddingBottom:function(e){return e%2===0?20:0},hLineWidth:function(){return 0},vLineWidth:function(){return 0}},table:{widths:["*","*"],heights:380.945,dontBreakRows:!0,body:le(e,2)}}}},mr=function(e){return lr({},e,{type:"line",lineWidth:.1,dash:{length:10},lineColor:"#888888"})},dr=function(e,t){var n=we("CompetitionConfig",e).localNamesFirst;return $(t,function(t){var r=pr(e,t.id),a=me(r.map(function(e){var t=Object(u.a)(e,2);t[0];return t[1].length}));return $(r,function(r){var i=Object(u.a)(r,2),o=i[0],c=i[1].map(function(r){return vr({scorecardNumber:a--,competitionName:e.shortName,activityCode:o.activityCode,round:t,attemptCount:sr[t.format],competitor:r,localNamesFirst:n})}),l=c.length%4;return 0===l?c:c.concat(se(4-l,function(){return{}}))})})},pr=function(e,t){var n=cn(e,t);if(n)return(Re(t)?qe(e,t).slice(0,1):ce(qe(e,t),function(e){var t=e.activityCode;return Pe(t).groupNumber})).map(function(e){return[e,n.filter(function(t){return dn(t,e.id,"competitor")})]});var r=on(e)[t].length;return(Re(t)?[[qe(e,t)[0],r]]:In(e,t,r)).map(function(e){var t=Object(u.a)(e,2),n=t[0],r=t[1];return[n,se(r,function(){return{name:" ",registrantId:" "}})]})},gr=function(e){var t=$(e.events,function(e){return e.rounds}).map(function(e){return sr[e.format]});return $(fe(t),function(t){return se(4,function(){return vr({competitionName:e.name,attemptCount:t})})})},vr=function(e){var t=e.scorecardNumber,n=e.competitionName,r=e.activityCode,a=e.round,i=e.attemptCount,o=void 0===i?5:i,c=e.competitor,u=void 0===c?{name:" ",registrantId:" "}:c,l=e.localNamesFirst,s=void 0!==l&&l,f=r?Pe(r):{},m=f.eventId,d=f.roundNumber,p=f.groupNumber,g=a||{},v=g.cutoff,b=g.timeLimit;return[{text:t,fontSize:10},{text:n,bold:!0,fontSize:15,margin:[0,0,0,10],alignment:"center"},{margin:[25,0,0,0],table:{widths:["*","auto","auto"],body:[br(["Event","Round","Group"]),[m?ke(m):" ",{text:d,alignment:"center"},{text:p,alignment:"center"}]]}},{margin:[25,0,0,0],table:{widths:[25,"*"],body:[br(["ID","Name"]),[{text:u.registrantId,alignment:"center"},{text:or(u.name,{swapLatinWithLocalNames:s}),maxHeight:20}]]}},{margin:[0,10,0,0],table:{widths:[16,25,"*",25,25],body:[br(["","Scr","Result","Judge","Comp"],{alignment:"center"})].concat(Object(J.a)(hr(v,o)),[[lr({text:"Extra attempt"},Or,{colSpan:5,margin:[0,1],fontSize:10})],Er("_"),[lr({text:""},Or,{colSpan:5,margin:[0,1]})]])}},{fontSize:10,columns:[v?{text:"Cutoff: ".concat(tr(v,m)),alignment:"center"}:{},b?{text:"Time limit: ".concat(nr(b)),alignment:"center"}:{}]}]},br=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.map(function(e){return lr({},t,{},Or,{fontSize:9,text:e})})},hr=function(e,t){return se(t,function(e){return Er(e+1)}).reduce(function(n,r,a){return[].concat(Object(J.a)(n),a+1===t?[r]:[r,yr(e&&a+1===e.numberOfAttempts)])},[])},yr=function(e){return[lr({},Or,{colSpan:5,margin:[0,1],columns:e?[{canvas:[{type:"line",x1:0,y1:0,x2:257.64,y2:0,dash:{length:5}}]}]:[]})]},Er=function(e){return[lr({text:e},Or,{fontSize:20,bold:!0,alignment:"center"}),{},{},{},{}]},Or={border:[!1,!1,!1,!1]},jr=function(e,t){return{footer:function(e,t){return{text:"".concat(e," of ").concat(t),alignment:"center",fontSize:10}},content:ue($($(t,function(t){return Ke(e,t.id)}),function(e){var t=Object(u.a)(e,3),n=t[0],r=t[1];return t[2].map(function(e){return[n,r,e]})}),function(e){var t=Object(u.a)(e,3),n=(t[0],t[1],t[2]),r=n.startTime,a=n.activityCode;return[r,Pe(a).groupNumber]}).map(function(t){var n=Object(u.a)(t,3),r=n[0],a=n[1],i=n[2];return wr(e,r,a,i)})}},wr=function(e,t,n,r){var a=[["Competitors","competitor"],["Scramblers","staff-scrambler"],["Runners","staff-runner"],["Judges","staff-judge"]].map(function(t){var n=Object(u.a)(t,2),a=n[0],i=n[1];return[a,e.persons.filter(function(e){return dn(e,r.id,i)})]}).filter(function(e){var t=Object(u.a)(e,2);t[0];return t[1].length>0});return{unbreakable:!0,margin:[0,0,0,10],stack:[{text:De(r.activityCode),bold:!0,fontSize:14},{columns:["Time: ".concat(Ae(r,n)),"Room: ".concat(t.name)],margin:[0,5,0,5]},{fontSize:8,columns:a.map(function(e){var t=Object(u.a)(e,2),n=t[0],r=t[1];return[{text:"".concat(n," (").concat(r.length,")"),bold:!0,fontSize:10,margin:[0,0,0,2]},{ul:r.map(function(e){return or(e.name,{short:!0})}).sort()}]})}]}},Cr=[{id:"competitor",label:""},{id:"staff-scrambler",label:"S"},{id:"staff-runner",label:"R"},{id:"staff-judge",label:"J"}],xr=function(e,t){var n=t.map(function(e){return e.id.split("-")[0]});!function(e,t){var n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}("groups.csv","Name,WCA_ID,"+n.map(function(e){return"G"+e+",H"+e+","}).join("")+"\n"+e.persons.map(function(t){return kr(t,n,e)}).join("\n"))},kr=function(e,t,n){var r=e.name+","+e.wcaId+",",a=Cr.map(function(e){return e.id}).map(function(t){return e.assignments.filter(function(e){return e.assignmentCode===t}).map(function(e){return Pe(Be(n,e.activityId).activityCode)})}),i=a.shift();return t.forEach(function(e){var t=i.filter(function(t){return t.eventId===e});if(t.length>0){r+=t.map(function(e){return e.groupNumber})+",";var n=a.map(function(t,n){return t.map(function(t){return t.eventId===e?String(Cr[n+1].label)+String(t.groupNumber):null})}).flat().filter(function(e){return null!=e});r+=n.join(" ")+","}else r+=",,"}),r},Sr=function(e){var t=e.wcif,n=function(e){return $e(e).filter(function(t){return Ve(e,t.id)}).filter(function(e){return"333fm"!==Pe(e.id).eventId})}(t),r=Object(a.useState)(n.every(function(e){return 1===Pe(e.id).roundNumber})?n:[]),o=Object(u.a)(r,2),c=o[0],l=o[1],s=ce(Xe(t).filter(function(e){return"333fm"!==Pe(e.id).eventId}),function(e){return Pe(e.id).roundNumber});return i.a.createElement(T.a,{style:{padding:16}},i.a.createElement(P.a,{variant:"subtitle1"},"Select rounds"),i.a.createElement(S.a,{style:{width:400}},s.map(function(e){return i.a.createElement(N.a,{key:e.id,button:!0,onClick:function(){return function(e){l(c.includes(e)?ae(c,[e]):[].concat(Object(J.a)(c),[e]))}(e)},style:n.includes(e)?{}:{opacity:.5}},i.a.createElement(R.a,null,i.a.createElement(Ot,{eventId:Pe(e.id).eventId})),i.a.createElement(I.a,{primary:De(e.id)}),i.a.createElement(mt.a,{checked:c.includes(e),tabIndex:-1,disableRipple:!0,style:{padding:0}}))})),i.a.createElement(f.a,{container:!0,spacing:1},i.a.createElement(f.a,{item:!0},i.a.createElement(ot.a,{onClick:function(){return function(e,t){var n=we("CompetitionConfig",e).scorecardsBackgroundUrl;cr(n).then(function(n){var r=fr(dr(e,t),n);er.createPdf(r).download("".concat(e.id,"-scorecards.pdf"))})}(t,c)},disabled:0===c.length},"Scorecards")),i.a.createElement(f.a,{item:!0},i.a.createElement(ot.a,{onClick:function(){return function(e,t){var n=jr(e,t);er.createPdf(n).download("".concat(e.id,"-group-overview.pdf"))}(t,c)},disabled:0===c.length},"Group overview")),i.a.createElement(f.a,{item:!0},i.a.createElement(ot.a,{onClick:function(){return xr(t,c)},disabled:0===c.length},"Export groups CSV")),i.a.createElement(f.a,{item:!0,style:{flexGrow:1}}),i.a.createElement(f.a,{item:!0},i.a.createElement(ot.a,{onClick:function(){return function(e){var t=we("CompetitionConfig",e).scorecardsBackgroundUrl;cr(t).then(function(t){var n=fr(gr(e),t);er.createPdf(n).download("".concat(e.id,"-blank-scorecards.pdf"))})}(t)}},"Blank scorecards"))))},Nr=function(e){return{pageMargins:[5,5],content:le(Ir(e),3).map(function(e){return{columns:e,fontSize:8,unbreakable:!0}})}},Ir=function(e){var t=ce(fn(e),function(e){return e.name}).map(function(t){return Pr(e,t)}),n=t.length%3;return 0===n?t:t.concat(se(3-n,function(){return{}}))},Pr=function(e,t){var n=e.events.filter(function(e){return!Re(e.id)}),r=(we("CompetitionConfig",e)||{localNamesFirst:!1}).localNamesFirst,a=t.assignments.map(function(t){var n=t.activityId,r=t.assignmentCode,a=Be(e,n),i=Pe(a.activityCode),o=i.eventId,c=i.roundNumber;return{assignmentCode:r,eventId:o,groupNumber:i.groupNumber,roundNumber:c}}).filter(function(e){return 1===e.roundNumber}),i=te.apply(void 0,Object(J.a)([["competitor","Comp"],["staff-scrambler","Scr"],["staff-runner","Run"],["staff-judge","Judge"]].filter(function(e){var t=Object(u.a)(e,1)[0];return a.some(function(e){return e.assignmentCode===t})}))),o=Object(u.a)(i,2),c=o[0],l=o[1];return{margin:[5,5],stack:[{text:or(t.name,{swapLatinWithLocalNames:r}),fontSize:10,maxHeight:20},{columns:["ID: ".concat(t.registrantId),{text:t.wcaId?"WCA ID: ".concat(t.wcaId):{},alignment:"right"}]},{table:{widths:["auto"].concat(Object(J.a)(l.map(function(){return"*"}))),body:[["Event"].concat(Object(J.a)(l.map(function(e){return{text:e,alignment:"center"}})))].concat(Object(J.a)(n.map(function(e){return[ke(e.id)].concat(Object(J.a)(c.map(function(t){return function(e,t){return{text:a.filter(function(n){return n.eventId===e&&n.assignmentCode===t}).map(function(e){return e.groupNumber}).join(", "),alignment:"center"}}(e.id,t)})))})))},layout:{paddingLeft:function(){return 2},paddingRight:function(){return 2},paddingTop:function(){return 1},paddingBottom:function(){return 1}}}].concat(Object(J.a)(se(Math.max(0,12-n.length),function(){return{text:" "}})))}},Dr=function(e){var t=e.wcif;return i.a.createElement(T.a,{style:{padding:16}},i.a.createElement(P.a,{variant:"body1"},"First round task assignments for every competitor. Useful to be distributed along with name tags."),i.a.createElement(ot.a,{onClick:function(){return function(e){var t=Nr(e);er.createPdf(t).download("".concat(e.id,"-competitor-cards.pdf"))}(t)}},"Download"))},Rr=function(e){var t=e.wcif,n=Object(a.useState)(0),r=Object(u.a)(n,2),o=r[0],c=r[1],l=et(t).map(function(e){return De(e.id)});return i.a.createElement(f.a,{container:!0,spacing:1,justify:"flex-end"},i.a.createElement(f.a,{item:!0,xs:12},l.length>0&&i.a.createElement(gn.a,{style:{maxWidth:"none"},message:"\n              The following rounds are missing task assignments:\n              ".concat(l.join(", "),".\n              You may want to assign them first.\n            "),action:i.a.createElement(ot.a,{component:D.a,to:"/competitions/".concat(t.id,"/groups"),style:{color:bn.a[500]},size:"small"},"Manage groups")})),i.a.createElement(f.a,{item:!0,xs:12},i.a.createElement(it.a,{position:"static",color:"default"},i.a.createElement(ut.a,{value:o,onChange:function(e,t){return c(t)},centered:!0},i.a.createElement(ct.a,{label:"Scorecards"}),i.a.createElement(ct.a,{label:"Competitor cards"})))),i.a.createElement(f.a,{item:!0,xs:12},0===o&&i.a.createElement(Sr,{wcif:t}),1===o&&i.a.createElement(Dr,{wcif:t})),i.a.createElement(f.a,{item:!0},i.a.createElement(ot.a,{variant:"contained",color:"primary",component:D.a,to:"/competitions/".concat(t.id)},"Done")))},Tr=n(579),Ar=n(583),Wr=n(582),Ur=n(580),Mr=n(597),zr=n(581),Fr=n(578),Br=n(256),Lr=n.n(Br);function Gr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Jr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gr(n,!0).forEach(function(t){Object(G.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gr(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var _r=[{id:"staff-scrambler",name:"Scrambler"},{id:"staff-judge",name:"Judge"},{id:"staff-runner",name:"Runner"},{id:"staff-dataentry",name:"Data entry"}],Hr=[5],Yr=function(e){var t=e.wcif,n=e.onWcifUpdate,r=Object(a.useState)(t),o=Object(u.a)(r,2),c=o[0],l=o[1],s=Object(a.useState)(0),m=Object(u.a)(s,2),d=m[0],p=m[1],g=Object(a.useState)(""),v=Object(u.a)(g,2),b=v[0],h=v[1],y=ce(fn(c),function(e){return e.name}),E=b?y.filter(function(e){return b.split(/\s*,\s*/).some(function(t){return t&&e.name.match(new RegExp(t,"i"))})}):y,O=function(e,t,n){var r=n.target.checked;l(Jr({},c,{persons:c.persons.map(function(n){return n.wcaUserId===t?Jr({},n,{roles:r?[].concat(Object(J.a)(n.roles),[e]):ae(n.roles,[e])}):n})}))};return i.a.createElement(f.a,{container:!0,spacing:1,justify:"flex-end"},i.a.createElement(f.a,{item:!0,xs:12},i.a.createElement(T.a,null,i.a.createElement(Fr.a,null,i.a.createElement(f.a,{container:!0,spacing:1,alignItems:"flex-end"},i.a.createElement(f.a,{item:!0},i.a.createElement(dt.a,{label:"Search",value:b,onChange:function(e){return function(e){h(e.target.value),p(0)}(e)}})),i.a.createElement(f.a,{item:!0},i.a.createElement(yt.a,{title:"If you separate search phrases with a comma, anyone matching either of them will show up.",placement:"right"},i.a.createElement(Lr.a,{color:"action"}))))),i.a.createElement("div",{style:{overflowX:"auto"}},i.a.createElement(Tr.a,null,i.a.createElement(Ur.a,null,i.a.createElement(zr.a,{style:{whiteSpace:"nowrap"}},i.a.createElement(Wr.a,null,"Person"),_r.map(function(e){return i.a.createElement(Wr.a,{key:e.id,padding:"none",align:"center",style:{minWidth:100}},e.name)}))),i.a.createElement(Ar.a,null,E.slice(5*d,5*d+5).map(function(e){return i.a.createElement(zr.a,{key:e.wcaUserId,hover:!0},i.a.createElement(Wr.a,null,e.name),_r.map(function(t){return i.a.createElement(Wr.a,{key:t.id,padding:"checkbox",align:"center"},i.a.createElement(mt.a,{checked:e.roles.includes(t.id),onChange:O.bind(void 0,t.id,e.wcaUserId)}))}))})))),i.a.createElement(Mr.a,{component:"div",count:E.length,rowsPerPage:5,rowsPerPageOptions:Hr,page:d,onChangePage:function(e,t){return p(t)}}))),i.a.createElement(f.a,{item:!0,xs:12},i.a.createElement(P.a,{variant:"caption",component:"div"},"Use this section only if you have a group of staff among competitors.\n            People with the given role will be prioritized during task assignment."),i.a.createElement(P.a,{variant:"caption"},"Note: if you don't set any roles, people will still be assigned tasks if configured to.")),i.a.createElement(f.a,{item:!0},i.a.createElement(ot.a,{variant:"contained",component:D.a,to:"/competitions/".concat(c.id)},"Cancel")),i.a.createElement(f.a,{item:!0},i.a.createElement(ot.a,{variant:"contained",onClick:function(){var e=_r.map(function(e){return e.id});l(Jr({},c,{persons:c.persons.map(function(t){return Jr({},t,{roles:ae(t.roles,e)})})}))}},"Clear")),i.a.createElement(f.a,{item:!0},i.a.createElement(tn,{wcif:t,updatedWcif:c,onWcifUpdate:n})))},Zr=function(e){var t=e.match,n=Object(a.useState)(null),r=Object(u.a)(n,2),o=r[0],c=r[1],s=Object(a.useState)(!0),f=Object(u.a)(s,2),m=f[0],d=f[1],p=Object(a.useState)([]),g=Object(u.a)(p,2),v=g[0],b=g[1];return Object(a.useEffect)(function(){var e;(e=t.params.competitionId,en("/competitions/".concat(e,"/wcif"))).then(function(e){return Z(e,["events"],Ne)}).then(function(e){c(e),b(function(e){var t=e.events;return $(t,function(t){if(0===t.rounds.length)return["No rounds specified for ".concat(De(t.id),".")];var n=$(t.rounds.slice(0,-1),function(e){return e.advancementCondition?[]:["No advancement condition specified for ".concat(De(e.id),".")]}),r=$(t.rounds,function(t){return Ze(e,t.id).length>0?[]:["No schedule activities for ".concat(De(t.id),".")]});return[].concat(Object(J.a)(n),Object(J.a)(r))})}(e))}).catch(function(e){return b([e.message])}).finally(function(){return d(!1)})},[t.params.competitionId]),m?i.a.createElement(k.a,null):i.a.createElement("div",null,0===v.length?i.a.createElement(a.Fragment,null,i.a.createElement(P.a,{variant:"h5",style:{marginBottom:16}},o.name),i.a.createElement(l.d,null,i.a.createElement(l.b,{exact:!0,path:t.url,render:function(e){return i.a.createElement(at,Object.assign({},e,{wcif:o,baseUrl:t.url}))}}),i.a.createElement(l.b,{path:"".concat(t.url,"/roles"),render:function(e){return i.a.createElement(Yr,Object.assign({},e,{wcif:o,onWcifUpdate:c}))}}),i.a.createElement(l.b,{path:"".concat(t.url,"/config"),render:function(e){return i.a.createElement(pn,Object.assign({},e,{wcif:o,onWcifUpdate:c}))}}),i.a.createElement(l.b,{path:"".concat(t.url,"/groups"),render:function(e){return i.a.createElement(Qn,Object.assign({},e,{wcif:o,onWcifUpdate:c}))}}),i.a.createElement(l.b,{path:"".concat(t.url,"/printing"),render:function(e){return i.a.createElement(Rr,Object.assign({},e,{wcif:o}))}}))):i.a.createElement(a.Fragment,null,i.a.createElement(P.a,{variant:"h5"},"Failed to load competition data"),i.a.createElement(S.a,null,v.map(function(e){return i.a.createElement(N.a,{key:e},i.a.createElement(I.a,null,e))}))))},qr=n(585),Kr=n(257),Qr=n.n(Kr),Vr=n(258),Xr=n.n(Vr),$r=function(){var e=Object(a.useState)([]),t=Object(u.a)(e,2),n=t[0],r=t[1],o=Object(a.useState)(!0),c=Object(u.a)(o,2),l=c[0],s=c[1],f=Object(a.useState)(null),m=Object(u.a)(f,2),d=m[0],p=m[1];return Object(a.useEffect)(function(){(function(){var e=new Date(Date.now()-6048e5),t=new URLSearchParams({managed_by_me:!0,start:e.toISOString()});return en("/competitions?".concat(t.toString()))})().then(function(e){r(ce(e,function(e){return e.start_date}))}).catch(function(e){return p(e.message)}).finally(function(){return s(!1)})},[]),i.a.createElement(T.a,null,i.a.createElement(S.a,{subheader:i.a.createElement(qr.a,null,"Your competitions")},d&&i.a.createElement(N.a,null,i.a.createElement(R.a,null,i.a.createElement(Qr.a,null)),i.a.createElement(I.a,{primary:"Couldn't fetch competitions: ".concat(d)})),!l&&!d&&0===n.length&&i.a.createElement(N.a,null,i.a.createElement(R.a,null,i.a.createElement(Xr.a,null)),i.a.createElement(I.a,{primary:"You have no upcoming competitions to manage."})),n.map(function(e){return i.a.createElement(N.a,{key:e.id,button:!0,component:D.a,to:"/competitions/".concat(e.id)},i.a.createElement(I.a,{primary:e.name}))})),l&&i.a.createElement(k.a,null))},ea=n(586),ta=n(260),na=n.n(ta),ra=n(261),aa=n.n(ra),ia=n(262),oa=n.n(ia),ca=n(259),ua=Object(h.a)(function(e){return{root:{padding:e.spacing(2)},icon:{verticalAlign:"middle",color:na.a[700]},grow:{flexGrow:1},link:{verticalAlign:"middle",fontWeight:500,color:aa.a[900],"&:hover":{textDecoration:"none",opacity:.7}}}}),la=[{text:"Donate",url:"https://ko-fi.com/jonatanklosko"},{text:"Guide",url:"https://github.com/jonatanklosko/groupifier-next/wiki/Guide"},{text:"GitHub",url:"https://github.com/jonatanklosko/groupifier-next"},{text:"Contact",url:"mailto:jonatanklosko@gmail.com"},{text:"v".concat(ca.a),url:"https://github.com/jonatanklosko/groupifier-next"}],sa=function(){var e=ua();return i.a.createElement(f.a,{container:!0,className:e.root},i.a.createElement(f.a,{item:!0},i.a.createElement(P.a,{variant:"body2"},"Made With ",i.a.createElement(oa.a,{className:e.icon})," by"," ",i.a.createElement(ea.a,{className:e.link,href:"https://github.com/jonatanklosko",target:"_blank",rel:"noopener noreferrer"},"Jonatan K\u0142osko"))),i.a.createElement(f.a,{item:!0,className:e.grow}),i.a.createElement(f.a,{item:!0},i.a.createElement(f.a,{container:!0,spacing:1},la.map(function(t){var n=t.text,r=t.url;return i.a.createElement(f.a,{item:!0,key:n},i.a.createElement(ea.a,{className:e.link,variant:"body2",href:r,target:"_blank",rel:"noopener noreferrer"},n))}))))},fa=Object(h.a)(function(e){return{title:{flexGrow:1},titleLink:{color:"inherit",textDecoration:"none"},titleIcon:{fontSize:"1.5em",verticalAlign:"middle",marginRight:e.spacing(1)}}}),ma=function(e){var t=e.isSignedIn,n=e.onSignIn,r=e.onSignOut,a=fa();return i.a.createElement(it.a,{position:"static",color:"primary"},i.a.createElement(Fr.a,null,i.a.createElement(P.a,{variant:"h6",className:a.title},i.a.createElement(D.a,{to:t?"/competitions":"/",className:a.titleLink},i.a.createElement(W.a,{className:a.titleIcon}),"Groupifier")),t?i.a.createElement(ot.a,{color:"inherit",onClick:r},"Sign out"):i.a.createElement(ot.a,{color:"inherit",onClick:n},"Sign in")))},da=n(263),pa=n.n(da),ga=["Allows for marking competitors as different kinds of staff and handles them in a special manner.","Supports multiple rooms/stages running simultaneously.","Suggests number of groups and necessary roles, while leaving the final decision to the user.","Once configured, creates groups and does its best to optimally assign people to these groups.","Generates documents like scorecards and competitor cards with task assignments."],va=function(){return i.a.createElement(f.a,{container:!0,spacing:1,direction:"column"},i.a.createElement(f.a,{item:!0},i.a.createElement(P.a,{variant:"h4"},"What is Groupifier?")),i.a.createElement(f.a,{item:!0},i.a.createElement(P.a,{variant:"subtitle1"},"Task and group management tool for WCA competition organizers. It's\n          designed to be highly customizable and work well with complex schedules.")),i.a.createElement(f.a,{item:!0},i.a.createElement(P.a,{variant:"h4"},"What does it do?")),i.a.createElement(f.a,{item:!0},i.a.createElement(S.a,null,ga.map(function(e){return i.a.createElement(N.a,{key:e},i.a.createElement(R.a,null,i.a.createElement(pa.a,null)),i.a.createElement(I.a,{primary:e}))}))))},ba=Object(m.a)({palette:{primary:{main:g.a[900]},secondary:b.a}}),ha=Object(h.a)(function(e){return{root:{display:"flex",minHeight:"100vh",flexDirection:"column"},grow:{flexGrow:1},main:{padding:e.spacing(2)}}}),ya=function(){var e=ha(),t=Object(a.useState)(Xt()),n=Object(u.a)(t,2),r=n[0],o=n[1];return i.a.createElement(l.c,{history:x},i.a.createElement(d.a,{theme:ba},i.a.createElement("div",{className:e.root},i.a.createElement(s.a,null),i.a.createElement(ma,{isSignedIn:r,onSignIn:function(){Kt()},onSignOut:function(){Vt(),o(!1)}}),i.a.createElement(f.a,{container:!0,justify:"center",className:e.grow},i.a.createElement(f.a,{item:!0,xs:12,md:8,xl:6,className:e.main},r?i.a.createElement(l.d,null,i.a.createElement(l.b,{path:"/competitions/:competitionId",component:Zr}),i.a.createElement(l.b,{path:"/competitions",component:$r}),i.a.createElement(l.a,{to:"/competitions"})):i.a.createElement(l.d,null,i.a.createElement(l.b,{exact:!0,path:"/",component:va}),i.a.createElement(l.a,{to:"/"})))),i.a.createElement(sa,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));!function(){var e=window.location.hash.replace(/^#/,""),t=new URLSearchParams(e);if(t.has("access_token")&&localStorage.setItem(Zt("accessToken"),t.get("access_token")),t.has("expires_in")){var n=t.get("expires_in")-900,r=new Date((new Date).getTime()+1e3*n);localStorage.setItem(Zt("expirationTime"),r.toISOString())}var a=localStorage.getItem(Zt("expirationTime"));a&&new Date>=new Date(a)&&Vt(),t.has("access_token")&&x.replace(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yt(n,!0).forEach(function(t){Object(G.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yt(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},x.location,{hash:null}));var i=localStorage.getItem(Zt("redirectPath"));i&&(x.replace(i),localStorage.removeItem(Zt("redirectPath")));var o=window.location.pathname;o.startsWith("/competitions")&&!Xt()&&(localStorage.setItem(Zt("redirectPath"),o),Kt())}(),c.a.render(i.a.createElement(ya,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[279,1,2]]]);
//# sourceMappingURL=main.945641cd.chunk.js.map