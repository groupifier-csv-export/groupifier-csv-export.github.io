{"version":3,"sources":["polyfills.js","logic/history.js","logic/utils.js","logic/wcif-extensions.js","logic/events.js","logic/activities.js","logic/formulas.js","components/Competition/CompetitionMenu/CompetitionMenu.js","components/common/RoomName/RoomName.js","components/common/PositiveIntegerInput/PositiveIntegerInput.js","components/common/ZeroablePositiveIntegerInput/ZeroablePositiveIntegerInput.js","components/Competition/ConfigManager/RoomConfig/RoomConfig.js","components/Competition/ConfigManager/RoomsConfig/RoomsConfig.js","components/common/CubingIcon/CubingIcon.js","components/common/EventSelect/EventSelect.js","components/common/RoundsNavigation/RoundPanel/RoundPanel.js","components/common/RoundsNavigation/RoundsNavigation.js","components/Competition/ConfigManager/RoundActivityConfig/RoundActivityConfig.js","components/Competition/ConfigManager/RoundConfig/RoundConfig.js","components/Competition/ConfigManager/RoundsConfig/RoundsConfig.js","components/Competition/ConfigManager/GeneralConfig/GeneralConfig.js","logic/wca-env.js","logic/auth.js","logic/wca-api.js","components/common/SaveWcifButton/SaveWcifButton.js","logic/wcif.js","logic/competitors.js","components/Competition/ConfigManager/ConfigManager.js","components/Competition/GroupsManager/GroupDialog/GroupDialog.js","components/Competition/GroupsManager/GroupsNavigation/GroupsNavigation.js","logic/groups.js","components/Competition/GroupsManager/GroupsManager.js","logic/documents/pdfmake.js","logic/formatters.js","logic/documents/pdf-utils.js","logic/documents/scorecards.js","logic/documents/group-overview.js","logic/documents/group-csv.js","components/Competition/PrintingManager/Scorecards/Scorecards.js","logic/documents/competitor-cards.js","components/Competition/PrintingManager/CompetitorCards/CompetitorCards.js","components/Competition/PrintingManager/PrintingManager.js","components/Competition/RolesManager/RolesManager.js","components/Competition/Competition.js","logic/wcif-validation.js","components/CompetitionList/CompetitionList.js","components/Footer/Footer.js","components/Header/Header.js","components/Home/Home.js","components/App/App.js","registerServiceWorker.js","index.js"],"names":["smoothscroll","polyfill","preserveQueryParams","history","location","query","URLSearchParams","search","newQuery","has","set","toString","createLocationObject","path","state","pathname","createBrowserHistory","originalPush","push","apply","originalReplace","replace","updateIn","object","updater","property","properyChain","length","setIn","value","mapIn","mapper","array","map","isPresentDeep","obj","Object","values","every","pluralize","count","singular","plural","scaleToOne","arr","arrSum","sum","x","flatMap","fn","reduce","xs","concat","groupBy","zip","arrs","_","i","findLast","predicate","reduceRight","found","undefined","intersection","ys","filter","includes","difference","partition","sortCompare","y","sortBy","slice","sort","sortByArray","Map","result","firstResult","get","a","b","chunk","size","times","n","Array","from","index","uniq","Set","inRange","addMilliseconds","isoString","milliseconds","Date","getTime","toISOString","isoTimeDiff","first","second","Math","abs","shortTime","timeZone","toLocaleTimeString","hour","minute","groupifierExtensionId","extensionName","buildGroupifierExtension","data","id","specUrl","setExtensionData","wcifEntity","otherExtensions","extensions","extension","defaultExtensionData","ActivityConfig","RoomConfig","stations","CompetitionConfig","localNamesFirst","scorecardsBackgroundUrl","competitorsSortingRule","noTasksForNewcomers","tasksForOwnEventsOnly","getExtensionData","find","defaultData","removeExtensionData","events","name","shortName","eventNameById","eventId","propertyById","event","sortWcifEvents","wcifEvents","wcifEvent","findIndex","parseActivityCode","activityCode","match","e","r","g","roundNumber","parseInt","groupNumber","attemptNumber","activityCodeToName","join","hasDistributedAttempts","activityDuration","startTime","endTime","activityDurationString","timezone","activitiesOverlap","rooms","wcif","schedule","venues","venue","stationsByActivity","activityId","room","activities","some","roomByActivity","allActivities","allChildActivities","childActivities","activitiesByIdCachedBySchedule","activityById","activitiesById","activity","updateActivity","updatedActivity","populateRoundActivitiesConfig","expectedCompetitorsByRound","defaults","rounds","round","expectedRoundCompetitors","roundActivities","shouldHaveGroups","capacities","capacity","competitors","groups","preferredGroupSize","calculatedGroupCount","max","suggestedGroupCount","scramblers","assignScramblers","groupCompetitors","floor","min","suggestedScramblerCount","runners","assignRunners","suggestedRunnerCount","assignJudges","anyActivityConfig","activitiesConfigComplete","roomsConfigComplete","roundId","startsWith","groupActivitiesByRound","roomsWithTimezoneAndGroups","activityAssigned","persons","person","assignments","assignment","groupActivitiesAssigned","roundsWithoutResults","results","attempts","roundsMissingResults","roundsMissingAssignments","anyGroupAssignedOrCreated","clearGroupsAndAssignments","clearableRounds","clearableRoundIds","clearableActivityIds","assignmentCode","menuItems","text","icon","PermContactCalendarIcon","enabled","SettingsIcon","PeopleIcon","PrintIcon","anyCompetitorAssignment","CompetitionMenu","baseUrl","Paper","List","menuItem","ListItem","key","button","component","Link","to","disabled","ListItemIcon","ListItemText","primary","useStyles","makeStyles","theme","roomDot","display","width","height","marginRight","borderRadius","RoomName","classes","Typography","variant","className","style","backgroundColor","color","PositiveIntegerInput","React","memo","onChange","props","TextField","type","onKeyPress","preventDefault","target","newValue","Number","isNaN","ZeroablePositiveIntegerInput","inputRef","useRef","shouldFocusRef","useEffect","current","focus","Checkbox","checked","label","RoomsConfig","onWcifChange","handleRoomChange","updatedRoom","padding","Grid","container","spacing","item","CubingIcon","fontSize","EventSelect","selected","Tooltip","title","placement","IconButton","onClick","opacity","RoundPanel","expanded","render","ExpansionPanel","TransitionProps","onEntered","node","window","scrollTo","top","parentNode","getBoundingClientRect","behavior","ExpansionPanelSummary","expandIcon","ExpansionPanelDetails","RoundsNavigation","useState","selectedEventId","setSelectedEventId","expandedRoundId","setExpandedRoundId","selectedEvent","RoundActivityConfig","expectedCompetitors","groupSize","groupsHelperText","scramblersHelperText","runnersHelperText","groupsCreated","groupsAssigned","handlePropertyChange","handleInputChange","direction","helperText","margin","FormControlLabel","control","RoundConfig","activitiesWithRooms","RoundsConfig","options","setOptions","activityCodesMissingConfig","activitiesWithUnpopulatedConfig","renderRound","useCallback","roleLabel","Button","competitorsSortingRules","description","GeneralConfig","handleCheckboxChange","handleTextFieldChange","FormControl","fullWidth","InputLabel","htmlFor","Select","inputProps","MenuItem","FormHelperText","PRODUCTION","WCA_ORIGIN","WCA_OAUTH_CLIENT_ID","localStorageKey","wcaAccessToken","localStorage","getItem","signIn","params","client_id","response_type","redirect_uri","oauthRedirectUri","scope","appUri","origin","signOut","removeItem","isSignedIn","saveWcifChanges","previousWcif","newWcif","competitionId","keysDiff","keys","Promise","resolve","newObj","wcaApiFetch","method","body","JSON","stringify","fetchOptions","baseApiUrl","fetch","assign","headers","Headers","Authorization","then","response","ok","Error","statusText","json","withRouter","updatedWcif","onWcifUpdate","saving","setSaving","failed","setFailed","Snackbar","open","message","anchorOrigin","vertical","horizontal","autoHideDuration","onClose","catch","visibility","CircularProgress","position","eventById","best","personalBest","personalBests","pb","Infinity","bestAverageAndSingle","competitor","getExpectedCompetitorsByRound","firstRound","nextRounds","acceptedPeopleRegisteredForEvent","nextRound","advancementCondition","nextRoundCompetitors","sortedCompetitors","level","competitorsExpectedToAdvance","competitorsForRound","competitorsInRound","roundById","personId","registrantId","personById","previous","previousRound","ranking","age","diffMs","now","birthdate","staffAssignments","staffAssignmentsForEvent","acceptedPeople","registration","status","eventIds","hasAssignment","ConfigManager","localWcif","setLocalWcif","tabValue","setTabValue","useMemo","wcifConfigComplete","justify","AppBar","Tabs","centered","Tab","withoutCompetitionConfig","roles","GroupDialog","groupActivity","rolesWithPeople","role","Dialog","maxWidth","DialogTitle","DialogContent","people","sm","md","dense","overflowY","maxHeight","wcaUserId","DialogActions","GroupsNavigation","openedGroupActivity","setOpenGroupActivity","groupActivities","secondary","createGroupActivities","currentActivityId","maxActivityId","activitiesWithGroups","groupDuration","scrambleSetId","forEach","assignGroups","roundsToAssign","sortedCompetitorsForRound","activitiesByAttempt","updatedCompetitors","attemptActivities","competitorsPerActivity","ceil","activitiesWithCompetitors","assignActivity","updatePeople","initialGroups","sortedGroupActivitiesWithSize","availabilityRates","group","availabilityRate","maxAvailabilityRate","mostAvailableGroups","preferredGroups","overlapsEveryoneWithSameRole","potentialGroups","notFullGroup","addCompetitorToGroupEnd","updatedGroups","moveSomeoneRight","moveSomeoneLeft","competitorCount","groupActivitiesWithCapacity","groupSizes","calculateGroupSizes","sortedByRanks","groupCount","indexOf","competitorsByName","split","competitorsWithSameName","chunkSize","groupId","furtherGroup","competitorToMove","moveCompetitorToGroupStart","groupsWithSpot","previousGroup","moveCompetitorToGroupEnd","updateCompetitorsInGroup","removeCompetitorFromGroup","other","fromGroupId","toGroupId","addCompetitorToGroupStart","assignScrambling","staffScramblers","available","availableDuring","sortedAvailableStaff","sortedAvailableCompetitors","wcaId","presenceRate","competesIn15Minutes","potentialScramblers","assignRunning","staffRunners","sortedAvailablePeople","potentialRunners","updatedPeople","assignJudging","judges","staffJudges","potentialJudges","competingStartTimes","competingStart","time","activitiesThisDay","getDay","startTimes","endTimes","previousEndTime","nextStartTime","updatedPerson","intersections","middleStart","middleEnd","activitiesIntersection","others","scrambleSetCountForRound","GroupsManager","allGroupsCreated","SnackbarContent","action","updateScrambleSetCount","pink","assignmentFn","assignTasks","mode","vfsFonts","pdfMake","vfs","singleFileFont","file","normal","bold","italic","bolditalics","fonts","Roboto","italics","WenQuanYiZenHei","NotoSansThai","NotoSansArabic","NotoSansGeorgian","NotoSansArmenian","cutoffToString","cutoff","multibldAttemptResultToPoints","attemptResult","centisecondsToClockFormat","timeLimitToString","timeLimit","centiseconds","cumulativeRoundIds","clockFormat","roundStrings","shortEventNameById","date","setUTCMilliseconds","substr","determineFont","code","charCodeAt","pdfName","swapLatinWithLocalNames","short","latinName","localName","pdfNames","font","reverse","getImageDataUrl","url","bri","bg","w","h","t","output","encoding","maxAttemptCountByFormat","m","scorecardsPdfDefinition","scorecardList","imageData","background","absolutePosition","image","canvas","cutLine","x1","y1","pageHeight","x2","pageWidth","y2","pageMargins","content","layout","paddingLeft","paddingRight","paddingTop","paddingBottom","hLineWidth","vLineWidth","table","widths","heights","dontBreakRows","properties","lineWidth","dash","lineColor","scorecards","groupsWithCompetitors","groupActivitiesWithCompetitors","scorecardNumber","groupScorecards","scorecard","competitionName","attemptCount","format","scorecardsOnLastPage","expectedCompetitorCount","blankScorecards","attemptCounts","alignment","columnLabels","attemptRows","noBorder","colSpan","attemptRow","columns","labels","attemptIndex","rows","attemptsSeparator","numberOfAttempts","cutoffLine","border","groupOverviewPdfDefinition","footer","currentPage","pageCount","overviewForGroup","headersWithPeople","header","unbreakable","stack","ul","downloadGroupCsv","filename","element","document","createElement","setAttribute","encodeURIComponent","appendChild","click","removeChild","download","lineForCompetitor","line","actsByType","competingGroup","shift","compGroupEvent","act","strHelpingAssignments","acts","String","flat","Scorecards","missingScorecards","roundsMissingScorecards","selectedRounds","setSelectedRounds","handleRoundClick","tabIndex","disableRipple","pdfDefinition","createPdf","downloadScorecards","downloadGroupOverview","flexGrow","downloadBlankScorecards","competitorCardsPdfDefinition","competitorCards","cards","competitorCard","cardsInLastRow","tasks","task","assignmentCodes","groupsText","CompetitorCards","downloadCompetitorCards","PrintingManager","roundsMissingAssignmentsNames","rowsPerPageOptions","RolesManager","page","setPage","searchString","setSearchString","allSortedPeople","searchPart","RegExp","handleRoleChange","roleId","personWcaUserId","Toolbar","alignItems","handleSearchStringChange","overflowX","Table","TableHead","TableRow","whiteSpace","TableCell","align","minWidth","TableBody","hover","bind","TablePagination","rowsPerPage","onChangePage","roleIds","Competition","setWcif","loading","setLoading","errors","setErrors","advancementConditionErrors","roundActivityErrors","validateWcif","error","finally","LinearProgress","marginBottom","exact","CompetitionList","competitions","setCompetitions","setError","oneWeekAgo","managed_by_me","start","getUpcomingManageableCompetitions","competition","subheader","ListSubheader","root","verticalAlign","red","grow","link","fontWeight","grey","textDecoration","links","version","Footer","href","rel","titleLink","titleIcon","Header","onSignIn","onSignOut","features","Home","feature","createMuiTheme","palette","main","blueGrey","blue","minHeight","flexDirection","App","signedIn","setSignedIn","ThemeProvider","CssBaseline","xl","Boolean","hostname","hash","hashParams","setItem","expiresInSeconds","expirationTime","redirectPath","initializeAuth","ReactDOM","getElementById","navigator","serviceWorker","ready","unregister"],"mappings":"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","file":"static/js/main.945641cd.chunk.js","sourcesContent":["import 'react-app-polyfill/stable';\n\nimport smoothscroll from 'smoothscroll-polyfill';\nsmoothscroll.polyfill();\n","/* Customized history preserving `staging` query parameter on location change. */\n\nimport { createBrowserHistory } from 'history';\n\nconst preserveQueryParams = (history, location) => {\n  const query = new URLSearchParams(history.location.search);\n  const newQuery = new URLSearchParams(location.search);\n  if (query.has('staging')) {\n    newQuery.set('staging', 'true');\n    location.search = newQuery.toString();\n  }\n  return location;\n};\n\nconst createLocationObject = (path, state) => {\n  return typeof path === 'string' ? { pathname: path, state } : path;\n};\n\nconst history = createBrowserHistory();\n\nconst originalPush = history.push;\nhistory.push = (path, state) => {\n  return originalPush.apply(history, [\n    preserveQueryParams(history, createLocationObject(path, state)),\n  ]);\n};\n\nconst originalReplace = history.replace;\nhistory.replace = (path, state) => {\n  return originalReplace.apply(history, [\n    preserveQueryParams(history, createLocationObject(path, state)),\n  ]);\n};\n\nexport default history;\n","/**\n * Returns a copy of the object with the value at the specified path transformed by the update function.\n *\n * @param {Object} object\n * @param {Array} propertyChain\n * @param {Function} updater\n * @returns {Object}\n */\nexport const updateIn = (object, [property, ...properyChain], updater) =>\n  properyChain.length === 0\n    ? { ...object, [property]: updater(object[property]) }\n    : {\n        ...object,\n        [property]: updateIn(object[property], properyChain, updater),\n      };\n\n/**\n * Returns a copy of the object with the value at the specified path set to the given one.\n *\n * @param {Object} object\n * @param {Array} propertyChain\n * @param {*} value\n * @returns {Object}\n */\nexport const setIn = (object, properyChain, value) =>\n  updateIn(object, properyChain, () => value);\n\n/**\n * Returns a copy of the object with the value at the specified path merged with the given one.\n *\n * @param {Object} object\n * @param {Array} propertyChain\n * @param {Object} newValue\n * @returns {Object}\n */\nexport const mergeIn = (object, properyChain, newValue) =>\n  updateIn(object, properyChain, currentValue => ({\n    ...currentValue,\n    ...newValue,\n  }));\n\n/**\n * Returns a copy of the object with the array at the specified path mapped with the given function.\n *\n * @param {Object} object\n * @param {Array} propertyChain\n * @param {Object} mapper\n * @returns {Object}\n */\nexport const mapIn = (object, properyChain, mapper) =>\n  updateIn(object, properyChain, array => array && array.map(mapper));\n\n/**\n * Returns object's value at the specified path or the default value if it doesn't exist.\n *\n * @param {Object} object\n * @param {Array} propertyChain\n * @param {*} defaultValue\n * @returns {*}\n */\nexport const getIn = (\n  object,\n  [property, ...propertyChain],\n  defaultValue = null\n) =>\n  object\n    ? propertyChain.length === 0\n      ? object.hasOwnProperty(property)\n        ? object[property]\n        : defaultValue\n      : getIn(object[property], propertyChain, defaultValue)\n    : defaultValue;\n\n/**\n * Checks if the given value is an object.\n *\n * @param {*} value\n * @returns {boolean}\n */\nconst isObject = obj => obj === Object(obj);\n\n/**\n * When given an object, deeply checks if it doesn't contain null values.\n * Otherwise, checks if the given value is not null.\n *\n * @param {*} value\n * @returns {boolean}\n */\nexport const isPresentDeep = value =>\n  isObject(value) ? Object.values(value).every(isPresentDeep) : value != null;\n\n/**\n * Pluralizes a word according to the given number.\n * When no plural form given, uses singular form with an 's' appended.\n *\n * @param {number} count\n * @param {string} singular\n * @param {string} plural\n * @returns {string}\n */\nexport const pluralize = (count, singular, plural) =>\n  `${count} ${count === 1 ? singular : plural || singular + 's'}`;\n\n/**\n * Returns a new array with items summing up to 1, preserving elements proportionality.\n * When the given array is empty, returns an empty array.\n *\n * @param {Array} arr\n * @returns {Array}\n */\nexport const scaleToOne = arr => {\n  if (arr.length === 0) return [];\n  const arrSum = sum(arr);\n  return arr.map(x => (arrSum !== 0 ? x / arrSum : 1 / arr.length));\n};\n\n/**\n * Applies the given function to the elements and returns the first truthy value of these calls.\n *\n * @param {Array} arr\n * @returns {*}\n */\nexport const firstResult = (arr, fn) =>\n  arr.reduce((result, x) => result || fn(x), null);\n\nexport const flatMap = (arr, fn) => arr.reduce((xs, x) => xs.concat(fn(x)), []);\n\nexport const groupBy = (arr, fn) =>\n  arr.reduce(\n    (obj, x) => updateIn(obj, [fn(x)], xs => (xs || []).concat(x)),\n    {}\n  );\n\nexport const zip = (...arrs) =>\n  arrs.length === 0 ? [] : arrs[0].map((_, i) => arrs.map(arr => arr[i]));\n\nexport const findLast = (arr, predicate) =>\n  arr.reduceRight(\n    (found, x) => (found !== undefined ? found : predicate(x) ? x : undefined),\n    undefined\n  );\n\nexport const intersection = (xs, ys) => xs.filter(x => ys.includes(x));\n\nexport const difference = (xs, ys) => xs.filter(x => !ys.includes(x));\n\nexport const partition = (xs, fn) => [xs.filter(fn), xs.filter(x => !fn(x))];\n\nconst sortCompare = (x, y) => (x < y ? -1 : x > y ? 1 : 0);\n\nexport const sortBy = (arr, fn) =>\n  arr.slice().sort((x, y) => sortCompare(fn(x), fn(y)));\n\nexport const sortByArray = (arr, fn) => {\n  const values = new Map(\n    arr.map(x => [x, fn(x)])\n  ); /* Compute every value once. */\n  return arr\n    .slice()\n    .sort((x, y) =>\n      firstResult(zip(values.get(x), values.get(y)), ([a, b]) =>\n        sortCompare(a, b)\n      )\n    );\n};\n\nexport const chunk = (arr, size) =>\n  arr.length <= size\n    ? [arr]\n    : [arr.slice(0, size), ...chunk(arr.slice(size), size)];\n\nexport const times = (n, fn) =>\n  Array.from({ length: n }, (_, index) => fn(index));\n\nexport const uniq = arr => [...new Set(arr)];\n\nexport const sum = arr => arr.reduce((x, y) => x + y, 0);\n\nexport const pick = (obj, keys) =>\n  keys.reduce((newObj, key) => ({ ...newObj, [key]: obj[key] }), {});\n\nexport const inRange = (x, a, b) => a <= x && x <= b;\n\nexport const addMilliseconds = (isoString, milliseconds) =>\n  new Date(new Date(isoString).getTime() + milliseconds).toISOString();\n\nexport const isoTimeDiff = (first, second) =>\n  Math.abs(new Date(first) - new Date(second));\n\nexport const shortTime = (isoString, timeZone = 'UTC') =>\n  new Date(isoString).toLocaleTimeString('en-US', {\n    timeZone,\n    hour: 'numeric',\n    minute: 'numeric',\n  });\n","const groupifierExtensionId = extensionName => `groupifier.${extensionName}`;\n\nconst buildGroupifierExtension = (extensionName, data) => ({\n  id: groupifierExtensionId(extensionName),\n  specUrl: `https://groupifier.jonatanklosko.com/wcif-extensions/${extensionName}.json`,\n  data,\n});\n\nexport const setExtensionData = (extensionName, wcifEntity, data) => {\n  const otherExtensions = wcifEntity.extensions.filter(\n    extension => extension.id !== groupifierExtensionId(extensionName)\n  );\n  return {\n    ...wcifEntity,\n    extensions: [\n      ...otherExtensions,\n      buildGroupifierExtension(extensionName, data),\n    ],\n  };\n};\n\nconst defaultExtensionData = {\n  ActivityConfig: null /* This always gets generated, so it's fine for it to be null until then. */,\n  RoomConfig: {\n    stations: null,\n  },\n  CompetitionConfig: {\n    localNamesFirst: false,\n    scorecardsBackgroundUrl: '',\n    competitorsSortingRule: 'ranks',\n    noTasksForNewcomers: false,\n    tasksForOwnEventsOnly: false,\n  },\n};\n\nexport const getExtensionData = (extensionName, wcifEntity) => {\n  const extension = wcifEntity.extensions.find(\n    extension => extension.id === groupifierExtensionId(extensionName)\n  );\n  const defaultData = defaultExtensionData[extensionName];\n  if (defaultData === null) return extension && extension.data;\n  return extension ? { ...defaultData, ...extension.data } : defaultData;\n};\n\nexport const removeExtensionData = (extensionName, wcifEntity) => ({\n  ...wcifEntity,\n  extensions: wcifEntity.extensions.filter(\n    extension => extension.id !== groupifierExtensionId(extensionName)\n  ),\n});\n","import { sortBy } from './utils';\n\nconst events = [\n  { id: '333', name: '3x3x3 Cube', shortName: '3x3' },\n  { id: '222', name: '2x2x2 Cube', shortName: '2x2' },\n  { id: '444', name: '4x4x4 Cube', shortName: '4x4' },\n  { id: '555', name: '5x5x5 Cube', shortName: '5x5' },\n  { id: '666', name: '6x6x6 Cube', shortName: '6x6' },\n  { id: '777', name: '7x7x7 Cube', shortName: '7x7' },\n  { id: '333bf', name: '3x3x3 Blindfolded', shortName: '3BLD' },\n  { id: '333fm', name: '3x3x3 Fewest Moves', shortName: 'FMC' },\n  { id: '333oh', name: '3x3x3 One-Handed', shortName: '3OH' },\n  { id: '333ft', name: '3x3x3 With Feet', shortName: '3WF' },\n  { id: 'minx', name: 'Megaminx', shortName: 'Minx' },\n  { id: 'pyram', name: 'Pyraminx', shortName: 'Pyra' },\n  { id: 'clock', name: 'Clock', shortName: 'Clock' },\n  { id: 'skewb', name: 'Skewb', shortName: 'Skewb' },\n  { id: 'sq1', name: 'Square-1', shortName: 'Sq1' },\n  { id: '444bf', name: '4x4x4 Blindfolded', shortName: '4BLD' },\n  { id: '555bf', name: '5x5x5 Blindfolded', shortName: '5BLD' },\n  { id: '333mbf', name: '3x3x3 Multi-Blind', shortName: 'MBLD' },\n];\n\nexport const eventNameById = eventId => propertyById('name', eventId);\n\nexport const shortEventNameById = eventId => propertyById('shortName', eventId);\n\nconst propertyById = (property, eventId) =>\n  events.find(event => event.id === eventId)[property];\n\nexport const sortWcifEvents = wcifEvents =>\n  sortBy(wcifEvents, wcifEvent =>\n    events.findIndex(event => event.id === wcifEvent.id)\n  );\n","import {\n  mapIn,\n  updateIn,\n  setIn,\n  flatMap,\n  zip,\n  scaleToOne,\n  shortTime,\n  isPresentDeep,\n} from './utils';\nimport { getExtensionData, setExtensionData } from './wcif-extensions';\nimport {\n  suggestedGroupCount,\n  suggestedScramblerCount,\n  suggestedRunnerCount,\n} from './formulas';\nimport { eventNameById } from './events';\n\nexport const parseActivityCode = activityCode => {\n  const [, e, r, g, a] = activityCode.match(\n    /(\\w+)(?:-r(\\d+))?(?:-g(\\d+))?(?:-a(\\d+))?/\n  );\n  return {\n    eventId: e,\n    roundNumber: r && parseInt(r, 10),\n    groupNumber: g && parseInt(g, 10),\n    attemptNumber: a && parseInt(a, 10),\n  };\n};\n\nexport const activityCodeToName = activityCode => {\n  const {\n    eventId,\n    roundNumber,\n    groupNumber,\n    attemptNumber,\n  } = parseActivityCode(activityCode);\n  return [\n    eventId && eventNameById(eventId),\n    roundNumber && `Round ${roundNumber}`,\n    groupNumber && `Group ${groupNumber}`,\n    attemptNumber && `Attempt ${attemptNumber}`,\n  ]\n    .filter(x => x)\n    .join(', ');\n};\n\nexport const hasDistributedAttempts = activityCode =>\n  ['333fm', '333mbf'].includes(parseActivityCode(activityCode).eventId);\n\nexport const activityDuration = ({ startTime, endTime }) =>\n  new Date(endTime) - new Date(startTime);\n\nexport const activityDurationString = (\n  { startTime, endTime },\n  timezone = 'UTC'\n) => `${shortTime(startTime, timezone)} - ${shortTime(endTime, timezone)}`;\n\nexport const activitiesOverlap = (first, second) =>\n  new Date(first.startTime) < new Date(second.endTime) &&\n  new Date(second.startTime) < new Date(first.endTime);\n\nexport const activitiesIntersection = (first, second) => {\n  if (!activitiesOverlap(first, second)) return 0;\n  const [, middleStart, middleEnd] = [\n    first.startTime,\n    first.endTime,\n    second.startTime,\n    second.endTime,\n  ].sort();\n  /* Time distance between the two middle points in time. */\n  return new Date(middleEnd) - new Date(middleStart);\n};\n\nexport const rooms = wcif =>\n  flatMap(wcif.schedule.venues, venue => venue.rooms);\n\nexport const roomByActivity = (wcif, activityId) =>\n  rooms(wcif).find(room => room.activities.some(({ id }) => id === activityId));\n\nexport const stationsByActivity = (wcif, activityId) =>\n  getExtensionData('RoomConfig', roomByActivity(wcif, activityId)).stations;\n\nconst allActivities = wcif => {\n  const allChildActivities = ({ childActivities }) =>\n    childActivities.length > 0\n      ? [...childActivities, ...flatMap(childActivities, allChildActivities)]\n      : childActivities;\n  const activities = flatMap(rooms(wcif), room => room.activities);\n  return [...activities, ...flatMap(activities, allChildActivities)];\n};\n\nexport const maxActivityId = wcif =>\n  Math.max(...allActivities(wcif).map(activity => activity.id));\n\n/* Assigning tasks invokes activityById enormous number of times.\n   But during that process activities (schedule) don't change.\n   Caching is gives an invaluable speed boost in this case. */\nconst activitiesByIdCachedBySchedule = new Map();\n\nexport const activityById = (wcif, activityId) => {\n  if (activitiesByIdCachedBySchedule.has(wcif.schedule)) {\n    return activitiesByIdCachedBySchedule.get(wcif.schedule).get(activityId);\n  } else {\n    const activities = allActivities(wcif);\n    const activitiesById = new Map(\n      activities.map(activity => [activity.id, activity])\n    );\n    activitiesByIdCachedBySchedule.set(wcif.schedule, activitiesById);\n    return activitiesById.get(activityId);\n  }\n};\n\nexport const updateActivity = (wcif, updatedActivity) =>\n  mapIn(wcif, ['schedule', 'venues'], venue =>\n    mapIn(venue, ['rooms'], room =>\n      mapIn(room, ['activities'], activity =>\n        activity.id === updatedActivity.id ? updatedActivity : activity\n      )\n    )\n  );\n\nexport const populateRoundActivitiesConfig = (\n  wcif,\n  expectedCompetitorsByRound,\n  defaults\n) => {\n  const activitiesWithConfig = flatMap(wcif.events, event => {\n    return flatMap(event.rounds, round => {\n      const { roundNumber } = parseActivityCode(round.id);\n      const expectedRoundCompetitors =\n        expectedCompetitorsByRound[round.id].length;\n      const activities = roundActivities(wcif, round.id).filter(\n        shouldHaveGroups\n      );\n      const alreadyHaveConfig = activities.every(activity =>\n        getExtensionData('ActivityConfig', activity)\n      );\n      if (alreadyHaveConfig) return activities;\n      const capacities = scaleToOne(\n        activities.map(\n          activity =>\n            stationsByActivity(wcif, activity.id) * activityDuration(activity)\n        )\n      );\n      return zip(activities, capacities).map(([activity, capacity]) => {\n        const stations = stationsByActivity(wcif, activity.id);\n        const competitors = Math.round(capacity * expectedRoundCompetitors);\n        const groups = suggestedGroupCount(competitors, stations, roundNumber);\n        const scramblers = defaults.assignScramblers\n          ? suggestedScramblerCount(competitors / groups, stations)\n          : 0;\n        const runners = defaults.assignRunners\n          ? suggestedRunnerCount(competitors / groups, stations)\n          : 0;\n        const assignJudges = stations > 0 && defaults.assignJudges;\n        return setExtensionData('ActivityConfig', activity, {\n          capacity,\n          groups,\n          scramblers,\n          runners,\n          assignJudges,\n        });\n      });\n    });\n  });\n  return activitiesWithConfig.reduce(updateActivity, wcif);\n};\n\nexport const shouldHaveGroups = activity => {\n  const {\n    eventId,\n    roundNumber,\n    groupNumber,\n    attemptNumber,\n  } = parseActivityCode(activity.activityCode);\n  return !!(eventId && roundNumber && !groupNumber && !attemptNumber);\n};\n\nexport const anyActivityConfig = wcif =>\n  rooms(wcif).some(room =>\n    room.activities.some(activity =>\n      getExtensionData('ActivityConfig', activity)\n    )\n  );\n\nexport const activitiesWithUnpopulatedConfig = wcif =>\n  flatMap(rooms(wcif), room =>\n    room.activities\n      .filter(shouldHaveGroups)\n      .filter(activity => !getExtensionData('ActivityConfig', activity))\n  );\n\nexport const activitiesConfigComplete = wcif =>\n  rooms(wcif).every(room =>\n    room.activities\n      .filter(shouldHaveGroups)\n      .map(activity => getExtensionData('ActivityConfig', activity))\n      .every(isPresentDeep)\n  );\n\nexport const roomsConfigComplete = wcif =>\n  rooms(wcif)\n    .map(room => getExtensionData('RoomConfig', room))\n    .every(isPresentDeep);\n\nexport const roundActivities = (wcif, roundId) =>\n  flatMap(rooms(wcif), room =>\n    room.activities.filter(({ activityCode }) =>\n      activityCode.startsWith(roundId)\n    )\n  );\n\nexport const groupActivitiesByRound = (wcif, roundId) =>\n  flatMap(roundActivities(wcif, roundId), activity =>\n    hasDistributedAttempts(roundId) ? [activity] : activity.childActivities\n  );\n\nexport const roomsWithTimezoneAndGroups = (wcif, roundId) =>\n  flatMap(wcif.schedule.venues, venue =>\n    venue.rooms.map(room => [\n      room,\n      venue.timezone,\n      flatMap(\n        room.activities.filter(activity => activity.activityCode === roundId),\n        activity => activity.childActivities\n      ),\n    ])\n  );\n\nexport const activityAssigned = (wcif, activityId) =>\n  wcif.persons.some(person =>\n    person.assignments.some(assignment => assignment.activityId === activityId)\n  );\n\nexport const groupActivitiesAssigned = (wcif, roundId) =>\n  groupActivitiesByRound(wcif, roundId).some(activity =>\n    activityAssigned(wcif, activity.id)\n  );\n\nexport const roundsWithoutResults = wcif =>\n  flatMap(wcif.events, event => event.rounds).filter(\n    round =>\n      round.results.length === 0 ||\n      round.results.every(result => result.attempts.length === 0)\n  );\n\n/* Round is missing results if it has all results empty\n   or it's the first round and has no results at all.\n   In other words no one's competed in such round, but we know who should compete in it. */\nconst roundsMissingResults = wcif =>\n  wcif.events\n    .map(event =>\n      event.rounds.find(round => {\n        const { roundNumber } = parseActivityCode(round.id);\n        return (\n          (round.results.length === 0 && roundNumber === 1) ||\n          (round.results.length > 0 &&\n            round.results.every(result => result.attempts.length === 0))\n        );\n      })\n    )\n    .filter(round => round);\n\nexport const roundsMissingAssignments = wcif =>\n  roundsMissingResults(wcif).filter(\n    round => !groupActivitiesAssigned(wcif, round.id)\n  );\n\nexport const roundsMissingScorecards = wcif =>\n  roundsMissingResults(wcif)\n    .filter(round => groupActivitiesAssigned(wcif, round.id))\n    .filter(round => parseActivityCode(round.id).eventId !== '333fm');\n\nexport const allGroupsCreated = wcif =>\n  wcif.events.every(event =>\n    event.rounds.every(\n      round => groupActivitiesByRound(wcif, round.id).length > 0\n    )\n  );\n\nexport const anyCompetitorAssignment = wcif =>\n  wcif.persons.some(person =>\n    person.assignments.some(\n      assignment => assignment.assignmentCode === 'competitor'\n    )\n  );\n\nexport const anyGroupAssignedOrCreated = wcif =>\n  wcif.events.some(event =>\n    event.rounds.some(round =>\n      hasDistributedAttempts(event.id)\n        ? groupActivitiesAssigned(wcif, round.id)\n        : groupActivitiesByRound(wcif, round.id).length > 0\n    )\n  );\n\nexport const anyResults = wcif =>\n  wcif.events.some(event =>\n    event.rounds.some(round => round.results.length > 0)\n  );\n\n/* Clears groups and assignments only for rounds without results. */\nexport const clearGroupsAndAssignments = wcif => {\n  const clearableRounds = roundsWithoutResults(wcif);\n  const clearableRoundIds = clearableRounds.map(({ id }) => id);\n  const clearableActivities = flatMap(clearableRounds, round =>\n    groupActivitiesByRound(wcif, round.id)\n  );\n  const clearableActivityIds = clearableActivities.map(({ id }) => id);\n\n  const persons = wcif.persons.map(person =>\n    updateIn(person, ['assignments'], assignments =>\n      assignments\n        .filter(({ activityId }) => !clearableActivityIds.includes(activityId))\n        .filter(\n          ({ assignmentCode }) =>\n            !assignmentCode.startsWith('staff-') &&\n            assignmentCode !== 'competitor'\n        )\n    )\n  );\n  const schedule = mapIn(wcif.schedule, ['venues'], venue =>\n    mapIn(venue, ['rooms'], room =>\n      mapIn(room, ['activities'], activity =>\n        clearableRoundIds.includes(activity.activityCode)\n          ? setIn(activity, ['childActivities'], [])\n          : activity\n      )\n    )\n  );\n  return { ...wcif, persons, schedule };\n};\n","export const suggestedGroupCount = (competitors, stations, roundNumber) => {\n  if (stations === 0) return 1;\n  const preferredGroupSize = stations * 1.7;\n  /* We calculate the number of perfectly-sized groups, and round it up starting from x.1,\n     this way we don't end up with much more than the perfect amount of people in a single group.\n     Having more small groups is preferred over having fewer big groups. */\n  const calculatedGroupCount = Math.round(\n    competitors / preferredGroupSize + 0.4\n  );\n  /* Suggest at least 2 groups for first rounds, so that there are people to scramble. */\n  return Math.max(calculatedGroupCount, roundNumber === 1 ? 2 : 1);\n};\n\n/* Take min{groupCompetitors, stations} (i.e. stations in use) and suggest one scrambler for each 5 of them. */\nexport const suggestedScramblerCount = (groupCompetitors, stations) =>\n  Math.floor(1 + (Math.min(groupCompetitors, stations) - 1) / 5);\n\n/* Take min{groupCompetitors, stations} (i.e. stations in use) and suggest one runner for each 8 of them. */\nexport const suggestedRunnerCount = (groupCompetitors, stations) =>\n  Math.floor(1 + (Math.min(groupCompetitors, stations) - 1) / 8);\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Paper from '@material-ui/core/Paper';\nimport PeopleIcon from '@material-ui/icons/People';\nimport PermContactCalendarIcon from '@material-ui/icons/PermContactCalendar';\nimport PrintIcon from '@material-ui/icons/Print';\nimport SettingsIcon from '@material-ui/icons/Settings';\n\nimport {\n  roomsConfigComplete,\n  activitiesConfigComplete,\n  anyCompetitorAssignment,\n} from '../../../logic/activities';\n\nconst menuItems = [\n  {\n    path: '/roles',\n    text: 'Edit roles',\n    icon: PermContactCalendarIcon,\n    enabled: wcif => true,\n  },\n  {\n    path: '/config',\n    text: 'Configure',\n    icon: SettingsIcon,\n    enabled: wcif => true,\n  },\n  {\n    path: '/groups',\n    text: 'Manage groups',\n    icon: PeopleIcon,\n    enabled: wcif =>\n      roomsConfigComplete(wcif) && activitiesConfigComplete(wcif),\n  },\n  {\n    path: '/printing',\n    text: 'Print documents',\n    icon: PrintIcon,\n    enabled: wcif => anyCompetitorAssignment(wcif),\n  },\n];\n\nconst CompetitionMenu = ({ wcif, baseUrl }) => (\n  <Paper>\n    <List>\n      {menuItems.map(menuItem => (\n        <ListItem\n          key={menuItem.path}\n          button\n          component={Link}\n          to={`${baseUrl}${menuItem.path}`}\n          disabled={!menuItem.enabled(wcif)}\n        >\n          <ListItemIcon>\n            <menuItem.icon />\n          </ListItemIcon>\n          <ListItemText primary={menuItem.text} />\n        </ListItem>\n      ))}\n    </List>\n  </Paper>\n);\n\nexport default CompetitionMenu;\n","import React from 'react';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\n\nconst useStyles = makeStyles(theme => ({\n  roomDot: {\n    display: 'inline-block',\n    width: 10,\n    height: 10,\n    marginRight: 5,\n    borderRadius: '100%',\n  },\n}));\n\nconst RoomName = ({ room }) => {\n  const classes = useStyles();\n  return (\n    <Typography variant=\"subtitle2\">\n      <span\n        className={classes.roomDot}\n        style={{ backgroundColor: room.color }}\n      />\n      <span>{room.name}</span>\n    </Typography>\n  );\n};\n\nexport default RoomName;\n","import React from 'react';\nimport TextField from '@material-ui/core/TextField';\n\nconst PositiveIntegerInput = React.memo(({ value, onChange, ...props }) => {\n  /* Prevent from entering characters like minus, plus and dot.\n     These don't trigger the change event for numeric input. */\n  const handleKeyPress = event => {\n    if (event.key.match(/\\D/)) event.preventDefault();\n  };\n\n  const handleTextFieldChange = event => {\n    const { value } = event.target;\n    const newValue = value.length > 0 ? parseInt(value, 10) : null;\n    if (newValue === null || (!Number.isNaN(newValue) && newValue >= 1)) {\n      onChange(event, newValue);\n    }\n  };\n\n  return (\n    <TextField\n      {...props}\n      type=\"number\"\n      value={value === null ? '' : value}\n      onKeyPress={handleKeyPress}\n      onChange={handleTextFieldChange}\n    />\n  );\n});\n\nexport default PositiveIntegerInput;\n","import React, { useEffect, useRef } from 'react';\nimport Checkbox from '@material-ui/core/Checkbox';\n\nimport PositiveIntegerInput from '../PositiveIntegerInput/PositiveIntegerInput';\n\nconst ZeroablePositiveIntegerInput = React.memo(\n  ({ value, disabled, ...props }) => {\n    const inputRef = useRef(null);\n    const shouldFocusRef = useRef(false);\n\n    const handleCheckboxChange = event => {\n      const { checked } = event.target;\n      props.onChange(event, checked ? null : 0);\n      if (checked) {\n        shouldFocusRef.current = true;\n      }\n    };\n\n    useEffect(() => {\n      if (value === null && shouldFocusRef.current) {\n        inputRef.current.focus();\n        shouldFocusRef.current = false;\n      }\n    }, [value]);\n\n    return (\n      <div>\n        <PositiveIntegerInput\n          {...props}\n          value={value}\n          disabled={value === 0 || disabled}\n          inputRef={inputRef}\n        />\n        <Checkbox\n          name={props.name}\n          checked={value !== 0}\n          onChange={handleCheckboxChange}\n          disabled={disabled}\n        />\n      </div>\n    );\n  }\n);\n\nexport default ZeroablePositiveIntegerInput;\n","import React from 'react';\n\nimport RoomName from '../../../common/RoomName/RoomName';\nimport ZeroablePositiveIntegerInput from '../../../common/ZeroablePositiveIntegerInput/ZeroablePositiveIntegerInput';\nimport { setIn } from '../../../../logic/utils';\nimport {\n  getExtensionData,\n  setExtensionData,\n} from '../../../../logic/wcif-extensions';\n\nconst RoomConfig = ({ room, onChange, disabled }) => {\n  const handleInputChange = (event, value) => {\n    onChange(\n      setExtensionData(\n        'RoomConfig',\n        room,\n        setIn(getExtensionData('RoomConfig', room), [event.target.name], value)\n      )\n    );\n  };\n\n  const { stations } = getExtensionData('RoomConfig', room);\n\n  return (\n    <div>\n      <RoomName room={room} />\n      <ZeroablePositiveIntegerInput\n        label=\"Timing stations\"\n        value={stations}\n        name=\"stations\"\n        onChange={handleInputChange}\n        disabled={disabled}\n      />\n    </div>\n  );\n};\n\nexport default RoomConfig;\n","import React from 'react';\nimport Grid from '@material-ui/core/Grid';\nimport Paper from '@material-ui/core/Paper';\n\nimport RoomConfig from '../RoomConfig/RoomConfig';\nimport { mapIn } from '../../../../logic/utils';\nimport { anyActivityConfig, rooms } from '../../../../logic/activities';\n\nconst RoomsConfig = ({ wcif, onWcifChange }) => {\n  const handleRoomChange = updatedRoom => {\n    onWcifChange(\n      mapIn(wcif, ['schedule', 'venues'], venue =>\n        mapIn(venue, ['rooms'], room =>\n          room.id === updatedRoom.id ? updatedRoom : room\n        )\n      )\n    );\n  };\n\n  /* Disable rooms configuration once activities config has been populated. */\n  const disabled = anyActivityConfig(wcif);\n\n  return (\n    <Paper style={{ padding: 16 }}>\n      <Grid container spacing={2}>\n        {rooms(wcif).map(room => (\n          <Grid item key={room.id}>\n            <RoomConfig\n              room={room}\n              onChange={handleRoomChange}\n              disabled={disabled}\n            />\n          </Grid>\n        ))}\n      </Grid>\n    </Paper>\n  );\n};\n\nexport default RoomsConfig;\n","import React from 'react';\n\nconst CubingIcon = ({ eventId, ...props }) => (\n  <span\n    style={{ fontSize: 24 }}\n    className={`cubing-icon event-${eventId}`}\n    {...props}\n  />\n);\n\nexport default CubingIcon;\n","import React from 'react';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport IconButton from '@material-ui/core/IconButton';\n\nimport CubingIcon from '../CubingIcon/CubingIcon';\nimport { eventNameById } from '../../../logic/events';\n\nconst EventSelect = ({ events, selected, onChange }) => {\n  return (\n    <div>\n      {events.map(event => (\n        <Tooltip key={event.id} title={eventNameById(event.id)} placement=\"top\">\n          <IconButton onClick={() => onChange(event.id)}>\n            <CubingIcon\n              eventId={event.id}\n              style={{ opacity: event.id === selected ? 1 : 0.3 }}\n            />\n          </IconButton>\n        </Tooltip>\n      ))}\n    </div>\n  );\n};\n\nexport default EventSelect;\n","import React from 'react';\nimport ExpansionPanel from '@material-ui/core/ExpansionPanel';\nimport ExpansionPanelDetails from '@material-ui/core/ExpansionPanelDetails';\nimport ExpansionPanelSummary from '@material-ui/core/ExpansionPanelSummary';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport Typography from '@material-ui/core/Typography';\n\nimport { activityCodeToName } from '../../../../logic/activities';\n\nconst RoundPanel = ({ expanded, onChange, roundId, render }) => {\n  const scrollToElement = node => {\n    /* Node is the panel content, so the panel is its parent. */\n    window.scrollTo({\n      top: node.parentNode.getBoundingClientRect().top - 8,\n      behavior: 'smooth',\n    });\n  };\n\n  return (\n    <ExpansionPanel\n      onChange={(event, expanded) => onChange(expanded ? roundId : null)}\n      expanded={expanded}\n      TransitionProps={{ onEntered: scrollToElement }}\n    >\n      <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n        <Typography variant=\"subtitle1\">\n          {activityCodeToName(roundId)}\n        </Typography>\n      </ExpansionPanelSummary>\n      <ExpansionPanelDetails>\n        {expanded && render(roundId)}\n      </ExpansionPanelDetails>\n    </ExpansionPanel>\n  );\n};\n\nexport default RoundPanel;\n","import React, { useState } from 'react';\nimport Grid from '@material-ui/core/Grid';\n\nimport EventSelect from '../../common/EventSelect/EventSelect';\nimport RoundPanel from './RoundPanel/RoundPanel';\n\nconst RoundsNavigation = ({ events, render }) => {\n  const [selectedEventId, setSelectedEventId] = useState(events[0].id);\n  const [expandedRoundId, setExpandedRoundId] = useState(null);\n\n  const selectedEvent = events.find(event => event.id === selectedEventId);\n\n  return (\n    <Grid container spacing={1}>\n      <Grid item xs={12}>\n        <EventSelect\n          selected={selectedEventId}\n          events={events}\n          onChange={setSelectedEventId}\n        />\n      </Grid>\n      <Grid item xs={12}>\n        {selectedEvent.rounds.map(round => (\n          <RoundPanel\n            key={round.id}\n            expanded={round.id === expandedRoundId}\n            roundId={round.id}\n            render={render}\n            onChange={setExpandedRoundId}\n          />\n        ))}\n      </Grid>\n    </Grid>\n  );\n};\n\nexport default RoundsNavigation;\n","import React from 'react';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport Grid from '@material-ui/core/Grid';\n\nimport PositiveIntegerInput from '../../../common/PositiveIntegerInput/PositiveIntegerInput';\nimport ZeroablePositiveIntegerInput from '../../../common/ZeroablePositiveIntegerInput/ZeroablePositiveIntegerInput';\nimport { setIn, pluralize } from '../../../../logic/utils';\nimport {\n  getExtensionData,\n  setExtensionData,\n} from '../../../../logic/wcif-extensions';\nimport { activityAssigned } from '../../../../logic/activities';\n\nconst RoundActivityConfig = React.memo(\n  ({ activity, room, wcif, onChange, expectedCompetitors }) => {\n    const {\n      groups,\n      scramblers,\n      runners,\n      assignJudges,\n      capacity,\n    } = getExtensionData('ActivityConfig', activity);\n    const stations = getExtensionData('RoomConfig', room).stations;\n    const competitors = Math.round(expectedCompetitors.length * capacity);\n    const groupSize = Math.round(competitors / groups);\n\n    const groupsHelperText = groups\n      ? pluralize(groupSize, 'person', 'people') + ' in group'\n      : ' ';\n    const scramblersHelperText = scramblers\n      ? pluralize(Math.round(groupSize / scramblers), 'cube') + ' per scrambler'\n      : ' ';\n    const runnersHelperText = runners\n      ? pluralize(Math.round(stations / runners), 'station') + ' per runner'\n      : ' ';\n\n    const groupsCreated = activity.childActivities.length > 0;\n    const groupsAssigned = activity.childActivities.some(({ id }) =>\n      activityAssigned(wcif, id)\n    );\n\n    const handlePropertyChange = (property, value) => {\n      onChange(\n        setExtensionData(\n          'ActivityConfig',\n          activity,\n          setIn(getExtensionData('ActivityConfig', activity), [property], value)\n        )\n      );\n    };\n\n    const handleInputChange = (event, value) => {\n      handlePropertyChange(event.target.name, value);\n    };\n\n    const handleCheckboxChange = event => {\n      const { name, checked } = event.target;\n      handlePropertyChange(name, checked);\n    };\n\n    return (\n      <Grid container direction=\"column\">\n        <Grid item>\n          <PositiveIntegerInput\n            label=\"Groups\"\n            value={groups}\n            name=\"groups\"\n            helperText={groupsHelperText}\n            onChange={handleInputChange}\n            margin=\"dense\"\n            disabled={groupsCreated || groupsAssigned}\n          />\n        </Grid>\n        <Grid item>\n          <ZeroablePositiveIntegerInput\n            label=\"Scramblers\"\n            value={scramblers}\n            name=\"scramblers\"\n            helperText={scramblersHelperText}\n            onChange={handleInputChange}\n            margin=\"dense\"\n            disabled={groupsAssigned}\n          />\n        </Grid>\n        <Grid item>\n          <ZeroablePositiveIntegerInput\n            label=\"Runners\"\n            value={runners}\n            name=\"runners\"\n            helperText={runnersHelperText}\n            onChange={handleInputChange}\n            margin=\"dense\"\n            disabled={groupsAssigned}\n          />\n        </Grid>\n        <Grid item>\n          <FormControlLabel\n            control={\n              <Checkbox\n                checked={assignJudges}\n                name=\"assignJudges\"\n                onChange={handleCheckboxChange}\n                disabled={stations === 0 || groupsAssigned}\n              />\n            }\n            label=\"Assign judges\"\n          />\n        </Grid>\n      </Grid>\n    );\n  }\n);\n\nexport default RoundActivityConfig;\n","import React from 'react';\nimport Grid from '@material-ui/core/Grid';\n\nimport RoundActivityConfig from '../RoundActivityConfig/RoundActivityConfig';\nimport RoomName from '../../../common/RoomName/RoomName';\nimport { flatMap } from '../../../../logic/utils';\nimport { updateActivity, rooms } from '../../../../logic/activities';\n\nconst RoundConfig = React.memo(\n  ({ roundId, wcif, onWcifChange, expectedCompetitorsByRound }) => {\n    const activitiesWithRooms = flatMap(rooms(wcif), room =>\n      room.activities\n        .filter(activity => activity.activityCode === roundId)\n        .map(activity => [activity, room])\n    );\n\n    return (\n      <Grid container spacing={1}>\n        {activitiesWithRooms.map(([activity, room]) => (\n          <Grid item xs key={activity.id}>\n            <RoomName room={room} />\n            <RoundActivityConfig\n              wcif={wcif}\n              activity={activity}\n              room={room}\n              onChange={activity =>\n                onWcifChange(updateActivity(wcif, activity))\n              }\n              expectedCompetitors={expectedCompetitorsByRound[roundId]}\n            />\n          </Grid>\n        ))}\n      </Grid>\n    );\n  }\n);\n\nexport default RoundConfig;\n","import React, { useState, useCallback } from 'react';\nimport Button from '@material-ui/core/Button';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport Grid from '@material-ui/core/Grid';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport Paper from '@material-ui/core/Paper';\nimport Typography from '@material-ui/core/Typography';\n\nimport RoundsNavigation from '../../../common/RoundsNavigation/RoundsNavigation';\nimport RoundConfig from '../RoundConfig/RoundConfig';\nimport {\n  populateRoundActivitiesConfig,\n  anyActivityConfig,\n  hasDistributedAttempts,\n  activitiesWithUnpopulatedConfig,\n  activityCodeToName,\n} from '../../../../logic/activities';\nimport { uniq } from '../../../../logic/utils';\n\nconst RoundsConfig = ({ wcif, onWcifChange, expectedCompetitorsByRound }) => {\n  const [options, setOptions] = useState({\n    assignScramblers: true,\n    assignRunners: true,\n    assignJudges: true,\n  });\n\n  const handleNextClick = () => {\n    onWcifChange(\n      populateRoundActivitiesConfig(wcif, expectedCompetitorsByRound, options)\n    );\n  };\n\n  const events = wcif.events.filter(event => !hasDistributedAttempts(event.id));\n\n  const activityCodesMissingConfig = uniq(\n    activitiesWithUnpopulatedConfig(wcif).map(activity => activity.activityCode)\n  );\n\n  const renderRound = useCallback(\n    roundId => (\n      <RoundConfig\n        roundId={roundId}\n        expectedCompetitorsByRound={expectedCompetitorsByRound}\n        wcif={wcif}\n        onWcifChange={onWcifChange}\n      />\n    ),\n    [wcif, onWcifChange, expectedCompetitorsByRound]\n  );\n\n  return activityCodesMissingConfig.length === 0 ? (\n    <RoundsNavigation events={events} render={renderRound} />\n  ) : (\n    <Paper style={{ padding: 16 }}>\n      <Typography variant=\"h5\">\n        {anyActivityConfig(wcif)\n          ? `Generate missing configuration for\n          ${activityCodesMissingConfig.map(activityCodeToName).join(', ')}`\n          : `Generate initial configuration`}\n      </Typography>\n      <Grid container direction=\"column\">\n        <Grid item style={{ margin: '0.5em 0' }}>\n          <Typography variant=\"body1\">\n            Which of the following roles would you like to assign?\n          </Typography>\n        </Grid>\n        {['Scramblers', 'Runners', 'Judges'].map(roleLabel => (\n          <Grid item key={roleLabel}>\n            <FormControlLabel\n              control={\n                <Checkbox\n                  checked={options[`assign${roleLabel}`]}\n                  name={`assign${roleLabel}`}\n                  onChange={event => {\n                    const { checked, name } = event.target;\n                    setOptions({ ...options, [name]: checked });\n                  }}\n                />\n              }\n              label={roleLabel}\n            />\n          </Grid>\n        ))}\n      </Grid>\n      <Button onClick={handleNextClick}>Next</Button>\n    </Paper>\n  );\n};\n\nexport default RoundsConfig;\n","import React from 'react';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport FormControl from '@material-ui/core/FormControl';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport FormHelperText from '@material-ui/core/FormHelperText';\nimport Grid from '@material-ui/core/Grid';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Paper from '@material-ui/core/Paper';\nimport Select from '@material-ui/core/Select';\nimport TextField from '@material-ui/core/TextField';\nimport Typography from '@material-ui/core/Typography';\n\nimport {\n  getExtensionData,\n  setExtensionData,\n} from '../../../../logic/wcif-extensions';\nimport { setIn } from '../../../../logic/utils';\n\nconst competitorsSortingRules = [\n  {\n    id: 'ranks',\n    name: 'Official rankings',\n    description: 'Sort competitors by their official rankings.',\n  },\n  {\n    id: 'balanced',\n    name: 'Balanced',\n    description:\n      'Sort competitors in 3x3x3 (any variation), 2x2x2, Pyraminx and Skewb by their official rankings. For other events put best people in different groups, so that there are good scramblers for each group.',\n  },\n  {\n    id: 'symmetric',\n    name: 'Symmetric',\n    description:\n      'Put best people in different groups, so that there are good scramblers for each group.',\n  },\n  {\n    id: 'name-optimised',\n    name: 'Name-optimised',\n    description:\n      'Sort competitors by their official rankings, but also minimize the number of people with the same name in each group. Use it when many competitors have the same name.',\n  },\n];\n\nconst GeneralConfig = ({ wcif, onWcifChange }) => {\n  const handlePropertyChange = (property, value) => {\n    onWcifChange(\n      setExtensionData(\n        'CompetitionConfig',\n        wcif,\n        setIn(getExtensionData('CompetitionConfig', wcif), [property], value)\n      )\n    );\n  };\n\n  const handleCheckboxChange = event => {\n    const { name, checked } = event.target;\n    handlePropertyChange(name, checked);\n  };\n\n  const handleTextFieldChange = event => {\n    const { name, value } = event.target;\n    handlePropertyChange(name, value);\n  };\n\n  const {\n    competitorsSortingRule,\n    noTasksForNewcomers,\n    tasksForOwnEventsOnly,\n    localNamesFirst,\n    scorecardsBackgroundUrl,\n  } = getExtensionData('CompetitionConfig', wcif);\n\n  return (\n    <Paper style={{ padding: 16 }}>\n      <Grid container direction=\"column\" spacing={1}>\n        <Grid item>\n          <Typography variant=\"h5\">Assignments</Typography>\n          <FormControl fullWidth>\n            <InputLabel htmlFor=\"competitors-sorting-rule\">\n              Competitors sorting rule\n            </InputLabel>\n            <Select\n              value={competitorsSortingRule}\n              onChange={handleTextFieldChange}\n              inputProps={{\n                name: 'competitorsSortingRule',\n                id: 'competitors-sorting-rule',\n              }}\n            >\n              {competitorsSortingRules.map(({ id, name }) => (\n                <MenuItem value={id} key={id}>\n                  {name}\n                </MenuItem>\n              ))}\n            </Select>\n            <FormHelperText>\n              {competitorsSortingRules.find(\n                ({ id }) => id === competitorsSortingRule\n              ).description + ' Note: this applies to first rounds only.'}\n            </FormHelperText>\n          </FormControl>\n          <Grid container direction=\"column\">\n            <Grid item>\n              <FormControlLabel\n                control={\n                  <Checkbox\n                    name=\"noTasksForNewcomers\"\n                    checked={noTasksForNewcomers}\n                    onChange={handleCheckboxChange}\n                  />\n                }\n                label=\"Don't assign tasks to newcomers\"\n              />\n            </Grid>\n            <Grid item>\n              <FormControlLabel\n                control={\n                  <Checkbox\n                    name=\"tasksForOwnEventsOnly\"\n                    checked={tasksForOwnEventsOnly}\n                    onChange={handleCheckboxChange}\n                  />\n                }\n                label=\"Assign tasks to competitors only in events they registered for\"\n              />\n            </Grid>\n          </Grid>\n        </Grid>\n        <Grid item>\n          <Typography variant=\"h5\">Printing</Typography>\n          <FormControlLabel\n            control={\n              <Checkbox\n                name=\"localNamesFirst\"\n                checked={localNamesFirst}\n                onChange={handleCheckboxChange}\n              />\n            }\n            label=\"Swap latin names with local ones\"\n          />\n          <TextField\n            label=\"Scorecards background image URL\"\n            name=\"scorecardsBackgroundUrl\"\n            value={scorecardsBackgroundUrl}\n            onChange={handleTextFieldChange}\n            fullWidth\n          />\n        </Grid>\n      </Grid>\n    </Paper>\n  );\n};\n\nexport default GeneralConfig;\n","const searchParams = new URLSearchParams(window.location.search);\nexport const PRODUCTION =\n  process.env.NODE_ENV === 'production' && !searchParams.has('staging');\n\nexport const WCA_ORIGIN = PRODUCTION\n  ? 'https://www.worldcubeassociation.org'\n  : 'https://staging.worldcubeassociation.org';\n\nexport const WCA_OAUTH_CLIENT_ID = PRODUCTION\n  ? 'eE1SyRia-Z6HTVr3TVEzOksUekySwGO81mKSWrRypNA'\n  : 'example-application-id';\n","import { WCA_ORIGIN, WCA_OAUTH_CLIENT_ID } from './wca-env';\nimport history from './history';\n\n/* Use separate set of keys for each OAuth client (e.g. for WCA production and staging). */\nconst localStorageKey = key => `GroupifierNext.${WCA_OAUTH_CLIENT_ID}.${key}`;\n\n/**\n * Checks the URL hash for presence of OAuth access token\n * and saves it in the local storage if it's found.\n * Should be called on application initialization (before any kind of router takes over the location).\n */\nexport const initializeAuth = () => {\n  const hash = window.location.hash.replace(/^#/, '');\n  const hashParams = new URLSearchParams(hash);\n  if (hashParams.has('access_token')) {\n    localStorage.setItem(\n      localStorageKey('accessToken'),\n      hashParams.get('access_token')\n    );\n  }\n  if (hashParams.has('expires_in')) {\n    /* Expire the token 15 minutes before it actually does,\n       this way it doesn't expire right after the user enters the page. */\n    const expiresInSeconds = hashParams.get('expires_in') - 15 * 60;\n    const expirationTime = new Date(\n      new Date().getTime() + expiresInSeconds * 1000\n    );\n    localStorage.setItem(\n      localStorageKey('expirationTime'),\n      expirationTime.toISOString()\n    );\n  }\n  /* If the token expired, sign the user out. */\n  const expirationTime = localStorage.getItem(\n    localStorageKey('expirationTime')\n  );\n  if (expirationTime && new Date() >= new Date(expirationTime)) {\n    signOut();\n  }\n  /* Clear the hash if there is a token. */\n  if (hashParams.has('access_token')) {\n    history.replace({ ...history.location, hash: null });\n  }\n\n  /* Check if we know what path to redirect to (after OAuth redirect). */\n  const redirectPath = localStorage.getItem(localStorageKey('redirectPath'));\n  if (redirectPath) {\n    history.replace(redirectPath);\n    localStorage.removeItem(localStorageKey('redirectPath'));\n  }\n  /* If non-signed in user tries accessing a competition path, redirect to OAuth sign in straightaway. */\n  const path = window.location.pathname;\n  if (path.startsWith('/competitions') && !isSignedIn()) {\n    localStorage.setItem(localStorageKey('redirectPath'), path);\n    signIn();\n  }\n};\n\nexport const wcaAccessToken = () =>\n  localStorage.getItem(localStorageKey('accessToken'));\n\nexport const signIn = () => {\n  const params = new URLSearchParams({\n    client_id: WCA_OAUTH_CLIENT_ID,\n    response_type: 'token',\n    redirect_uri: oauthRedirectUri(),\n    scope: 'manage_competitions',\n  });\n  window.location = `${WCA_ORIGIN}/oauth/authorize?${params.toString()}`;\n};\n\nconst oauthRedirectUri = () => {\n  const appUri = window.location.origin;\n  const searchParams = new URLSearchParams(window.location.search);\n  const stagingParam = searchParams.has('staging');\n  return stagingParam ? `${appUri}?staging=true` : appUri;\n};\n\nexport const signOut = () =>\n  localStorage.removeItem(localStorageKey('accessToken'));\n\nexport const isSignedIn = () => !!wcaAccessToken();\n","import { wcaAccessToken } from './auth';\nimport { WCA_ORIGIN } from './wca-env';\nimport { pick } from './utils';\n\nexport const getUpcomingManageableCompetitions = () => {\n  const oneWeekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000);\n  const params = new URLSearchParams({\n    managed_by_me: true,\n    start: oneWeekAgo.toISOString(),\n  });\n  return wcaApiFetch(`/competitions?${params.toString()}`);\n};\n\nexport const getWcif = competitionId =>\n  wcaApiFetch(`/competitions/${competitionId}/wcif`);\n\nconst updateWcif = (competitionId, wcif) =>\n  wcaApiFetch(`/competitions/${competitionId}/wcif`, {\n    method: 'PATCH',\n    body: JSON.stringify(wcif),\n  });\n\nexport const saveWcifChanges = (previousWcif, newWcif) => {\n  const keysDiff = Object.keys(newWcif).filter(\n    key => previousWcif[key] !== newWcif[key]\n  );\n  if (keysDiff.length === 0) return Promise.resolve();\n  return updateWcif(newWcif.id, pick(newWcif, keysDiff));\n};\n\nconst wcaApiFetch = (path, fetchOptions = {}) => {\n  const baseApiUrl = `${WCA_ORIGIN}/api/v0`;\n\n  return fetch(\n    `${baseApiUrl}${path}`,\n    Object.assign({}, fetchOptions, {\n      headers: new Headers({\n        Authorization: `Bearer ${wcaAccessToken()}`,\n        'Content-Type': 'application/json',\n      }),\n    })\n  )\n    .then(response => {\n      if (!response.ok) throw new Error(response.statusText);\n      return response;\n    })\n    .then(response => response.json());\n};\n","import React, { Fragment, useState } from 'react';\nimport { withRouter } from 'react-router-dom';\nimport Button from '@material-ui/core/Button';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Snackbar from '@material-ui/core/Snackbar';\n\nimport { saveWcifChanges } from '../../../logic/wca-api';\n\nconst SaveWcifButton = ({\n  wcif,\n  updatedWcif,\n  onWcifUpdate,\n  disabled,\n  history,\n}) => {\n  const [saving, setSaving] = useState(false);\n  const [failed, setFailed] = useState(false);\n\n  const handleSaveClick = () => {\n    setSaving(true);\n    setFailed(false);\n    saveWcifChanges(wcif, updatedWcif)\n      .then(() => {\n        onWcifUpdate(updatedWcif);\n        history.push(`/competitions/${updatedWcif.id}`);\n      })\n      .catch(() => {\n        setSaving(false);\n        setFailed(true);\n      });\n  };\n\n  return (\n    <Fragment>\n      <Snackbar\n        open={failed}\n        message=\"Failed to save data to the WCA website.\"\n        anchorOrigin={{\n          vertical: 'bottom',\n          horizontal: 'left',\n        }}\n        autoHideDuration={5000}\n        onClose={() => setFailed(false)}\n      />\n      <Button\n        variant=\"contained\"\n        color=\"primary\"\n        onClick={handleSaveClick}\n        disabled={disabled || saving}\n      >\n        <span style={saving ? { visibility: 'hidden' } : {}}>Save</span>\n        {saving && (\n          <CircularProgress size={20} style={{ position: 'absolute' }} />\n        )}\n      </Button>\n    </Fragment>\n  );\n};\n\nexport default withRouter(SaveWcifButton);\n","import { parseActivityCode } from './activities';\n\nexport const eventById = (wcif, eventId) => {\n  return wcif.events.find(event => event.id === eventId);\n};\n\nexport const personById = (wcif, personId) => {\n  return wcif.persons.find(person => person.registrantId === personId);\n};\n\nexport const roundById = (wcif, roundId) => {\n  const { eventId } = parseActivityCode(roundId);\n  return eventById(wcif, eventId).rounds.find(round => round.id === roundId);\n};\n\nexport const previousRound = (wcif, roundId) => {\n  const { eventId, roundNumber } = parseActivityCode(roundId);\n  const event = eventById(wcif, eventId);\n  return event.rounds.find(\n    ({ id }) => parseActivityCode(id).roundNumber === roundNumber - 1\n  );\n};\n","import {\n  parseActivityCode,\n  activityCodeToName,\n  activityById,\n} from './activities';\nimport { personById, roundById, previousRound } from './wcif';\nimport { sortBy, sortByArray } from './utils';\n\nexport const best = (person, eventId, type) => {\n  if (!['single', 'average'].includes(type)) {\n    throw new Error(\n      `Personal best type must be either 'single' or 'average'. Received '${type}'.`\n    );\n  }\n  const personalBest = person.personalBests.find(\n    pb => pb.eventId === eventId && pb.type === type\n  );\n  return personalBest ? personalBest.best : Infinity;\n};\n\nexport const bestAverageAndSingle = (competitor, eventId) => [\n  best(competitor, eventId, 'average'),\n  best(competitor, eventId, 'single'),\n];\n\nconst competitorsExpectedToAdvance = (\n  sortedCompetitors,\n  advancementCondition,\n  eventId\n) => {\n  switch (advancementCondition.type) {\n    case 'ranking':\n      return sortedCompetitors.slice(0, advancementCondition.level);\n    case 'percent':\n      return sortedCompetitors.slice(\n        0,\n        Math.floor(sortedCompetitors.length * advancementCondition.level * 0.01)\n      );\n    case 'attemptResult':\n      /* Assume that competitors having personal best better than the advancement condition will make it to the next round. */\n      return sortedCompetitors.filter(\n        person => best(person, eventId, 'single') < advancementCondition.level\n      );\n    default:\n      throw new Error(\n        `Unrecognised AdvancementCondition type: '${advancementCondition.type}'`\n      );\n  }\n};\n\nexport const getExpectedCompetitorsByRound = wcif =>\n  wcif.events.reduce((expectedCompetitorsByRound, event) => {\n    const [firstRound, ...nextRounds] = event.rounds;\n    expectedCompetitorsByRound[firstRound.id] = sortByArray(\n      acceptedPeopleRegisteredForEvent(wcif, event.id),\n      competitor => bestAverageAndSingle(competitor, event.id)\n    );\n    nextRounds.reduce(\n      ([round, competitors], nextRound) => {\n        const advancementCondition = round.advancementCondition;\n        if (!advancementCondition) {\n          throw new Error(\n            `Mising advancement condition for ${activityCodeToName(round.id)}.`\n          );\n        }\n        const nextRoundCompetitors = competitorsExpectedToAdvance(\n          competitors,\n          advancementCondition,\n          event.id\n        );\n        expectedCompetitorsByRound[nextRound.id] = nextRoundCompetitors;\n        return [nextRound, nextRoundCompetitors];\n      },\n      [firstRound, expectedCompetitorsByRound[firstRound.id]]\n    );\n    return expectedCompetitorsByRound;\n  }, {});\n\n/* Returns competitors for the given round sorted from worst to best. */\nexport const competitorsForRound = (wcif, roundId) => {\n  const { eventId, roundNumber } = parseActivityCode(roundId);\n  const round = roundById(wcif, roundId);\n  const competitorsInRound = round.results.map(({ personId }) =>\n    personById(wcif, personId)\n  );\n  if (roundNumber === 1) {\n    /* For first rounds, if there are no empty results to use, get whoever registered for the given event. */\n    const competitors =\n      competitorsInRound.length > 0\n        ? competitorsInRound\n        : acceptedPeopleRegisteredForEvent(wcif, eventId);\n    return sortByArray(competitors, competitor =>\n      bestAverageAndSingle(competitor, eventId).map(result => -result)\n    );\n  } else if (competitorsInRound.length > 0) {\n    const previous = previousRound(wcif, roundId);\n    return sortBy(competitorsInRound, person => {\n      const previousResult = previous.results.find(\n        result => result.personId === person.registrantId\n      );\n      return -previousResult.ranking;\n    });\n  } else {\n    return null;\n  }\n};\n\nexport const age = person => {\n  const diffMs = Date.now() - new Date(person.birthdate).getTime();\n  return Math.floor(diffMs / (1000 * 60 * 60 * 24 * 365.2425));\n};\n\nexport const staffAssignments = person =>\n  person.assignments.filter(({ assignmentCode }) =>\n    assignmentCode.startsWith('staff-')\n  );\n\nexport const staffAssignmentsForEvent = (wcif, person, eventId) =>\n  staffAssignments(person).filter(\n    ({ activityId }) =>\n      parseActivityCode(activityById(wcif, activityId).activityCode).eventId ===\n      eventId\n  );\n\nexport const acceptedPeople = wcif =>\n  wcif.persons.filter(\n    person => person.registration && person.registration.status === 'accepted'\n  );\n\nconst acceptedPeopleRegisteredForEvent = (wcif, eventId) =>\n  acceptedPeople(wcif).filter(({ registration }) =>\n    registration.eventIds.includes(eventId)\n  );\n\nexport const hasAssignment = (person, activityId, assignmentCode) =>\n  person.assignments.some(\n    assignment =>\n      assignment.activityId === activityId &&\n      assignment.assignmentCode === assignmentCode\n  );\n","import React, { useState, useMemo } from 'react';\nimport { Link } from 'react-router-dom';\nimport AppBar from '@material-ui/core/AppBar';\nimport Button from '@material-ui/core/Button';\nimport Grid from '@material-ui/core/Grid';\nimport Tab from '@material-ui/core/Tab';\nimport Tabs from '@material-ui/core/Tabs';\n\nimport RoomsConfig from './RoomsConfig/RoomsConfig';\nimport RoundsConfig from './RoundsConfig/RoundsConfig';\nimport GeneralConfig from './GeneralConfig/GeneralConfig';\nimport SaveWcifButton from '../../common/SaveWcifButton/SaveWcifButton';\nimport { getExpectedCompetitorsByRound } from '../../../logic/competitors';\nimport {\n  roomsConfigComplete,\n  activitiesConfigComplete,\n  anyGroupAssignedOrCreated,\n} from '../../../logic/activities';\nimport { removeExtensionData } from '../../../logic/wcif-extensions';\nimport { mapIn } from '../../../logic/utils';\n\nconst ConfigManager = ({ wcif, onWcifUpdate }) => {\n  const [localWcif, setLocalWcif] = useState(wcif);\n  const [tabValue, setTabValue] = useState(0);\n  const expectedCompetitorsByRound = useMemo(\n    () => getExpectedCompetitorsByRound(wcif),\n    [wcif]\n  );\n\n  const clearConfig = () => {\n    const withoutCompetitionConfig = removeExtensionData(\n      'CompetitionConfig',\n      localWcif\n    );\n    setLocalWcif(\n      mapIn(withoutCompetitionConfig, ['schedule', 'venues'], venue =>\n        mapIn(venue, ['rooms'], room =>\n          removeExtensionData(\n            'RoomConfig',\n            mapIn(room, ['activities'], activity =>\n              removeExtensionData('ActivityConfig', activity)\n            )\n          )\n        )\n      )\n    );\n    setTabValue(0);\n  };\n\n  const wcifConfigComplete =\n    roomsConfigComplete(localWcif) && activitiesConfigComplete(localWcif);\n\n  return (\n    <Grid container spacing={1} justify=\"flex-end\">\n      <Grid item xs={12}>\n        <AppBar position=\"static\" color=\"default\">\n          <Tabs\n            value={tabValue}\n            onChange={(event, value) => setTabValue(value)}\n            centered\n          >\n            <Tab label=\"Rooms\" />\n            <Tab label=\"Rounds\" disabled={!roomsConfigComplete(localWcif)} />\n            <Tab label=\"General\" />\n          </Tabs>\n        </AppBar>\n      </Grid>\n      <Grid item xs={12}>\n        {tabValue === 0 && (\n          <RoomsConfig wcif={localWcif} onWcifChange={setLocalWcif} />\n        )}\n        {tabValue === 1 && (\n          <RoundsConfig\n            wcif={localWcif}\n            onWcifChange={setLocalWcif}\n            expectedCompetitorsByRound={expectedCompetitorsByRound}\n          />\n        )}\n        {tabValue === 2 && (\n          <GeneralConfig wcif={localWcif} onWcifChange={setLocalWcif} />\n        )}\n      </Grid>\n      <Grid item>\n        <Button\n          variant=\"contained\"\n          component={Link}\n          to={`/competitions/${localWcif.id}`}\n        >\n          Cancel\n        </Button>\n      </Grid>\n      <Grid item>\n        <Button\n          variant=\"contained\"\n          onClick={clearConfig}\n          disabled={anyGroupAssignedOrCreated(localWcif)}\n        >\n          Clear\n        </Button>\n      </Grid>\n      <Grid item>\n        <SaveWcifButton\n          wcif={wcif}\n          updatedWcif={localWcif}\n          onWcifUpdate={onWcifUpdate}\n          disabled={!wcifConfigComplete}\n        />\n      </Grid>\n    </Grid>\n  );\n};\n\nexport default ConfigManager;\n","import React from 'react';\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport Grid from '@material-ui/core/Grid';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Typography from '@material-ui/core/Typography';\n\nimport { activityCodeToName } from '../../../../logic/activities';\nimport { hasAssignment } from '../../../../logic/competitors';\nimport { sortBy } from '../../../../logic/utils';\n\nconst roles = [\n  { id: 'competitor', label: 'Competitors' },\n  { id: 'staff-scrambler', label: 'Scramblers' },\n  { id: 'staff-runner', label: 'Runners' },\n  { id: 'staff-judge', label: 'Judges' },\n];\n\nconst GroupDialog = ({ groupActivity, wcif, onClose }) => {\n  const rolesWithPeople = roles\n    .map(role => [\n      role,\n      wcif.persons.filter(person =>\n        hasAssignment(person, groupActivity.id, role.id)\n      ),\n    ])\n    .filter(([role, people]) => people.length > 0);\n\n  return (\n    <Dialog open={true} onClose={onClose} maxWidth={false}>\n      <DialogTitle>\n        {activityCodeToName(groupActivity.activityCode)}\n      </DialogTitle>\n      <DialogContent>\n        <Grid container spacing={1}>\n          {rolesWithPeople.map(([role, people]) => (\n            <Grid item xs={12} sm={6} md key={role.id}>\n              <Typography variant=\"subtitle2\">{role.label}</Typography>\n              <List dense={true} style={{ overflowY: 'auto', maxHeight: 300 }}>\n                {sortBy(people, person => person.name).map(person => (\n                  <ListItem key={person.wcaUserId}>\n                    <ListItemText primary={person.name} />\n                  </ListItem>\n                ))}\n              </List>\n            </Grid>\n          ))}\n          {rolesWithPeople.length === 0 && (\n            <Grid item>\n              <Typography variant=\"body2\">\n                No assignments for this round.\n              </Typography>\n            </Grid>\n          )}\n        </Grid>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={onClose} color=\"secondary\">\n          Ok\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nexport default GroupDialog;\n","import React, { Fragment, useState, useCallback } from 'react';\nimport Grid from '@material-ui/core/Grid';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\n\nimport RoundsNavigation from '../../../common/RoundsNavigation/RoundsNavigation';\nimport RoomName from '../../../common/RoomName/RoomName';\nimport GroupDialog from '../GroupDialog/GroupDialog';\nimport {\n  activityDurationString,\n  parseActivityCode,\n  hasDistributedAttempts,\n  roomsWithTimezoneAndGroups,\n} from '../../../../logic/activities';\n\nconst GroupsNavigation = ({ wcif }) => {\n  const [openedGroupActivity, setOpenGroupActivity] = useState(null);\n  const events = wcif.events.filter(event => !hasDistributedAttempts(event.id));\n\n  const renderRound = useCallback(\n    roundId => (\n      <Grid container>\n        {roomsWithTimezoneAndGroups(wcif, roundId).map(\n          ([room, timezone, groupActivities]) =>\n            groupActivities.length > 0 && (\n              <Grid item xs={12} sm key={room.id}>\n                <RoomName room={room} />\n                <List>\n                  {groupActivities.map(groupActivity => (\n                    <ListItem\n                      key={groupActivity.id}\n                      button\n                      onClick={() => setOpenGroupActivity(groupActivity)}\n                    >\n                      <ListItemText\n                        primary={`Group ${\n                          parseActivityCode(groupActivity.activityCode)\n                            .groupNumber\n                        }`}\n                        secondary={activityDurationString(\n                          groupActivity,\n                          timezone\n                        )}\n                      />\n                    </ListItem>\n                  ))}\n                </List>\n              </Grid>\n            )\n        )}\n      </Grid>\n    ),\n    [wcif]\n  );\n\n  return (\n    <Fragment>\n      <RoundsNavigation events={events} render={renderRound} />\n      {openedGroupActivity && (\n        <GroupDialog\n          groupActivity={openedGroupActivity}\n          wcif={wcif}\n          onClose={() => setOpenGroupActivity(null)}\n        />\n      )}\n    </Fragment>\n  );\n};\n\nexport default GroupsNavigation;\n","import {\n  addMilliseconds,\n  chunk,\n  difference,\n  findLast,\n  flatMap,\n  groupBy,\n  intersection,\n  isoTimeDiff,\n  partition,\n  scaleToOne,\n  setIn,\n  sortBy,\n  sortByArray,\n  sum,\n  uniq,\n  updateIn,\n  mapIn,\n  times,\n  zip,\n} from './utils';\nimport { getExtensionData } from './wcif-extensions';\nimport {\n  activitiesIntersection,\n  activitiesOverlap,\n  activityById,\n  activityCodeToName,\n  activityDuration,\n  hasDistributedAttempts,\n  maxActivityId,\n  parseActivityCode,\n  roundActivities,\n  groupActivitiesByRound,\n  roundsMissingAssignments,\n  stationsByActivity,\n  updateActivity,\n} from './activities';\nimport {\n  acceptedPeople,\n  age,\n  bestAverageAndSingle,\n  competitorsForRound,\n  hasAssignment,\n  staffAssignments,\n  staffAssignmentsForEvent,\n} from './competitors';\n\nexport const createGroupActivities = wcif => {\n  const rounds = flatMap(wcif.events, event => event.rounds);\n  return rounds.reduce((wcif, round) => {\n    /* For FMC and MBLD the activities are already scheduled, and there is always a single group. */\n    if (hasDistributedAttempts(round.id)) return wcif;\n    /* If there are already groups created, don't override them. */\n    if (groupActivitiesByRound(wcif, round.id).length > 0) return wcif;\n    const currentActivityId = maxActivityId(wcif);\n    const activitiesWithGroups = roundActivities(wcif, round.id).map(\n      activity => {\n        const { groups } = getExtensionData('ActivityConfig', activity);\n        const totalDuration = activityDuration(activity);\n        const groupDuration = totalDuration / groups;\n        const groupActivities = times(groups, index => ({\n          id: null,\n          name: null,\n          activityCode: null,\n          startTime: addMilliseconds(activity.startTime, groupDuration * index),\n          endTime: addMilliseconds(\n            activity.startTime,\n            groupDuration * index + groupDuration\n          ),\n          childActivities: [],\n          scrambleSetId: null,\n        }));\n        return { ...activity, childActivities: groupActivities };\n      }\n    );\n    sortByArray(\n      flatMap(activitiesWithGroups, activity => activity.childActivities),\n      ({ startTime, endTime }) => [startTime, endTime]\n    ).forEach((groupActivity, index) => {\n      const activityCode = `${round.id}-g${index + 1}`;\n      /* The child activities are newly created objects, so it's fine to mutate them at this point. */\n      return Object.assign(groupActivity, {\n        id: currentActivityId + index + 1,\n        name: activityCodeToName(activityCode),\n        activityCode,\n      });\n    });\n    return activitiesWithGroups.reduce(updateActivity, wcif);\n  }, wcif);\n};\n\nexport const assignTasks = wcif => {\n  const roundsToAssign = roundsMissingAssignments(wcif);\n  return [assignGroups, assignScrambling, assignRunning, assignJudging].reduce(\n    (wcif, assignmentFn) => assignmentFn(wcif, roundsToAssign),\n    wcif\n  );\n};\n\nconst assignGroups = (wcif, roundsToAssign) => {\n  /* Sort rounds by the number of groups, so the further the more possible timeframes there are. */\n  const sortedRoundsToAssign = sortBy(roundsToAssign, round =>\n    hasDistributedAttempts(round.id)\n      ? -Infinity\n      : groupActivitiesByRound(wcif, round.id).length\n  );\n  return sortedRoundsToAssign.reduce((wcif, round) => {\n    const competitors = sortedCompetitorsForRound(wcif, round.id);\n    if (hasDistributedAttempts(round.id)) {\n      /* In this case roundActivities are attempt activities.\n         We want every competitor to be assigned all attempts.\n         The same attempt may take place in many different rooms,\n         so for each attempt we split people among this attempt's activities. */\n      const activitiesByAttempt = groupBy(\n        roundActivities(wcif, round.id),\n        ({ activityCode }) => parseActivityCode(activityCode).attemptNumber\n      );\n      const updatedCompetitors = Object.values(activitiesByAttempt).reduce(\n        (competitors, attemptActivities) => {\n          const competitorsPerActivity = Math.ceil(\n            competitors.length / attemptActivities.length\n          );\n          const activitiesWithCompetitors = zip(\n            attemptActivities,\n            chunk(competitors, competitorsPerActivity)\n          );\n          return flatMap(activitiesWithCompetitors, ([activity, competitors]) =>\n            assignActivity(activity.id, 'competitor', competitors)\n          );\n        },\n        competitors\n      );\n      return updatePeople(wcif, updatedCompetitors);\n    }\n    const initialGroups = sortedGroupActivitiesWithSize(\n      wcif,\n      round.id,\n      competitors.length\n    ).map(([activity, size]) => ({\n      id: activity.id,\n      activity,\n      size,\n      competitors: [],\n    }));\n    const groups = competitors.reduce((groups, competitor) => {\n      const availabilityRates = groups.map(group =>\n        availabilityRate(wcif, group.activity, competitor)\n      );\n      const maxAvailabilityRate = Math.max(...availabilityRates);\n      const mostAvailableGroups = groups.filter(\n        (group, index) => availabilityRates[index] === maxAvailabilityRate\n      );\n      const preferredGroups = mostAvailableGroups.filter(\n        group =>\n          !overlapsEveryoneWithSameRole(\n            wcif,\n            groups,\n            group.activity,\n            competitor\n          )\n      );\n      const potentialGroups =\n        preferredGroups.length > 0 ? preferredGroups : mostAvailableGroups;\n      const notFullGroup = potentialGroups.find(\n        ({ size, competitors }) => competitors.length < size\n      );\n      if (notFullGroup) {\n        return addCompetitorToGroupEnd(groups, notFullGroup.id, competitor);\n      } else {\n        const group = potentialGroups[potentialGroups.length - 1];\n        const updatedGroups = addCompetitorToGroupEnd(\n          groups,\n          group.id,\n          competitor\n        );\n        return (\n          moveSomeoneRight(wcif, updatedGroups, group.id) ||\n          moveSomeoneLeft(wcif, updatedGroups, group.id) ||\n          updatedGroups\n        );\n      }\n    }, initialGroups);\n    const updatedCompetitors = flatMap(groups, ({ activity, competitors }) =>\n      assignActivity(activity.id, 'competitor', competitors)\n    );\n    return updatePeople(wcif, updatedCompetitors);\n  }, wcif);\n};\n\nexport const sortedGroupActivitiesWithSize = (\n  wcif,\n  roundId,\n  competitorCount\n) => {\n  const groupActivitiesWithCapacity = flatMap(\n    roundActivities(wcif, roundId),\n    activity => {\n      const { capacity } = getExtensionData('ActivityConfig', activity);\n      return activity.childActivities.map(groupActivity => [\n        groupActivity,\n        capacity / activity.childActivities.length,\n      ]);\n    }\n  );\n  const [groupActivities, capacities] = zip(...groupActivitiesWithCapacity);\n  const groupSizes = calculateGroupSizes(capacities, competitorCount);\n  return sortBy(\n    zip(groupActivities, groupSizes),\n    ([{ activityCode }]) => parseActivityCode(activityCode).groupNumber\n  );\n};\n\nconst calculateGroupSizes = ([capacity, ...capacities], competitorCount) => {\n  if (!capacity) return [];\n  const groupSize = Math.round(capacity * competitorCount);\n  return [\n    groupSize,\n    ...calculateGroupSizes(scaleToOne(capacities), competitorCount - groupSize),\n  ];\n};\n\nconst sortedCompetitorsForRound = (wcif, roundId) => {\n  const { competitorsSortingRule } = getExtensionData(\n    'CompetitionConfig',\n    wcif\n  );\n  const sortedByRanks = competitorsForRound(wcif, roundId);\n  const { eventId, roundNumber } = parseActivityCode(roundId);\n  if (roundNumber > 1) return sortedByRanks;\n  if (competitorsSortingRule === 'ranks') return sortedByRanks;\n  if (\n    competitorsSortingRule === 'balanced' &&\n    ['333', '222', '333bf', '333oh', '333ft', 'pyram', 'skewb'].includes(\n      eventId\n    )\n  )\n    return sortedByRanks;\n  if (['balanced', 'symmetric'].includes(competitorsSortingRule)) {\n    const groupCount = groupActivitiesByRound(wcif, roundId).length;\n    return sortBy(\n      sortedByRanks,\n      competitor =>\n        groupCount -\n        ((sortedByRanks.length - sortedByRanks.indexOf(competitor) - 1) %\n          groupCount)\n    );\n  }\n  if (competitorsSortingRule === 'name-optimised') {\n    const competitorsByName = groupBy(\n      sortedByRanks,\n      ({ name }) => name.split(' ')[0]\n    );\n    /* We take sets of competitors with the same name and sort them by quantity.\n       Starting with the smallest sets we keep adding competitors to a single set of `competitors`.\n       For each set of competitors of length N (having the same name), we split `competitors` into N chunks\n       and add one competitor to each of those chunks. Then we join the chunks back forming the new `competitors` set.\n       This way we maximise the gap between people with the same name. */\n    return sortBy(\n      Object.values(competitorsByName),\n      competitors => competitors.length\n    ).reduce((competitors, competitorsWithSameName) => {\n      const chunkSize = Math.ceil(\n        competitors.length / competitorsWithSameName.length\n      );\n      return flatMap(\n        zip(chunk(competitors, chunkSize), competitorsWithSameName),\n        ([competitors, competitor]) => [...competitors, competitor]\n      );\n    });\n  }\n  throw new Error(\n    `Unrecognised competitors sorting rule: '${competitorsSortingRule}'`\n  );\n};\n\nconst moveSomeoneRight = (wcif, groups, groupId) => {\n  const group = groups.find(({ id }) => id === groupId);\n  return groups\n    .slice(groups.indexOf(group) + 1)\n    .reduce((updatedGroups, furtherGroup) => {\n      if (updatedGroups) return updatedGroups;\n      const competitorToMove = findLast(\n        group.competitors,\n        competitor =>\n          availabilityRate(wcif, group.activity, competitor) ===\n            availabilityRate(wcif, furtherGroup.activity, competitor) &&\n          !overlapsEveryoneWithSameRole(\n            wcif,\n            groups,\n            furtherGroup.activity,\n            competitor\n          )\n      );\n      if (!competitorToMove) return null; // Try the next group.\n      if (furtherGroup.competitors.length < furtherGroup.size) {\n        return moveCompetitorToGroupStart(\n          groups,\n          groupId,\n          furtherGroup.id,\n          competitorToMove\n        );\n      } else if (furtherGroup.competitors.length === furtherGroup.size) {\n        const groupsWithSpot = moveSomeoneRight(wcif, groups, furtherGroup.id);\n        return (\n          groupsWithSpot &&\n          moveCompetitorToGroupStart(\n            groupsWithSpot,\n            groupId,\n            furtherGroup.id,\n            competitorToMove\n          )\n        );\n      }\n      return null;\n    }, null);\n};\n\nconst moveSomeoneLeft = (wcif, groups, groupId) => {\n  const group = groups.find(({ id }) => id === groupId);\n  return groups\n    .slice(0, groups.indexOf(group))\n    .reduceRight((updatedGroups, previousGroup) => {\n      if (updatedGroups) return updatedGroups;\n      const competitorToMove = group.competitors.find(\n        competitor =>\n          availabilityRate(wcif, group.activity, competitor) ===\n            availabilityRate(wcif, previousGroup.activity, competitor) &&\n          !overlapsEveryoneWithSameRole(\n            wcif,\n            groups,\n            previousGroup.activity,\n            competitor\n          )\n      );\n      if (!competitorToMove) return null; // Try the previous group.\n      const groupsWithSpot = moveSomeoneRight(wcif, groups, previousGroup.id);\n      return (\n        groupsWithSpot &&\n        moveCompetitorToGroupEnd(\n          groupsWithSpot,\n          groupId,\n          previousGroup.id,\n          competitorToMove\n        )\n      );\n    }, null);\n};\n\nconst updateCompetitorsInGroup = (groups, groupId, updater) =>\n  groups.map(group =>\n    group.id === groupId ? updateIn(group, ['competitors'], updater) : group\n  );\n\nconst addCompetitorToGroupStart = (groups, groupId, competitor) =>\n  updateCompetitorsInGroup(groups, groupId, competitors => [\n    competitor,\n    ...competitors,\n  ]);\n\nconst addCompetitorToGroupEnd = (groups, groupId, competitor) =>\n  updateCompetitorsInGroup(groups, groupId, competitors => [\n    ...competitors,\n    competitor,\n  ]);\n\nconst removeCompetitorFromGroup = (groups, groupId, competitor) =>\n  updateCompetitorsInGroup(groups, groupId, competitors =>\n    competitors.filter(other => other !== competitor)\n  );\n\nconst moveCompetitorToGroupStart = (\n  groups,\n  fromGroupId,\n  toGroupId,\n  competitor\n) =>\n  addCompetitorToGroupStart(\n    removeCompetitorFromGroup(groups, fromGroupId, competitor),\n    toGroupId,\n    competitor\n  );\n\nconst moveCompetitorToGroupEnd = (groups, fromGroupId, toGroupId, competitor) =>\n  addCompetitorToGroupEnd(\n    removeCompetitorFromGroup(groups, fromGroupId, competitor),\n    toGroupId,\n    competitor\n  );\n\nconst assignScrambling = (wcif, roundsToAssign) => {\n  const { noTasksForNewcomers } = getExtensionData('CompetitionConfig', wcif);\n  /* Sort rounds by the number of competitors, so the further the more people able to scramble there are. */\n  const sortedRoundsToAssign = sortBy(\n    roundsToAssign,\n    round => competitorsForRound(wcif, round.id).length\n  );\n  return sortedRoundsToAssign.reduce((wcif, round) => {\n    if (hasDistributedAttempts(round.id)) return wcif;\n    const { eventId } = parseActivityCode(round.id);\n    return roundActivities(wcif, round.id).reduce((wcif, activity) => {\n      const { scramblers } = getExtensionData('ActivityConfig', activity);\n      if (scramblers === 0) return wcif;\n      return activity.childActivities.reduce((wcif, groupActivity) => {\n        const staffScramblers = acceptedPeople(wcif).filter(person =>\n          person.roles.includes('staff-scrambler')\n        );\n        const competitors = difference(\n          competitorsForRound(wcif, round.id),\n          staffScramblers\n        );\n        const available = people =>\n          people.filter(person => availableDuring(wcif, groupActivity, person));\n        const sortedAvailableStaff = sortByArray(\n          available(staffScramblers),\n          competitor => [\n            /* Avoid difference in the number of tasks bigger than 3.\n             (General note: this is better than sorting by the number of tasks,\n             as it allows one person to be assigned a couple times in a row). */\n            Math.floor(staffAssignments(competitor).length / 3),\n            /* Prefer competitors better in the given event. */\n            ...bestAverageAndSingle(competitor, eventId),\n          ]\n        );\n        const sortedAvailableCompetitors =\n          sortedAvailableStaff.length >= scramblers\n            ? []\n            : sortByArray(available(competitors), competitor => [\n                /* Optionally avoid assigning tasks to newcomers. */\n                noTasksForNewcomers && !competitor.wcaId ? 1 : -1,\n                /* Strongly prefer people at least 10 years old. */\n                age(competitor) >= 10 ? -1 : 1,\n                /* Avoid assigning tasks to people already busy due to their role. */\n                intersection(\n                  ['staff-dataentry', 'delegate', 'organizer'],\n                  competitor.roles\n                ).length,\n                /* Avoid more than two assignments for the given event. */\n                staffAssignmentsForEvent(wcif, competitor, eventId).length >= 2\n                  ? 1\n                  : -1,\n                /* Prefer competitors that are likely to be on the venue. */\n                -presenceRate(wcif, competitor, groupActivity.startTime),\n                /* Avoid difference in the number of tasks bigger than 6. */\n                Math.floor(staffAssignments(competitor).length / 6),\n                /* Prefer competitors who doesn't solve soon after the group ends. */\n                competesIn15Minutes(wcif, competitor, groupActivity.endTime)\n                  ? 1\n                  : -1,\n                /* Prefer competitors better in the given event. */\n                ...bestAverageAndSingle(competitor, eventId),\n              ]);\n        const potentialScramblers = [\n          ...sortedAvailableStaff,\n          ...sortedAvailableCompetitors,\n        ];\n        const updatedCompetitors = assignActivity(\n          groupActivity.id,\n          'staff-scrambler',\n          potentialScramblers.slice(0, scramblers)\n        );\n        return updatePeople(wcif, updatedCompetitors);\n      }, wcif);\n    }, wcif);\n  }, wcif);\n};\n\nconst assignRunning = (wcif, roundsToAssign) => {\n  const { noTasksForNewcomers, tasksForOwnEventsOnly } = getExtensionData(\n    'CompetitionConfig',\n    wcif\n  );\n  return roundsToAssign.reduce((wcif, round) => {\n    if (hasDistributedAttempts(round.id)) return wcif;\n    const { eventId } = parseActivityCode(round.id);\n    return roundActivities(wcif, round.id).reduce((wcif, activity) => {\n      const { runners } = getExtensionData('ActivityConfig', activity);\n      if (runners === 0) return wcif;\n      return activity.childActivities.reduce((wcif, groupActivity) => {\n        const [staffRunners, people] = partition(acceptedPeople(wcif), person =>\n          person.roles.includes('staff-runner')\n        );\n        const available = people =>\n          people.filter(person => availableDuring(wcif, groupActivity, person));\n        const sortedAvailableStaff = sortByArray(\n          available(staffRunners),\n          competitor => [\n            Math.floor(staffAssignments(competitor).length / 3),\n            competesIn15Minutes(wcif, competitor, groupActivity.endTime)\n              ? 1\n              : -1,\n          ]\n        );\n        const sortedAvailablePeople =\n          sortedAvailableStaff.length >= runners\n            ? []\n            : sortByArray(available(people), competitor => [\n                noTasksForNewcomers && !competitor.wcaId ? 1 : -1,\n                tasksForOwnEventsOnly &&\n                !competitor.registration.eventIds.includes(eventId)\n                  ? 1\n                  : -1,\n                age(competitor) >= 10 ? -1 : 1,\n                intersection(\n                  ['staff-dataentry', 'delegate', 'organizer'],\n                  competitor.roles\n                ).length,\n                staffAssignmentsForEvent(wcif, competitor, eventId).length >= 2\n                  ? 1\n                  : -1,\n                -presenceRate(wcif, competitor, groupActivity.startTime),\n                Math.floor(staffAssignments(competitor).length / 6),\n                competesIn15Minutes(wcif, competitor, groupActivity.endTime)\n                  ? 1\n                  : -1,\n              ]);\n        const potentialRunners = [\n          ...sortedAvailableStaff,\n          ...sortedAvailablePeople,\n        ];\n        const updatedPeople = assignActivity(\n          groupActivity.id,\n          'staff-runner',\n          potentialRunners.slice(0, runners)\n        );\n        return updatePeople(wcif, updatedPeople);\n      }, wcif);\n    }, wcif);\n  }, wcif);\n};\n\nconst assignJudging = (wcif, roundsToAssign) => {\n  const { noTasksForNewcomers, tasksForOwnEventsOnly } = getExtensionData(\n    'CompetitionConfig',\n    wcif\n  );\n  return roundsToAssign.reduce((wcif, round) => {\n    if (hasDistributedAttempts(round.id)) return wcif;\n    const { eventId } = parseActivityCode(round.id);\n    return roundActivities(wcif, round.id).reduce((wcif, activity) => {\n      const { assignJudges } = getExtensionData('ActivityConfig', activity);\n      const stations = stationsByActivity(wcif, activity.id);\n      if (!assignJudges) return wcif;\n      return activity.childActivities.reduce((wcif, groupActivity) => {\n        const competitors = wcif.persons.filter(competitor =>\n          hasAssignment(competitor, groupActivity.id, 'competitor')\n        ).length;\n        const judges = Math.min(stations, competitors);\n        const [staffJudges, people] = partition(acceptedPeople(wcif), person =>\n          person.roles.includes('staff-judge')\n        );\n        const available = people =>\n          people.filter(person => availableDuring(wcif, groupActivity, person));\n        const sortedAvailableStaff = sortByArray(\n          available(staffJudges),\n          competitor => [\n            /* Equally distribute tasks (judging is assigned last, so we want to eliminate inequality introduced by other assignments). */\n            staffAssignments(competitor).length,\n            competesIn15Minutes(wcif, competitor, groupActivity.endTime)\n              ? 1\n              : -1,\n          ]\n        );\n        const sortedAvailablePeople =\n          sortedAvailableStaff.length >= judges\n            ? []\n            : sortByArray(available(people), competitor => [\n                noTasksForNewcomers && !competitor.wcaId ? 1 : -1,\n                tasksForOwnEventsOnly &&\n                !competitor.registration.eventIds.includes(eventId)\n                  ? 1\n                  : -1,\n                age(competitor) >= 10 ? -1 : 1,\n                intersection(\n                  ['staff-dataentry', 'delegate', 'organizer'],\n                  competitor.roles\n                ).length,\n                staffAssignmentsForEvent(wcif, competitor, eventId).length >= 2\n                  ? 1\n                  : -1,\n                -presenceRate(wcif, competitor, groupActivity.startTime),\n                /* Equally distribute tasks (judging is assigned last, so we want to eliminate inequality introduced by other assignments). */\n                staffAssignments(competitor).length,\n                competesIn15Minutes(wcif, competitor, groupActivity.endTime)\n                  ? 1\n                  : -1,\n                /* Prefer people that solve fewer events, to avoid overloading people solving more. */\n                competitor.registration\n                  ? competitor.registration.eventIds.length\n                  : 0,\n              ]);\n        const potentialJudges = [\n          ...sortedAvailableStaff,\n          ...sortedAvailablePeople,\n        ];\n        const updatedPeople = assignActivity(\n          groupActivity.id,\n          'staff-judge',\n          potentialJudges.slice(0, judges)\n        );\n        return updatePeople(wcif, updatedPeople);\n      }, wcif);\n    }, wcif);\n  }, wcif);\n};\n\nconst competesIn15Minutes = (wcif, competitor, isoString) => {\n  const competingStartTimes = competitor.assignments\n    .filter(({ assignmentCode }) => assignmentCode === 'competitor')\n    .map(({ activityId }) => activityById(wcif, activityId).startTime)\n    .filter(startTime => startTime >= isoString);\n  if (competingStartTimes.length === 0) return false;\n  const competingStart = competingStartTimes.reduce((x, y) => (x < y ? x : y));\n  return isoTimeDiff(competingStart, isoString) <= 15 * 60 * 1000;\n};\n\n/* The lower, the less likely the competitor is to be at the venue. */\nconst presenceRate = (wcif, competitor, time) => {\n  const activitiesThisDay = competitor.assignments\n    .map(({ activityId }) => activityById(wcif, activityId))\n    .filter(\n      ({ startTime }) =>\n        new Date(startTime).getDay() === new Date(time).getDay()\n    );\n  if (activitiesThisDay.length === 0) return 0;\n  const [startTimes, endTimes] = zip(\n    ...activitiesThisDay.map(({ startTime, endTime }) => [startTime, endTime])\n  ).map(times => times.sort());\n  /* If first activity is in the future, the sonner it is, the more likely the person is to be at the venue. */\n  if (startTimes[0] > time) return 1 + 1 / isoTimeDiff(time, startTimes[0]);\n  const previousEndTime = findLast(endTimes, endTime => endTime <= time);\n  const nextStartTime = startTimes.find(startTime => startTime >= time);\n  if (previousEndTime) {\n    if (nextStartTime) {\n      /* > 1 hour after last activity and > 1 hour before next one */\n      if (\n        isoTimeDiff(time, previousEndTime) > 60 * 60 * 1000 &&\n        isoTimeDiff(time, nextStartTime) > 60 * 60 * 1000\n      )\n        return 3;\n    } else {\n      /* > 30 min after last activity */\n      if (isoTimeDiff(time, previousEndTime) > 30 * 60 * 1000) return 2;\n    }\n  }\n  return 4;\n};\n\nconst assignActivity = (activityId, assignmentCode, competitors) =>\n  competitors.map(competitor => ({\n    ...competitor,\n    assignments: [...competitor.assignments, { activityId, assignmentCode }],\n  }));\n\nconst updatePeople = (wcif, updatedPeople) =>\n  mapIn(\n    wcif,\n    ['persons'],\n    person =>\n      updatedPeople.find(\n        updatedPerson => updatedPerson.wcaUserId === person.wcaUserId\n      ) || person\n  );\n\nconst availableDuring = (wcif, activity, competitor) =>\n  !competitor.assignments.some(({ activityId }) =>\n    activitiesOverlap(activityById(wcif, activityId), activity)\n  );\n\nconst availabilityRate = (wcif, activity, competitor) => {\n  const intersections = competitor.assignments.map(({ activityId }) =>\n    activitiesIntersection(activityById(wcif, activityId), activity)\n  );\n  const timeWhenBusy = sum(intersections);\n  return -(timeWhenBusy / activityDuration(activity));\n};\n\nconst overlapsEveryoneWithSameRole = (wcif, groups, activity, competitor) =>\n  intersection(\n    ['staff-dataentry', 'delegate', 'organizer'],\n    competitor.roles\n  ).some(role => {\n    const others = acceptedPeople(wcif)\n      .filter(person => person.wcaUserId !== competitor.wcaUserId)\n      .filter(person => person.roles.includes(role));\n    return (\n      others.length > 0 &&\n      others.every(\n        other =>\n          !availableDuring(wcif, activity, other) ||\n          groups.some(\n            ({ activity: groupActivity, competitors }) =>\n              competitors.includes(other) &&\n              activitiesOverlap(groupActivity, activity)\n          )\n      )\n    );\n  });\n\nexport const updateScrambleSetCount = wcif =>\n  mapIn(wcif, ['events'], event =>\n    mapIn(event, ['rounds'], round =>\n      setIn(\n        round,\n        ['scrambleSetCount'],\n        scrambleSetCountForRound(wcif, round.id)\n      )\n    )\n  );\n\n/* Assume one scramble set for each unique timeframe, i.e. (startTime, endTime) pair. */\nconst scrambleSetCountForRound = (wcif, roundId) =>\n  hasDistributedAttempts(roundId)\n    ? 1\n    : uniq(\n        groupActivitiesByRound(wcif, roundId).map(\n          ({ startTime, endTime }) => startTime + endTime\n        )\n      ).length;\n","import React, { useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport Button from '@material-ui/core/Button';\nimport Grid from '@material-ui/core/Grid';\nimport SnackbarContent from '@material-ui/core/SnackbarContent';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport pink from '@material-ui/core/colors/pink';\n\nimport GroupsNavigation from './GroupsNavigation/GroupsNavigation';\nimport SaveWcifButton from '../../common/SaveWcifButton/SaveWcifButton';\n\nimport {\n  createGroupActivities,\n  updateScrambleSetCount,\n  assignTasks,\n} from '../../../logic/groups';\nimport {\n  allGroupsCreated,\n  roundsMissingAssignments,\n  clearGroupsAndAssignments,\n} from '../../../logic/activities';\n\nconst GroupsManager = ({ wcif, onWcifUpdate }) => {\n  const [localWcif, setLocalWcif] = useState(wcif);\n\n  const handleCreateGroupActivities = () => {\n    setLocalWcif(updateScrambleSetCount(createGroupActivities(localWcif)));\n  };\n\n  const handleAssignTasks = () => {\n    setLocalWcif(assignTasks(localWcif));\n  };\n\n  const handleClearGroups = () => {\n    setLocalWcif(clearGroupsAndAssignments(localWcif));\n  };\n\n  const groupsCreated = allGroupsCreated(localWcif);\n\n  return (\n    <Grid container spacing={1} justify=\"flex-end\">\n      <Grid item xs={12}>\n        {!groupsCreated && (\n          <SnackbarContent\n            style={{ maxWidth: 'none' }}\n            message=\"To assign tasks you need to create groups first. This will also determine scramble set count for each round.\"\n            action={\n              <Button\n                onClick={handleCreateGroupActivities}\n                style={{ color: pink[500] }}\n                size=\"small\"\n              >\n                Create groups\n              </Button>\n            }\n          />\n        )}\n        {groupsCreated && roundsMissingAssignments(localWcif).length > 0 && (\n          <SnackbarContent\n            style={{ maxWidth: 'none' }}\n            message=\"There are rounds with no tasks assigned.\"\n            action={\n              <Button\n                onClick={handleAssignTasks}\n                style={{ color: pink[500] }}\n                size=\"small\"\n              >\n                Assign tasks\n              </Button>\n            }\n          />\n        )}\n      </Grid>\n      <Grid item xs={12}>\n        <GroupsNavigation wcif={localWcif} />\n      </Grid>\n      <Grid item>\n        <Button\n          variant=\"contained\"\n          component={Link}\n          to={`/competitions/${localWcif.id}`}\n        >\n          Cancel\n        </Button>\n      </Grid>\n      <Grid item>\n        <Tooltip\n          title=\"This clears groups and assignments only for rounds without results.\"\n          placement=\"bottom\"\n        >\n          <Button variant=\"contained\" onClick={handleClearGroups}>\n            Clear\n          </Button>\n        </Tooltip>\n      </Grid>\n      <Grid item>\n        <SaveWcifButton\n          wcif={wcif}\n          updatedWcif={localWcif}\n          onWcifUpdate={onWcifUpdate}\n        />\n      </Grid>\n    </Grid>\n  );\n};\n\nexport default GroupsManager;\n","import pdfMake from 'pdfmake/build/pdfmake';\n\n/* Asynchronously download fonts bundle for PDF Make. */\nfetch('/vfs-fonts.bundle.v2.json', { mode: 'same-origin' })\n  .then(response => response.json())\n  .then(vfsFonts => (pdfMake.vfs = vfsFonts));\n\nconst singleFileFont = file => ({\n  normal: file,\n  bold: file,\n  italic: file,\n  bolditalics: file,\n});\n\npdfMake.fonts = {\n  Roboto: {\n    normal: 'Roboto-Regular.ttf',\n    bold: 'Roboto-Medium.ttf',\n    italics: 'Roboto-Italic.ttf',\n    bolditalics: 'Roboto-MediumItalic.ttf',\n  },\n  WenQuanYiZenHei: singleFileFont('WenQuanYiZenHei.ttf'),\n  /* Note: https://github.com/googlefonts/noto-fonts/blob/master/FAQ.md#whats-the-difference-between-the-ui-and-non-ui-versions */\n  NotoSansThai: singleFileFont('NotoSansThaiUI-Regular.ttf'),\n  NotoSansArabic: singleFileFont('NotoSansArabicUI-Regular.ttf'),\n  NotoSansGeorgian: singleFileFont('NotoSansGeorgian-Regular.ttf'),\n  NotoSansArmenian: singleFileFont('NotoSansArmenian-Regular.ttf'),\n};\n\nexport default pdfMake;\n","import { parseActivityCode } from './activities';\nimport { shortEventNameById } from './events';\n\nexport const cutoffToString = (cutoff, eventId) => {\n  if (eventId === '333mbf') {\n    return `${multibldAttemptResultToPoints(cutoff.attemptResult)} points`;\n  } else if (eventId === '333fm') {\n    return `${cutoff.attemptResult} moves`;\n  } else {\n    return centisecondsToClockFormat(cutoff.attemptResult);\n  }\n};\n\nexport const timeLimitToString = timeLimit => {\n  const { centiseconds, cumulativeRoundIds } = timeLimit;\n  const clockFormat = centisecondsToClockFormat(centiseconds);\n  if (cumulativeRoundIds.length === 0) {\n    return clockFormat;\n  } else if (cumulativeRoundIds.length === 1) {\n    return `${clockFormat} in total`;\n  } else {\n    const roundStrings = cumulativeRoundIds.map(roundId => {\n      const { eventId, roundNumber } = parseActivityCode(roundId);\n      return `${shortEventNameById(eventId)} R${roundNumber}`;\n    });\n    return `${clockFormat} total for ${roundStrings.join(', ')}`;\n  }\n};\n\nconst multibldAttemptResultToPoints = attemptResult =>\n  99 - (Math.floor(attemptResult / 10000000) % 100);\n\nconst centisecondsToClockFormat = centiseconds => {\n  const date = new Date(null);\n  date.setUTCMilliseconds(centiseconds * 10);\n  return date\n    .toISOString()\n    .substr(11, 11)\n    .replace(/^[0:]*(?!\\.)/g, '');\n};\n","import { inRange } from '../utils';\n\nconst determineFont = text => {\n  const code = text.charCodeAt(0);\n  /* Based on https://en.wikipedia.org/wiki/Unicode_block */\n  if (inRange(code, 0x0000, 0x052f)) {\n    return 'Roboto';\n  } else if (inRange(code, 0x0600, 0x06ff) || inRange(code, 0x0750, 0x077f)) {\n    return 'NotoSansArabic';\n  } else if (inRange(code, 0x0e00, 0x0e7f)) {\n    return 'NotoSansThai';\n  } else if (inRange(code, 0x0530, 0x058f)) {\n    return 'NotoSansArmenian';\n  } else if (inRange(code, 0x10a0, 0x10ff)) {\n    return 'NotoSansGeorgian';\n  } else {\n    /* Default to WenQuanYiZenHei as it supports the most characters (mostly CJK). */\n    return 'WenQuanYiZenHei';\n  }\n};\n\nexport const pdfName = (\n  name,\n  { swapLatinWithLocalNames = false, short = false } = {}\n) => {\n  /* Note: support normal and fullwidth parentheses. */\n  const [, latinName, localName] = name.match(/(.+)\\s*[(](.+)[)]/) || [\n    null,\n    name,\n    null,\n  ];\n  if (!localName) return latinName;\n  const pdfNames = [\n    latinName,\n    { text: localName, font: determineFont(localName) },\n  ];\n  const [first, second] = swapLatinWithLocalNames\n    ? pdfNames.reverse()\n    : pdfNames;\n  return short ? first : [first, ' (', second, ')'];\n};\n\nexport const getImageDataUrl = url => {\n  if (!url) return Promise.resolve(null);\n  const params = new URLSearchParams({\n    url,\n    bri: 50,\n    bg: 'white',\n    w: 200,\n    h: 200,\n    t: 'letterbox',\n    output: 'jpg',\n    encoding: 'base64',\n  });\n  return fetch(`https://images.weserv.nl/?${params.toString()}`)\n    .then(response => response.text())\n    .catch(() => null);\n};\n","import pdfMake from './pdfmake';\nimport { flatMap, sortBy, chunk, times, sum, uniq } from '../utils';\nimport {\n  parseActivityCode,\n  groupActivitiesByRound,\n  hasDistributedAttempts,\n} from '../activities';\nimport { eventNameById } from '../events';\nimport { cutoffToString, timeLimitToString } from '../formatters';\nimport {\n  getExpectedCompetitorsByRound,\n  competitorsForRound,\n  hasAssignment,\n} from '../competitors';\nimport { getExtensionData } from '../wcif-extensions';\nimport { pdfName, getImageDataUrl } from './pdf-utils';\nimport { sortedGroupActivitiesWithSize } from '../groups';\n\n/* See: https://github.com/bpampuch/pdfmake/blob/3da11bd8148b190808b06f7bc27883102bf82917/src/standardPageSizes.js#L10 */\nconst pageWidth = 595.28;\nconst pageHeight = 841.89;\nconst scorecardMargin = 20;\n\nconst maxAttemptCountByFormat = { '1': 1, '2': 2, '3': 3, m: 3, a: 5 };\n\nexport const downloadScorecards = (wcif, rounds) => {\n  const { scorecardsBackgroundUrl } = getExtensionData(\n    'CompetitionConfig',\n    wcif\n  );\n  getImageDataUrl(scorecardsBackgroundUrl).then(imageData => {\n    const pdfDefinition = scorecardsPdfDefinition(\n      scorecards(wcif, rounds),\n      imageData\n    );\n    pdfMake.createPdf(pdfDefinition).download(`${wcif.id}-scorecards.pdf`);\n  });\n};\n\nexport const downloadBlankScorecards = wcif => {\n  const { scorecardsBackgroundUrl } = getExtensionData(\n    'CompetitionConfig',\n    wcif\n  );\n  getImageDataUrl(scorecardsBackgroundUrl).then(imageData => {\n    const pdfDefinition = scorecardsPdfDefinition(\n      blankScorecards(wcif),\n      imageData\n    );\n    pdfMake\n      .createPdf(pdfDefinition)\n      .download(`${wcif.id}-blank-scorecards.pdf`);\n  });\n};\n\nconst scorecardsPdfDefinition = (scorecardList, imageData) => ({\n  background: [\n    ...(imageData === null\n      ? []\n      : [\n          /* Determined empirically to fit results table. */\n          { x: 60, y: 170 },\n          { x: 360, y: 170 },\n          { x: 60, y: 590 },\n          { x: 360, y: 590 },\n        ].map(absolutePosition => ({ absolutePosition, image: imageData }))),\n    {\n      canvas: [\n        cutLine({\n          x1: scorecardMargin,\n          y1: pageHeight / 2,\n          x2: pageWidth - scorecardMargin,\n          y2: pageHeight / 2,\n        }),\n        cutLine({\n          x1: pageWidth / 2,\n          y1: scorecardMargin,\n          x2: pageWidth / 2,\n          y2: pageHeight - scorecardMargin,\n        }),\n      ],\n    },\n  ],\n  pageMargins: [scorecardMargin, scorecardMargin],\n  content: {\n    layout: {\n      /* Outer margin is done using pageMargins, we use padding for the remaining inner margins. */\n      paddingLeft: i => (i % 2 === 0 ? 0 : scorecardMargin),\n      paddingRight: i => (i % 2 === 0 ? scorecardMargin : 0),\n      paddingTop: i => (i % 2 === 0 ? 0 : scorecardMargin),\n      paddingBottom: i => (i % 2 === 0 ? scorecardMargin : 0),\n      /* Get rid of borders. */\n      hLineWidth: () => 0,\n      vLineWidth: () => 0,\n    },\n    table: {\n      widths: ['*', '*'],\n      /* A4 page height minus vertical margins, divided into a half. */\n      heights: (pageHeight - 4 * scorecardMargin) / 2,\n      dontBreakRows: true,\n      body: chunk(scorecardList, 2),\n    },\n  },\n});\n\nconst cutLine = properties => ({\n  ...properties,\n  type: 'line',\n  lineWidth: 0.1,\n  dash: { length: 10 },\n  lineColor: '#888888',\n});\n\nconst scorecards = (wcif, rounds) => {\n  const { localNamesFirst } = getExtensionData('CompetitionConfig', wcif);\n  return flatMap(rounds, round => {\n    const groupsWithCompetitors = groupActivitiesWithCompetitors(\n      wcif,\n      round.id\n    );\n    let scorecardNumber = sum(\n      groupsWithCompetitors.map(([_, competitors]) => competitors.length)\n    );\n    return flatMap(groupsWithCompetitors, ([groupActivity, competitors]) => {\n      const groupScorecards = competitors.map(competitor =>\n        scorecard({\n          scorecardNumber: scorecardNumber--,\n          competitionName: wcif.shortName,\n          activityCode: groupActivity.activityCode,\n          round,\n          attemptCount: maxAttemptCountByFormat[round.format],\n          competitor,\n          localNamesFirst,\n        })\n      );\n      const scorecardsOnLastPage = groupScorecards.length % 4;\n      return scorecardsOnLastPage === 0\n        ? groupScorecards\n        : groupScorecards.concat(times(4 - scorecardsOnLastPage, () => ({})));\n    });\n  });\n};\n\nconst groupActivitiesWithCompetitors = (wcif, roundId) => {\n  const sortedCompetitors = competitorsForRound(wcif, roundId);\n  if (sortedCompetitors) {\n    const sortedGroupActivities = hasDistributedAttempts(roundId)\n      ? groupActivitiesByRound(wcif, roundId).slice(0, 1)\n      : sortBy(\n          groupActivitiesByRound(wcif, roundId),\n          ({ activityCode }) => parseActivityCode(activityCode).groupNumber\n        );\n    return sortedGroupActivities.map(groupActivity => [\n      groupActivity,\n      sortedCompetitors.filter(competitor =>\n        hasAssignment(competitor, groupActivity.id, 'competitor')\n      ),\n    ]);\n  } else {\n    /* If competitors for this round are not known yet, generate nameless scorecards. */\n    const expectedCompetitorCount = getExpectedCompetitorsByRound(wcif)[roundId]\n      .length;\n    const groupsWithSize = hasDistributedAttempts(roundId)\n      ? [[groupActivitiesByRound(wcif, roundId)[0], expectedCompetitorCount]]\n      : sortedGroupActivitiesWithSize(wcif, roundId, expectedCompetitorCount);\n    return groupsWithSize.map(([groupActivity, size]) => [\n      groupActivity,\n      times(size, () => ({ name: ' ', registrantId: ' ' })),\n    ]);\n  }\n};\n\nconst blankScorecards = wcif => {\n  const attemptCounts = flatMap(wcif.events, event => event.rounds).map(\n    round => maxAttemptCountByFormat[round.format]\n  );\n  return flatMap(uniq(attemptCounts), attemptCount =>\n    times(4, () => scorecard({ competitionName: wcif.name, attemptCount }))\n  );\n};\n\nconst scorecard = ({\n  scorecardNumber,\n  competitionName,\n  activityCode,\n  round,\n  attemptCount = 5,\n  competitor = { name: ' ', registrantId: ' ' },\n  localNamesFirst = false,\n}) => {\n  const { eventId, roundNumber, groupNumber } = activityCode\n    ? parseActivityCode(activityCode)\n    : {};\n  const { cutoff, timeLimit } = round || {};\n\n  return [\n    { text: scorecardNumber, fontSize: 10 },\n    {\n      text: competitionName,\n      bold: true,\n      fontSize: 15,\n      margin: [0, 0, 0, 10],\n      alignment: 'center',\n    },\n    {\n      margin: [25, 0, 0, 0],\n      table: {\n        widths: ['*', 'auto', 'auto'],\n        body: [\n          columnLabels(['Event', 'Round', 'Group']),\n          [\n            eventId ? eventNameById(eventId) : ' ',\n            { text: roundNumber, alignment: 'center' },\n            { text: groupNumber, alignment: 'center' },\n          ],\n        ],\n      },\n    },\n    {\n      margin: [25, 0, 0, 0],\n      table: {\n        widths: [25, '*'],\n        body: [\n          columnLabels(['ID', 'Name']),\n          [\n            { text: competitor.registrantId, alignment: 'center' },\n            {\n              text: pdfName(competitor.name, {\n                swapLatinWithLocalNames: localNamesFirst,\n              }),\n              maxHeight: 20 /* See: https://github.com/bpampuch/pdfmake/issues/264#issuecomment-108347567 */,\n            },\n          ],\n        ],\n      },\n    },\n    {\n      margin: [0, 10, 0, 0],\n      table: {\n        widths: [\n          16,\n          25,\n          '*',\n          25,\n          25,\n        ] /* Note: 16 (width) + 4 + 4 (defult left and right padding) + 1 (left border) = 25 */,\n        body: [\n          columnLabels(['', 'Scr', 'Result', 'Judge', 'Comp'], {\n            alignment: 'center',\n          }),\n          ...attemptRows(cutoff, attemptCount),\n          [\n            {\n              text: 'Extra attempt',\n              ...noBorder,\n              colSpan: 5,\n              margin: [0, 1],\n              fontSize: 10,\n            },\n          ],\n          attemptRow('_'),\n          [{ text: '', ...noBorder, colSpan: 5, margin: [0, 1] }],\n        ],\n      },\n    },\n    {\n      fontSize: 10,\n      columns: [\n        cutoff\n          ? {\n              text: `Cutoff: ${cutoffToString(cutoff, eventId)}`,\n              alignment: 'center',\n            }\n          : {},\n        timeLimit\n          ? {\n              text: `Time limit: ${timeLimitToString(timeLimit)}`,\n              alignment: 'center',\n            }\n          : {},\n      ],\n    },\n  ];\n};\n\nconst columnLabels = (labels, style = {}) =>\n  labels.map(label => ({\n    ...style,\n    ...noBorder,\n    fontSize: 9,\n    text: label,\n  }));\n\nconst attemptRows = (cutoff, attemptCount) =>\n  times(attemptCount, attemptIndex => attemptRow(attemptIndex + 1)).reduce(\n    (rows, attemptRow, attemptIndex) =>\n      attemptIndex + 1 === attemptCount\n        ? [...rows, attemptRow]\n        : [\n            ...rows,\n            attemptRow,\n            attemptsSeparator(\n              cutoff && attemptIndex + 1 === cutoff.numberOfAttempts\n            ),\n          ],\n    []\n  );\n\nconst attemptsSeparator = cutoffLine => [\n  {\n    ...noBorder,\n    colSpan: 5,\n    margin: [0, 1],\n    columns: !cutoffLine\n      ? []\n      : [\n          {\n            canvas: [\n              {\n                type: 'line',\n                x1: 0,\n                y1: 0,\n                x2: (pageWidth - 4 * scorecardMargin) / 2,\n                y2: 0,\n                dash: { length: 5 },\n              },\n            ],\n          },\n        ],\n  },\n];\n\nconst attemptRow = attemptNumber => [\n  {\n    text: attemptNumber,\n    ...noBorder,\n    fontSize: 20,\n    bold: true,\n    alignment: 'center',\n  },\n  {},\n  {},\n  {},\n  {},\n];\n\nconst noBorder = { border: [false, false, false, false] };\n","import pdfMake from './pdfmake';\nimport { flatMap, sortByArray } from '../utils';\nimport {\n  activityCodeToName,\n  activityDurationString,\n  parseActivityCode,\n  roomsWithTimezoneAndGroups,\n} from '../activities';\nimport { hasAssignment } from '../competitors';\nimport { pdfName } from './pdf-utils';\n\nexport const downloadGroupOverview = (wcif, rounds) => {\n  const pdfDefinition = groupOverviewPdfDefinition(wcif, rounds);\n  pdfMake.createPdf(pdfDefinition).download(`${wcif.id}-group-overview.pdf`);\n};\n\nconst groupOverviewPdfDefinition = (wcif, rounds) => ({\n  footer: (currentPage, pageCount) => ({\n    text: `${currentPage} of ${pageCount}`,\n    alignment: 'center',\n    fontSize: 10,\n  }),\n  content: sortByArray(\n    flatMap(\n      flatMap(rounds, round => roomsWithTimezoneAndGroups(wcif, round.id)),\n      ([room, timezone, groupActivities]) =>\n        groupActivities.map(groupActivity => [room, timezone, groupActivity])\n    ),\n    ([room, timezone, { startTime, activityCode }]) => [\n      startTime,\n      parseActivityCode(activityCode).groupNumber,\n    ]\n  ).map(([room, timezone, groupActivity]) =>\n    overviewForGroup(wcif, room, timezone, groupActivity)\n  ),\n});\n\nconst overviewForGroup = (wcif, room, timezone, groupActivity) => {\n  const headersWithPeople = [\n    ['Competitors', 'competitor'],\n    ['Scramblers', 'staff-scrambler'],\n    ['Runners', 'staff-runner'],\n    ['Judges', 'staff-judge'],\n  ]\n    .map(([header, assignmentCode]) => [\n      header,\n      wcif.persons.filter(person =>\n        hasAssignment(person, groupActivity.id, assignmentCode)\n      ),\n    ])\n    .filter(([header, people]) => people.length > 0);\n  return {\n    unbreakable: true,\n    margin: [0, 0, 0, 10],\n    stack: [\n      {\n        text: activityCodeToName(groupActivity.activityCode),\n        bold: true,\n        fontSize: 14,\n      },\n      {\n        columns: [\n          `Time: ${activityDurationString(groupActivity, timezone)}`,\n          `Room: ${room.name}`,\n        ],\n        margin: [0, 5, 0, 5],\n      },\n      {\n        fontSize: 8,\n        columns: headersWithPeople.map(([header, people]) => [\n          {\n            text: `${header} (${people.length})`,\n            bold: true,\n            fontSize: 10,\n            margin: [0, 0, 0, 2],\n          },\n          {\n            ul: people\n              .map(person => pdfName(person.name, { short: true }))\n              .sort(),\n          },\n        ]),\n      },\n    ],\n  };\n};\n","import { parseActivityCode, activityById } from '../activities';\n\nconst roles = [\n  { id: 'competitor', label: '' },\n  { id: 'staff-scrambler', label: 'S' },\n  { id: 'staff-runner', label: 'R' },\n  { id: 'staff-judge', label: 'J' },\n];\n\n//https://stackoverflow.com/questions/3665115/how-to-create-a-file-in-memory-for-user-to-download-but-not-through-server\nconst download = (filename, text) => {\n  var element = document.createElement('a');\n  element.setAttribute(\n    'href',\n    'data:text/plain;charset=utf-8,' + encodeURIComponent(text)\n  );\n  element.setAttribute('download', filename);\n\n  element.style.display = 'none';\n  document.body.appendChild(element);\n\n  element.click();\n\n  document.body.removeChild(element);\n};\n\nexport const downloadGroupCsv = (wcif, rounds) => {\n  const events = rounds.map(round => round.id.split('-')[0]);\n  var csv =\n    'Name,WCA_ID,' +\n    events.map(event => 'G' + event + ',H' + event + ',').join('') +\n    '\\n' +\n    wcif.persons\n      .map(person => lineForCompetitor(person, events, wcif))\n      .join('\\n');\n  // var outputFile = new File('groups.csv');\n  // outputFile.writeln('Groups.csv', csv, (err) => {});\n  // outputFile.close();\n  download('groups.csv', csv);\n};\n\nconst lineForCompetitor = (competitor, events, wcif) => {\n  var line = competitor.name + ',' + competitor.wcaId + ',';\n\n  var actsByType = roles\n    .map(role => role.id)\n    .map(role =>\n      competitor.assignments\n        .filter(assignment => assignment.assignmentCode === role)\n        .map(assignment =>\n          parseActivityCode(\n            activityById(wcif, assignment.activityId).activityCode\n          )\n        )\n    );\n\n  var competingGroup = actsByType.shift();\n\n  events.forEach(event => {\n    var compGroupEvent = competingGroup.filter(act => act.eventId === event);\n\n    if (compGroupEvent.length > 0) {\n      line += compGroupEvent.map(act => act.groupNumber) + ',';\n\n      var strHelpingAssignments = actsByType\n        .map((acts, index) => {\n          return acts.map(act =>\n            act.eventId === event\n              ? String(roles[index + 1].label) + String(act.groupNumber)\n              : null\n          );\n        })\n        .flat()\n        .filter(e => e != null);\n\n      line += strHelpingAssignments.join(' ') + ',';\n    } else {\n      line += ',,';\n    }\n  });\n  return line;\n};\n","import React, { useState } from 'react';\nimport Button from '@material-ui/core/Button';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport Grid from '@material-ui/core/Grid';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Paper from '@material-ui/core/Paper';\nimport Typography from '@material-ui/core/Typography';\n\nimport CubingIcon from '../../../common/CubingIcon/CubingIcon';\nimport {\n  downloadScorecards,\n  downloadBlankScorecards,\n} from '../../../../logic/documents/scorecards';\nimport { downloadGroupOverview } from '../../../../logic/documents/group-overview';\nimport { downloadGroupCsv } from '../../../../logic/documents/group-csv';\nimport {\n  roundsWithoutResults,\n  roundsMissingScorecards,\n  parseActivityCode,\n  activityCodeToName,\n} from '../../../../logic/activities';\nimport { difference, sortBy } from '../../../../logic/utils';\n\nconst Scorecards = ({ wcif }) => {\n  const missingScorecards = roundsMissingScorecards(wcif);\n  const [selectedRounds, setSelectedRounds] = useState(\n    missingScorecards.every(\n      round => parseActivityCode(round.id).roundNumber === 1\n    )\n      ? missingScorecards\n      : []\n  );\n  const rounds = sortBy(\n    roundsWithoutResults(wcif).filter(\n      round => parseActivityCode(round.id).eventId !== '333fm'\n    ),\n    round => parseActivityCode(round.id).roundNumber\n  );\n\n  const handleRoundClick = round => {\n    setSelectedRounds(\n      selectedRounds.includes(round)\n        ? difference(selectedRounds, [round])\n        : [...selectedRounds, round]\n    );\n  };\n\n  return (\n    <Paper style={{ padding: 16 }}>\n      <Typography variant=\"subtitle1\">Select rounds</Typography>\n      <List style={{ width: 400 }}>\n        {rounds.map(round => (\n          <ListItem\n            key={round.id}\n            button\n            onClick={() => handleRoundClick(round)}\n            style={missingScorecards.includes(round) ? {} : { opacity: 0.5 }}\n          >\n            <ListItemIcon>\n              <CubingIcon eventId={parseActivityCode(round.id).eventId} />\n            </ListItemIcon>\n            <ListItemText primary={activityCodeToName(round.id)} />\n            <Checkbox\n              checked={selectedRounds.includes(round)}\n              tabIndex={-1}\n              disableRipple\n              style={{ padding: 0 }}\n            />\n          </ListItem>\n        ))}\n      </List>\n      <Grid container spacing={1}>\n        <Grid item>\n          <Button\n            onClick={() => downloadScorecards(wcif, selectedRounds)}\n            disabled={selectedRounds.length === 0}\n          >\n            Scorecards\n          </Button>\n        </Grid>\n        <Grid item>\n          <Button\n            onClick={() => downloadGroupOverview(wcif, selectedRounds)}\n            disabled={selectedRounds.length === 0}\n          >\n            Group overview\n          </Button>\n        </Grid>\n        <Grid item>\n          <Button\n            onClick={() => downloadGroupCsv(wcif, selectedRounds)}\n            disabled={selectedRounds.length === 0}\n          >\n            Export groups CSV\n          </Button>\n        </Grid>\n        <Grid item style={{ flexGrow: 1 }} />\n        <Grid item>\n          <Button onClick={() => downloadBlankScorecards(wcif)}>\n            Blank scorecards\n          </Button>\n        </Grid>\n      </Grid>\n    </Paper>\n  );\n};\n\nexport default Scorecards;\n","import { chunk, sortBy, times, zip } from '../utils';\nimport { eventNameById } from '../events';\nimport {\n  activityById,\n  hasDistributedAttempts,\n  parseActivityCode,\n} from '../activities';\nimport { acceptedPeople } from '../competitors';\nimport { getExtensionData } from '../wcif-extensions';\nimport pdfMake from './pdfmake';\nimport { pdfName } from './pdf-utils';\n\nexport const downloadCompetitorCards = wcif => {\n  const pdfDefinition = competitorCardsPdfDefinition(wcif);\n  pdfMake.createPdf(pdfDefinition).download(`${wcif.id}-competitor-cards.pdf`);\n};\n\nconst competitorCardsPdfDefinition = wcif => ({\n  pageMargins: [5, 5],\n  content: chunk(competitorCards(wcif), 3).map(cards => ({\n    columns: cards,\n    fontSize: 8,\n    unbreakable: true,\n  })),\n});\n\nconst competitorCards = wcif => {\n  const cards = sortBy(acceptedPeople(wcif), person => person.name).map(\n    person => competitorCard(wcif, person)\n  );\n  const cardsInLastRow = cards.length % 3;\n  return cardsInLastRow === 0\n    ? cards\n    : cards.concat(times(3 - cardsInLastRow, () => ({})));\n};\n\nconst competitorCard = (wcif, person) => {\n  const events = wcif.events.filter(event => !hasDistributedAttempts(event.id));\n  const { localNamesFirst } = getExtensionData('CompetitionConfig', wcif) || {\n    localNamesFirst: false,\n  };\n  const tasks = person.assignments\n    .map(({ activityId, assignmentCode }) => {\n      const activity = activityById(wcif, activityId);\n      const { eventId, roundNumber, groupNumber } = parseActivityCode(\n        activity.activityCode\n      );\n      return { assignmentCode, eventId, groupNumber, roundNumber };\n    })\n    .filter(({ roundNumber }) => roundNumber === 1);\n  const groupsText = (eventId, assignmentCode) => ({\n    text: tasks\n      .filter(\n        task =>\n          task.eventId === eventId && task.assignmentCode === assignmentCode\n      )\n      .map(task => task.groupNumber)\n      .join(', '),\n    alignment: 'center',\n  });\n  const [assignmentCodes, headers] = zip(\n    ...[\n      ['competitor', 'Comp'],\n      ['staff-scrambler', 'Scr'],\n      ['staff-runner', 'Run'],\n      ['staff-judge', 'Judge'],\n    ].filter(([assignmentCode]) =>\n      tasks.some(task => task.assignmentCode === assignmentCode)\n    )\n  );\n  return {\n    margin: [5, 5],\n    stack: [\n      {\n        text: pdfName(person.name, {\n          swapLatinWithLocalNames: localNamesFirst,\n        }),\n        fontSize: 10,\n        maxHeight: 20 /* See: https://github.com/bpampuch/pdfmake/issues/264#issuecomment-108347567 */,\n      },\n      {\n        columns: [\n          `ID: ${person.registrantId}`,\n          {\n            text: person.wcaId ? `WCA ID: ${person.wcaId}` : {},\n            alignment: 'right',\n          },\n        ],\n      },\n      {\n        table: {\n          widths: ['auto', ...headers.map(() => '*')],\n          body: [\n            [\n              'Event',\n              ...headers.map(header => ({ text: header, alignment: 'center' })),\n            ],\n            ...events.map(event => [\n              eventNameById(event.id),\n              ...assignmentCodes.map(assignmentCode =>\n                groupsText(event.id, assignmentCode)\n              ),\n            ]),\n          ],\n        },\n        layout: {\n          paddingLeft: () => 2,\n          paddingRight: () => 2,\n          paddingTop: () => 1,\n          paddingBottom: () => 1,\n        },\n      },\n      ...times(Math.max(0, 12 - events.length), () => ({\n        text: ' ',\n      })) /* Add some empty space if there are few events. */,\n    ],\n  };\n};\n","import React from 'react';\nimport Button from '@material-ui/core/Button';\nimport Paper from '@material-ui/core/Paper';\nimport Typography from '@material-ui/core/Typography';\n\nimport { downloadCompetitorCards } from '../../../../logic/documents/competitor-cards';\n\nconst CompetitorCards = ({ wcif }) => {\n  return (\n    <Paper style={{ padding: 16 }}>\n      <Typography variant=\"body1\">\n        First round task assignments for every competitor. Useful to be\n        distributed along with name tags.\n      </Typography>\n      <Button onClick={() => downloadCompetitorCards(wcif)}>Download</Button>\n    </Paper>\n  );\n};\n\nexport default CompetitorCards;\n","import React, { useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport AppBar from '@material-ui/core/AppBar';\nimport Button from '@material-ui/core/Button';\nimport Grid from '@material-ui/core/Grid';\nimport SnackbarContent from '@material-ui/core/SnackbarContent';\nimport Tab from '@material-ui/core/Tab';\nimport Tabs from '@material-ui/core/Tabs';\nimport pink from '@material-ui/core/colors/pink';\n\nimport Scorecards from './Scorecards/Scorecards';\nimport CompetitorCards from './CompetitorCards/CompetitorCards';\nimport {\n  roundsMissingAssignments,\n  activityCodeToName,\n} from '../../../logic/activities';\n\nconst PrintingManager = ({ wcif }) => {\n  const [tabValue, setTabValue] = useState(0);\n\n  const roundsMissingAssignmentsNames = roundsMissingAssignments(wcif).map(\n    round => activityCodeToName(round.id)\n  );\n\n  return (\n    <Grid container spacing={1} justify=\"flex-end\">\n      <Grid item xs={12}>\n        {roundsMissingAssignmentsNames.length > 0 && (\n          <SnackbarContent\n            style={{ maxWidth: 'none' }}\n            message={`\n              The following rounds are missing task assignments:\n              ${roundsMissingAssignmentsNames.join(', ')}.\n              You may want to assign them first.\n            `}\n            action={\n              <Button\n                component={Link}\n                to={`/competitions/${wcif.id}/groups`}\n                style={{ color: pink[500] }}\n                size=\"small\"\n              >\n                Manage groups\n              </Button>\n            }\n          />\n        )}\n      </Grid>\n      <Grid item xs={12}>\n        <AppBar position=\"static\" color=\"default\">\n          <Tabs\n            value={tabValue}\n            onChange={(event, value) => setTabValue(value)}\n            centered\n          >\n            <Tab label=\"Scorecards\" />\n            <Tab label=\"Competitor cards\" />\n          </Tabs>\n        </AppBar>\n      </Grid>\n      <Grid item xs={12}>\n        {tabValue === 0 && <Scorecards wcif={wcif} />}\n        {tabValue === 1 && <CompetitorCards wcif={wcif} />}\n      </Grid>\n      <Grid item>\n        <Button\n          variant=\"contained\"\n          color=\"primary\"\n          component={Link}\n          to={`/competitions/${wcif.id}`}\n        >\n          Done\n        </Button>\n      </Grid>\n    </Grid>\n  );\n};\n\nexport default PrintingManager;\n","import React, { useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport Button from '@material-ui/core/Button';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport Grid from '@material-ui/core/Grid';\nimport Paper from '@material-ui/core/Paper';\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableCell from '@material-ui/core/TableCell';\nimport TableHead from '@material-ui/core/TableHead';\nimport TablePagination from '@material-ui/core/TablePagination';\nimport TableRow from '@material-ui/core/TableRow';\nimport TextField from '@material-ui/core/TextField';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Typography from '@material-ui/core/Typography';\nimport InfoIcon from '@material-ui/icons/Info';\n\nimport SaveWcifButton from '../../common/SaveWcifButton/SaveWcifButton';\nimport { acceptedPeople } from '../../../logic/competitors';\nimport { difference, sortBy } from '../../../logic/utils';\n\nconst roles = [\n  { id: 'staff-scrambler', name: 'Scrambler' },\n  { id: 'staff-judge', name: 'Judge' },\n  { id: 'staff-runner', name: 'Runner' },\n  { id: 'staff-dataentry', name: 'Data entry' },\n];\n\nconst rowsPerPage = 5;\nconst rowsPerPageOptions = [5];\n\nconst RolesManager = ({ wcif, onWcifUpdate }) => {\n  const [localWcif, setLocalWcif] = useState(wcif);\n  const [page, setPage] = useState(0);\n  const [searchString, setSearchString] = useState('');\n\n  const allSortedPeople = sortBy(\n    acceptedPeople(localWcif),\n    person => person.name\n  );\n  const people = !searchString\n    ? allSortedPeople\n    : allSortedPeople.filter(person =>\n        searchString\n          .split(/\\s*,\\s*/)\n          .some(\n            searchPart =>\n              searchPart && person.name.match(new RegExp(searchPart, 'i'))\n          )\n      );\n\n  const handleSearchStringChange = event => {\n    setSearchString(event.target.value);\n    setPage(0);\n  };\n\n  const handleRoleChange = (roleId, personWcaUserId, event) => {\n    const { checked } = event.target;\n    setLocalWcif({\n      ...localWcif,\n      persons: localWcif.persons.map(person =>\n        person.wcaUserId === personWcaUserId\n          ? {\n              ...person,\n              roles: checked\n                ? [...person.roles, roleId]\n                : difference(person.roles, [roleId]),\n            }\n          : person\n      ),\n    });\n  };\n\n  const clearRoles = () => {\n    const roleIds = roles.map(role => role.id);\n    setLocalWcif({\n      ...localWcif,\n      persons: localWcif.persons.map(person => ({\n        ...person,\n        roles: difference(person.roles, roleIds),\n      })),\n    });\n  };\n\n  return (\n    <Grid container spacing={1} justify=\"flex-end\">\n      <Grid item xs={12}>\n        <Paper>\n          <Toolbar>\n            <Grid container spacing={1} alignItems=\"flex-end\">\n              <Grid item>\n                <TextField\n                  label=\"Search\"\n                  value={searchString}\n                  onChange={event => handleSearchStringChange(event)}\n                />\n              </Grid>\n              <Grid item>\n                <Tooltip\n                  title=\"If you separate search phrases with a comma, anyone matching either of them will show up.\"\n                  placement=\"right\"\n                >\n                  <InfoIcon color=\"action\" />\n                </Tooltip>\n              </Grid>\n            </Grid>\n          </Toolbar>\n          <div style={{ overflowX: 'auto' }}>\n            <Table>\n              <TableHead>\n                <TableRow style={{ whiteSpace: 'nowrap' }}>\n                  <TableCell>Person</TableCell>\n                  {roles.map(role => (\n                    <TableCell\n                      key={role.id}\n                      padding=\"none\"\n                      align=\"center\"\n                      style={{ minWidth: 100 }}\n                    >\n                      {role.name}\n                    </TableCell>\n                  ))}\n                </TableRow>\n              </TableHead>\n              <TableBody>\n                {people\n                  .slice(page * rowsPerPage, page * rowsPerPage + rowsPerPage)\n                  .map(person => (\n                    <TableRow key={person.wcaUserId} hover>\n                      <TableCell>{person.name}</TableCell>\n                      {roles.map(role => (\n                        <TableCell\n                          key={role.id}\n                          padding=\"checkbox\"\n                          align=\"center\"\n                        >\n                          <Checkbox\n                            checked={person.roles.includes(role.id)}\n                            onChange={handleRoleChange.bind(\n                              this,\n                              role.id,\n                              person.wcaUserId\n                            )}\n                          />\n                        </TableCell>\n                      ))}\n                    </TableRow>\n                  ))}\n              </TableBody>\n            </Table>\n          </div>\n          <TablePagination\n            component=\"div\"\n            count={people.length}\n            rowsPerPage={rowsPerPage}\n            rowsPerPageOptions={rowsPerPageOptions}\n            page={page}\n            onChangePage={(event, page) => setPage(page)}\n          />\n        </Paper>\n      </Grid>\n      <Grid item xs={12}>\n        <Typography variant=\"caption\" component=\"div\">\n          {`Use this section only if you have a group of staff among competitors.\n            People with the given role will be prioritized during task assignment.`}\n        </Typography>\n        <Typography variant=\"caption\">\n          {`Note: if you don't set any roles, people will still be assigned tasks if configured to.`}\n        </Typography>\n      </Grid>\n      <Grid item>\n        <Button\n          variant=\"contained\"\n          component={Link}\n          to={`/competitions/${localWcif.id}`}\n        >\n          Cancel\n        </Button>\n      </Grid>\n      <Grid item>\n        <Button variant=\"contained\" onClick={clearRoles}>\n          Clear\n        </Button>\n      </Grid>\n      <Grid item>\n        <SaveWcifButton\n          wcif={wcif}\n          updatedWcif={localWcif}\n          onWcifUpdate={onWcifUpdate}\n        />\n      </Grid>\n    </Grid>\n  );\n};\n\nexport default RolesManager;\n","import React, { Fragment, useState, useEffect } from 'react';\nimport { Route, Switch } from 'react-router-dom';\nimport LinearProgress from '@material-ui/core/LinearProgress';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Typography from '@material-ui/core/Typography';\n\nimport CompetitionMenu from './CompetitionMenu/CompetitionMenu';\nimport ConfigManager from './ConfigManager/ConfigManager';\nimport GroupsManager from './GroupsManager/GroupsManager';\nimport PrintingManager from './PrintingManager/PrintingManager';\nimport RolesManager from './RolesManager/RolesManager';\n\nimport { getWcif } from '../../logic/wca-api';\nimport { sortWcifEvents } from '../../logic/events';\nimport { updateIn } from '../../logic/utils';\nimport { validateWcif } from '../../logic/wcif-validation';\n\nconst Competition = ({ match }) => {\n  const [wcif, setWcif] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [errors, setErrors] = useState([]);\n\n  useEffect(() => {\n    getWcif(match.params.competitionId)\n      /* Sort events, so that we don't need to remember about this everywhere. */\n      .then(wcif => updateIn(wcif, ['events'], sortWcifEvents))\n      .then(wcif => {\n        setWcif(wcif);\n        setErrors(validateWcif(wcif));\n      })\n      .catch(error => setErrors([error.message]))\n      .finally(() => setLoading(false));\n  }, [match.params.competitionId]);\n\n  return loading ? (\n    <LinearProgress />\n  ) : (\n    <div>\n      {errors.length === 0 ? (\n        <Fragment>\n          <Typography variant=\"h5\" style={{ marginBottom: 16 }}>\n            {wcif.name}\n          </Typography>\n          <Switch>\n            <Route\n              exact\n              path={match.url}\n              render={props => (\n                <CompetitionMenu {...props} wcif={wcif} baseUrl={match.url} />\n              )}\n            />\n            <Route\n              path={`${match.url}/roles`}\n              render={props => (\n                <RolesManager {...props} wcif={wcif} onWcifUpdate={setWcif} />\n              )}\n            />\n            <Route\n              path={`${match.url}/config`}\n              render={props => (\n                <ConfigManager {...props} wcif={wcif} onWcifUpdate={setWcif} />\n              )}\n            />\n            <Route\n              path={`${match.url}/groups`}\n              render={props => (\n                <GroupsManager {...props} wcif={wcif} onWcifUpdate={setWcif} />\n              )}\n            />\n            <Route\n              path={`${match.url}/printing`}\n              render={props => <PrintingManager {...props} wcif={wcif} />}\n            />\n          </Switch>\n        </Fragment>\n      ) : (\n        <Fragment>\n          <Typography variant=\"h5\">Failed to load competition data</Typography>\n          <List>\n            {errors.map(error => (\n              <ListItem key={error}>\n                <ListItemText>{error}</ListItemText>\n              </ListItem>\n            ))}\n          </List>\n        </Fragment>\n      )}\n    </div>\n  );\n};\n\nexport default Competition;\n","import { flatMap } from './utils';\nimport { activityCodeToName, roundActivities } from './activities';\n\nexport const validateWcif = wcif => {\n  const { events } = wcif;\n  const eventRoundErrors = flatMap(events, event => {\n    if (event.rounds.length === 0)\n      return [`No rounds specified for ${activityCodeToName(event.id)}.`];\n    const advancementConditionErrors = flatMap(\n      event.rounds.slice(0, -1),\n      round =>\n        round.advancementCondition\n          ? []\n          : [\n              `No advancement condition specified for ${activityCodeToName(\n                round.id\n              )}.`,\n            ]\n    );\n    const roundActivityErrors = flatMap(event.rounds, round =>\n      roundActivities(wcif, round.id).length > 0\n        ? []\n        : [`No schedule activities for ${activityCodeToName(round.id)}.`]\n    );\n    return [...advancementConditionErrors, ...roundActivityErrors];\n  });\n  return eventRoundErrors;\n};\n","import React, { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport LinearProgress from '@material-ui/core/LinearProgress';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListSubheader from '@material-ui/core/ListSubheader';\nimport Paper from '@material-ui/core/Paper';\nimport ErrorIcon from '@material-ui/icons/Error';\nimport SentimentVeryDissatisfiedIcon from '@material-ui/icons/SentimentVeryDissatisfied';\n\nimport { getUpcomingManageableCompetitions } from '../../logic/wca-api';\nimport { sortBy } from '../../logic/utils';\n\nconst CompetitionList = () => {\n  const [competitions, setCompetitions] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    getUpcomingManageableCompetitions()\n      .then(competitions => {\n        setCompetitions(\n          sortBy(competitions, competition => competition['start_date'])\n        );\n      })\n      .catch(error => setError(error.message))\n      .finally(() => setLoading(false));\n  }, []);\n\n  return (\n    <Paper>\n      <List subheader={<ListSubheader>Your competitions</ListSubheader>}>\n        {error && (\n          <ListItem>\n            <ListItemIcon>\n              <ErrorIcon />\n            </ListItemIcon>\n            <ListItemText primary={`Couldn't fetch competitions: ${error}`} />\n          </ListItem>\n        )}\n        {!loading && !error && competitions.length === 0 && (\n          <ListItem>\n            <ListItemIcon>\n              <SentimentVeryDissatisfiedIcon />\n            </ListItemIcon>\n            <ListItemText primary=\"You have no upcoming competitions to manage.\" />\n          </ListItem>\n        )}\n        {competitions.map(competition => (\n          <ListItem\n            key={competition.id}\n            button\n            component={Link}\n            to={`/competitions/${competition.id}`}\n          >\n            <ListItemText primary={competition.name} />\n          </ListItem>\n        ))}\n      </List>\n      {loading && <LinearProgress />}\n    </Paper>\n  );\n};\n\nexport default CompetitionList;\n","import React from 'react';\nimport Grid from '@material-ui/core/Grid';\nimport Link from '@material-ui/core/Link';\nimport Typography from '@material-ui/core/Typography';\nimport red from '@material-ui/core/colors/red';\nimport grey from '@material-ui/core/colors/grey';\nimport { makeStyles } from '@material-ui/core/styles';\nimport FavoriteIcon from '@material-ui/icons/Favorite';\n\nimport { version } from '../../../package.json';\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    padding: theme.spacing(2),\n  },\n  icon: {\n    verticalAlign: 'middle',\n    color: red[700],\n  },\n  grow: {\n    flexGrow: 1,\n  },\n  link: {\n    verticalAlign: 'middle',\n    fontWeight: 500,\n    color: grey['900'],\n    '&:hover': {\n      textDecoration: 'none',\n      opacity: 0.7,\n    },\n  },\n}));\n\nconst links = [\n  { text: 'Donate', url: 'https://ko-fi.com/jonatanklosko' },\n  {\n    text: 'Guide',\n    url: 'https://github.com/jonatanklosko/groupifier-next/wiki/Guide',\n  },\n  { text: 'GitHub', url: 'https://github.com/jonatanklosko/groupifier-next' },\n  { text: 'Contact', url: 'mailto:jonatanklosko@gmail.com' },\n  {\n    text: `v${version}`,\n    url: 'https://github.com/jonatanklosko/groupifier-next',\n  },\n];\n\nconst Footer = () => {\n  const classes = useStyles();\n  return (\n    <Grid container className={classes.root}>\n      <Grid item>\n        <Typography variant=\"body2\">\n          Made With <FavoriteIcon className={classes.icon} /> by{' '}\n          <Link\n            className={classes.link}\n            href=\"https://github.com/jonatanklosko\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            Jonatan Kosko\n          </Link>\n        </Typography>\n      </Grid>\n      <Grid item className={classes.grow} />\n      <Grid item>\n        <Grid container spacing={1}>\n          {links.map(({ text, url }) => (\n            <Grid item key={text}>\n              <Link\n                className={classes.link}\n                variant=\"body2\"\n                href={url}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n              >\n                {text}\n              </Link>\n            </Grid>\n          ))}\n        </Grid>\n      </Grid>\n    </Grid>\n  );\n};\n\nexport default Footer;\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport AppBar from '@material-ui/core/AppBar';\nimport Button from '@material-ui/core/Button';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\nimport PeopleIcon from '@material-ui/icons/People';\n\nconst useStyles = makeStyles(theme => ({\n  title: {\n    flexGrow: 1,\n  },\n  titleLink: {\n    color: 'inherit',\n    textDecoration: 'none',\n  },\n  titleIcon: {\n    fontSize: '1.5em',\n    verticalAlign: 'middle',\n    marginRight: theme.spacing(1),\n  },\n}));\n\nconst Header = ({ isSignedIn, onSignIn, onSignOut }) => {\n  const classes = useStyles();\n  return (\n    <AppBar position=\"static\" color=\"primary\">\n      <Toolbar>\n        <Typography variant=\"h6\" className={classes.title}>\n          <Link\n            to={isSignedIn ? '/competitions' : '/'}\n            className={classes.titleLink}\n          >\n            <PeopleIcon className={classes.titleIcon} />\n            Groupifier\n          </Link>\n        </Typography>\n        {isSignedIn ? (\n          <Button color=\"inherit\" onClick={onSignOut}>\n            Sign out\n          </Button>\n        ) : (\n          <Button color=\"inherit\" onClick={onSignIn}>\n            Sign in\n          </Button>\n        )}\n      </Toolbar>\n    </AppBar>\n  );\n};\n\nexport default Header;\n","import React from 'react';\nimport Grid from '@material-ui/core/Grid';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Typography from '@material-ui/core/Typography';\nimport CheckIcon from '@material-ui/icons/Check';\n\nconst features = [\n  'Allows for marking competitors as different kinds of staff and handles them in a special manner.',\n  'Supports multiple rooms/stages running simultaneously.',\n  'Suggests number of groups and necessary roles, while leaving the final decision to the user.',\n  'Once configured, creates groups and does its best to optimally assign people to these groups.',\n  'Generates documents like scorecards and competitor cards with task assignments.',\n];\n\nconst Home = () => (\n  <Grid container spacing={1} direction=\"column\">\n    <Grid item>\n      <Typography variant=\"h4\">What is Groupifier?</Typography>\n    </Grid>\n    <Grid item>\n      <Typography variant=\"subtitle1\">\n        {`Task and group management tool for WCA competition organizers. It's\n          designed to be highly customizable and work well with complex schedules.`}\n      </Typography>\n    </Grid>\n    <Grid item>\n      <Typography variant=\"h4\">What does it do?</Typography>\n    </Grid>\n    <Grid item>\n      <List>\n        {features.map(feature => (\n          <ListItem key={feature}>\n            <ListItemIcon>\n              <CheckIcon />\n            </ListItemIcon>\n            <ListItemText primary={feature} />\n          </ListItem>\n        ))}\n      </List>\n    </Grid>\n  </Grid>\n);\n\nexport default Home;\n","import React, { useState } from 'react';\nimport { Router, Route, Switch, Redirect } from 'react-router-dom';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport Grid from '@material-ui/core/Grid';\nimport { createMuiTheme } from '@material-ui/core/styles';\nimport { ThemeProvider } from '@material-ui/styles';\nimport blueGrey from '@material-ui/core/colors/blueGrey';\nimport blue from '@material-ui/core/colors/blue';\nimport { makeStyles } from '@material-ui/core/styles';\n\nimport history from '../../logic/history';\nimport Competition from '../Competition/Competition';\nimport CompetitionList from '../CompetitionList/CompetitionList';\nimport Footer from '../Footer/Footer';\nimport Header from '../Header/Header';\nimport Home from '../Home/Home';\n\nimport { isSignedIn, signIn, signOut } from '../../logic/auth';\n\nconst theme = createMuiTheme({\n  palette: {\n    primary: {\n      main: blueGrey[900],\n    },\n    secondary: blue,\n  },\n});\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: 'flex',\n    minHeight: '100vh',\n    flexDirection: 'column',\n  },\n  grow: {\n    flexGrow: 1,\n  },\n  main: {\n    padding: theme.spacing(2),\n  },\n}));\n\nconst App = () => {\n  const classes = useStyles();\n  const [signedIn, setSignedIn] = useState(isSignedIn());\n\n  const handleSignIn = () => {\n    signIn();\n  };\n\n  const handleSignOut = () => {\n    signOut();\n    setSignedIn(false);\n  };\n\n  return (\n    <Router history={history}>\n      <ThemeProvider theme={theme}>\n        <div className={classes.root}>\n          <CssBaseline />\n          <Header\n            isSignedIn={signedIn}\n            onSignIn={handleSignIn}\n            onSignOut={handleSignOut}\n          />\n          <Grid container justify=\"center\" className={classes.grow}>\n            <Grid item xs={12} md={8} xl={6} className={classes.main}>\n              {signedIn ? (\n                <Switch>\n                  <Route\n                    path=\"/competitions/:competitionId\"\n                    component={Competition}\n                  />\n                  <Route path=\"/competitions\" component={CompetitionList} />\n                  <Redirect to=\"/competitions\" />\n                </Switch>\n              ) : (\n                <Switch>\n                  <Route exact path=\"/\" component={Home} />\n                  <Redirect to=\"/\" />\n                </Switch>\n              )}\n            </Grid>\n          </Grid>\n          <Footer />\n        </div>\n      </ThemeProvider>\n    </Router>\n  );\n};\n\nexport default App;\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import './polyfills';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport './index.css';\nimport App from './components/App/App';\nimport { unregister as unregisterServiceWorker } from './registerServiceWorker';\nimport { initializeAuth } from './logic/auth';\n\ninitializeAuth();\nReactDOM.render(<App />, document.getElementById('root'));\nunregisterServiceWorker();\n"],"sourceRoot":""}